<div class="time-picker-wrapper">
  <!-- Input que muestra la hora seleccionada -->
  <div 
    class="time-picker-input w-full px-6 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl
           focus:outline-none focus:ring-4 focus:ring-green-500/20 focus:border-green-500
           bg-gradient-to-r from-gray-50 to-white dark:from-gray-700 dark:to-gray-800
           text-gray-800 dark:text-gray-200 text-lg font-medium
           hover:shadow-lg transition-all duration-300 transform hover:scale-[1.02]
           cursor-pointer"
    [class.border-green-500]="showPicker"
    [class.dark:border-green-500]="showPicker"
    (click)="togglePicker()"
  >
    <div class="flex items-center">
      <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
              d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      <span>{{ label }}: {{ selectedTime || '--:-- --' }}</span>
    </div>
  </div>

<!-- Modal del reloj mejorado -->
<div class="time-picker-modal fixed inset-0 flex items-center justify-center bg-black/60 backdrop-blur-sm z-50 p-4" 
     *ngIf="showPicker" 
     (click)="onBackdropClick($event)"
     style="margin-top: 60px;">
  
  <div class="time-picker-container bg-white dark:bg-gray-900 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 p-6 w-full max-w-sm transform transition-all duration-300 ease-out scale-100"
       (click)="$event.stopPropagation()">
    
    <!-- Header con mejor spacing -->
   
    
    <!-- Display del tiempo con mejor diseño -->
    <div class="time-display flex justify-center items-center mb-8 bg-gray-50 dark:bg-gray-800 rounded-xl p-4">
        <div class="flex items-baseline relative">
    <!-- Input para edición -->
    <input *ngIf="editingTime"
           type="time"
           [(ngModel)]="tempTime"
           (blur)="confirmEdit()"
           (keyup.enter)="confirmEdit()"
           (keyup.escape)="cancelEdit()"
           autofocus
           class="absolute inset-0 w-full h-full opacity-0 cursor-pointer">

    <!-- Visualización mejorada (siempre visible) -->
    <div (click)="startEditing()" class="flex items-baseline cursor-pointer">
      <span class="hours text-5xl font-bold text-gray-800 dark:text-gray-100 tabular-nums hover:text-blue-600 transition-colors">
        {{ selectedHour.toString().padStart(2, '0') }}
      </span>
      <span class="colon text-5xl mx-2 text-gray-400 dark:text-gray-500 animate-pulse">:</span>
      <span class="minutes text-5xl font-bold text-gray-800 dark:text-gray-100 tabular-nums hover:text-blue-600 transition-colors">
        {{ selectedMinute.toString().padStart(2, '0') }}
      </span>
    </div>
  </div>
      
      <!-- AM/PM selector mejorado -->
      <div class="bg-gray-200 dark:bg-gray-800 rounded-lg p-1 flex">
        
        <button 
          class="px-4 py-2 rounded-md transition-all duration-200 font-medium text-sm"
          [class]="isAM ? 'bg-white dark:bg-gray-700 text-blue-600 shadow-sm' : 'text-gray-600 dark:text-gray-400'"
          (click)="setAmPm(true)">
          AM
        </button>
        <button 
          class="px-4 py-2 rounded-md transition-all duration-200 font-medium text-sm"
          [class]="!isAM ? 'bg-white dark:bg-gray-700 text-blue-600 shadow-sm' : 'text-gray-600 dark:text-gray-400'"
          (click)="setAmPm(false)">
          PM
        </button>
      </div>
    </div>

    <!-- Selector de modo (Horas/Minutos) -->
    <div class="mode-selector flex justify-center mb-4">
      <div class="bg-gray-100 dark:bg-gray-800 rounded-lg p-1 flex">
        <button 
          class="px-4 py-2 rounded-md transition-all duration-200 font-medium text-sm"
          [class]="mode === 'hours' ? 'bg-white dark:bg-gray-700 text-blue-600 shadow-sm' : 'text-gray-600 dark:text-gray-400'"
          (click)="mode = 'hours'">
          Hours
        </button>
        
      </div>
    </div>

    <!-- Reloj mejorado con mejor posicionamiento -->
    <div class="clock-face relative w-72 h-72 mx-auto my-6 rounded-full bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 border-4 border-gray-200 dark:border-gray-700 shadow-inner">
      
      <!-- Centro del reloj más prominente -->
      <div class="clock-center absolute top-1/2 left-1/2 w-4 h-4 bg-blue-600 rounded-full transform -translate-x-1/2 -translate-y-1/2 z-20 shadow-lg"></div>
      
      <!-- Manecilla con mejor diseño -->
      <div 
        class="clock-hand absolute top-1/2 left-1/2 bg-blue-600 transform -translate-x-1/2 -translate-y-full origin-bottom transition-all duration-300 ease-out rounded-full shadow-lg z-10"
        [style.width]="mode === 'hours' ? '3px' : '2px'"
        [style.height]="mode === 'hours' ? '5rem' : '6rem'"
        [style.transform]="'translate(-50%, -100%) rotate(' + (mode === 'hours' ? hourAngle : minuteAngle) + 'deg)'">
        <!-- Punta de la manecilla -->
        <div class="absolute -top-2 left-1/2 w-3 h-3 bg-blue-600 rounded-full transform -translate-x-1/2 shadow-lg"></div>
      </div>
      
      <!-- Números del reloj con mejor posicionamiento -->
       <!-- Para las horas -->
      <div *ngIf="mode === 'hours'">
        <div *ngFor="let hour of hours; let i = index" 
             class="hour-number absolute w-12 h-12 flex items-center justify-center rounded-full cursor-pointer font-semibold text-gray-700 dark:text-gray-300 hover:bg-blue-100 dark:hover:bg-blue-900/50 transition-all duration-200 select-none"
             [class.bg-blue-600]="selectedHour === hour"
             [class.text-white]="selectedHour === hour"
             [class.shadow-lg]="selectedHour === hour"
             [style.top]="getHourTopPosition(i)"
             [style.left]="getHourLeftPosition(i)"
             (click)="selectHour(hour)">
          {{ hour }}
        </div>
      </div>
      <!-- Para los minutos -->
      <div *ngIf="mode === 'minutes'">
        <div *ngFor="let minute of visibleMinutes; let i = index" 
             class="minute-number absolute w-8 h-8 flex items-center justify-center rounded-full cursor-pointer font-medium text-[10px] text-gray-600 dark:text-gray-400 hover:bg-blue-100 dark:hover:bg-blue-900/50 transition-all duration-200 select-none"
             [class.bg-blue-600]="selectedMinute === minute"
             [class.text-white]="selectedMinute === minute"
             [class.shadow-lg]="selectedMinute === minute"
             [style.top]="getMinuteTopPosition(i)"
             [style.left]="getMinuteLeftPosition(i)"
             (click)="selectMinute(minute)">
          {{ minute.toString().padStart(2, '0') }}
        </div>
        
      </div>
    </div>

    <!-- Botones de acción mejorados -->
    <div class="time-actions flex justify-between items-center mt-8 pt-4 border-t border-gray-200 dark:border-gray-700">
      <button 
        class="action-btn cancel px-6 py-3 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-200 dark:hover:bg-gray-700 transition-all duration-200 font-medium focus:outline-none focus:ring-2 focus:ring-gray-300 dark:focus:ring-gray-600"
        (click)="showPicker = false">
        Cancel
      </button>
      
      <!-- Tiempo seleccionado actual -->
      <button 
        class="action-btn confirm px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 active:bg-blue-800 transition-all duration-200 font-medium shadow-lg hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900"
        (click)="confirmSelection()">
        OK
      </button>
    </div>
  </div>
</div>