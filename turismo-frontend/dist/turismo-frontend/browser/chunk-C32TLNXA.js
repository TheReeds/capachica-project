import{a as T}from"./chunk-LMROLFSP.js";import{a as W}from"./chunk-G5KRKBM3.js";import{a as N}from"./chunk-PYGBUVLC.js";import{b as z,c as F,d as O,e as ie,h as ne,i as oe,l as ae,o as se,p as $,q,r as B,x as le,y as de,z as me}from"./chunk-KTW5JVGU.js";import{d as H,f as D,g as P}from"./chunk-XR3SD2KY.js";import{Bb as Y,Cb as Z,Db as ee,Ga as I,Gb as a,Hb as y,Hc as M,Ib as C,La as s,Lb as A,Mb as R,Nb as G,Qb as E,Va as U,_ as k,_a as g,fb as p,ga as v,ha as _,hb as j,ia as u,ja as x,jb as f,kb as K,lb as X,mb as w,nb as S,ob as t,pb as i,qb as l,tb as b,ub as h,uc as te,vb as c,wc as re}from"./chunk-ETYZCZA5.js";import"./chunk-4CLCTAJ7.js";var xe=o=>["/admin/users/edit",o],he=o=>["/admin/users",o,"permissions"],pe=(o,r)=>r.id;function ve(o,r){if(o&1&&(t(0,"option",20),a(1),i()),o&2){let e=r.$implicit;p("value",e.name),s(),y(e.name)}}function _e(o,r){o&1&&(t(0,"div",25),l(1,"div",27),t(2,"span",28),a(3,"Cargando usuarios..."),i()())}function ye(o,r){o&1&&(t(0,"div",26),u(),t(1,"svg",29),l(2,"path",30),i(),x(),t(3,"h3",31),a(4,"No se encontraron usuarios"),i(),t(5,"p",32),a(6,"Comienza creando un nuevo usuario."),i(),t(7,"div",33)(8,"a",6),u(),t(9,"svg",7),l(10,"path",8),i(),a(11," Nuevo Usuario "),i()()())}function be(o,r){if(o&1&&l(0,"img",45),o&2){let e=c().$implicit;p("src",e.foto_perfil,I)("alt",e.name)}}function ke(o,r){if(o&1&&(t(0,"span",46),a(1),i()),o&2){let e=c().$implicit,n=c(2);s(),y(n.getUserInitials(e))}}function Ce(o,r){if(o&1&&(t(0,"div",52),a(1),i()),o&2){let e=c().$implicit;s(),C(" ",e.country," ")}}function we(o,r){if(o&1&&(t(0,"span",66),a(1),i()),o&2){let e=r.$implicit;s(),C(" ",e," ")}}function Se(o,r){if(o&1&&w(0,we,2,1,"span",66,K),o&2){let e=c().$implicit;S(e.roles)}}function Ee(o,r){o&1&&(t(0,"span",52),a(1,"Sin roles"),i())}function Fe(o,r){o&1&&(t(0,"span",53),a(1," Activo "),i())}function Ue(o,r){o&1&&(t(0,"span",54),a(1," Inactivo "),i())}function Me(o,r){if(o&1){let e=b();t(0,"button",67),h("click",function(){v(e);let d=c().$implicit,m=c(2);return _(m.deactivateUser(d))}),u(),t(1,"svg",60),l(2,"path",68),i()()}}function Pe(o,r){if(o&1){let e=b();t(0,"button",69),h("click",function(){v(e);let d=c().$implicit,m=c(2);return _(m.activateUser(d))}),u(),t(1,"svg",60),l(2,"path",70),i()()}}function Te(o,r){if(o&1){let e=b();t(0,"tr",40)(1,"td",42)(2,"div",43)(3,"div",44),g(4,be,1,2,"img",45)(5,ke,2,1,"span",46),i(),t(6,"div",47)(7,"div",48),a(8),i(),g(9,Ce,2,1,"div",49),i()()(),t(10,"td",50),a(11),i(),t(12,"td",50),a(13),i(),t(14,"td",42)(15,"div",51),g(16,Se,2,0)(17,Ee,2,0,"span",52),i()(),t(18,"td",42),g(19,Fe,2,0,"span",53)(20,Ue,2,0,"span",54),i(),t(21,"td",55)(22,"div",56),g(23,Me,3,0,"button",57)(24,Pe,3,0,"button",58),t(25,"a",59),u(),t(26,"svg",60),l(27,"path",61),i()(),x(),t(28,"a",62),u(),t(29,"svg",60),l(30,"path",63),i()(),x(),t(31,"button",64),h("click",function(){let d=v(e).$implicit,m=c(2);return _(m.deleteUser(d))}),u(),t(32,"svg",60),l(33,"path",65),i()()()()()}if(o&2){let e=r.$implicit;s(4),f(e.foto_perfil?4:5),s(4),y(e.name),s(),p("ngIf",e.country),s(2),C(" ",e.email," "),s(2),C(" ",e.phone||"No especificado"," "),s(3),f(e.roles!=null&&e.roles.length?16:17),s(3),f(e.active?19:20),s(4),f(e.active?23:24),s(2),p("routerLink",E(10,xe,e.id)),s(3),p("routerLink",E(12,he,e.id))}}function Ve(o,r){if(o&1){let e=b();t(0,"button",81),h("click",function(){v(e);let d=c().$implicit,m=c(3);return _(m.goToPage(+d.label))}),a(1),i()}if(o&2){let e=c().$implicit,n=c(3);j("bg-primary-50",e.active&&!n.isDarkMode())("dark:bg-primary-900",e.active&&n.isDarkMode())("text-primary-600",e.active&&!n.isDarkMode())("dark:text-primary-300",e.active&&n.isDarkMode())("text-gray-700",!e.active&&!n.isDarkMode())("dark:text-gray-300",!e.active&&n.isDarkMode())("hover:bg-gray-50",!e.active&&!n.isDarkMode())("dark:hover:bg-gray-650",!e.active&&n.isDarkMode()),p("disabled",e.active),s(),C(" ",e.label," ")}}function Le(o,r){if(o&1&&g(0,Ve,2,18,"button",80),o&2){let e=r.$implicit;f(e.label!=="&laquo; Previous"&&e.label!=="Next &raquo;"?0:-1)}}function Ie(o,r){if(o&1){let e=b();t(0,"div",41)(1,"div",71)(2,"div")(3,"p",72),a(4," Mostrando "),t(5,"span",73),a(6),i(),a(7," a "),t(8,"span",73),a(9),i(),a(10," de "),t(11,"span",73),a(12),i(),a(13," resultados "),i()(),t(14,"div")(15,"nav",74)(16,"button",75),h("click",function(){v(e);let d=c(2);return _(d.goToPage(d.currentPage-1))}),t(17,"span",76),a(18,"Anterior"),i(),u(),t(19,"svg",60),l(20,"path",77),i()(),w(21,Le,1,1,null,null,K),x(),t(23,"button",78),h("click",function(){v(e);let d=c(2);return _(d.goToPage(d.currentPage+1))}),t(24,"span",76),a(25,"Siguiente"),i(),u(),t(26,"svg",60),l(27,"path",79),i()()()()()()}if(o&2){let e=c(2);s(6),y(e.pagination.from||0),s(3),y(e.pagination.to||0),s(3),y(e.pagination.total),s(4),j("opacity-50",!e.pagination.prev_page_url)("cursor-not-allowed",!e.pagination.prev_page_url),p("disabled",!e.pagination.prev_page_url),s(5),S(e.pagination.links),s(2),j("opacity-50",!e.pagination.next_page_url)("cursor-not-allowed",!e.pagination.next_page_url),p("disabled",!e.pagination.next_page_url)}}function je(o,r){if(o&1&&(t(0,"div",34)(1,"table",35)(2,"thead",36)(3,"tr")(4,"th",37),a(5,"Usuario"),i(),t(6,"th",37),a(7,"Email"),i(),t(8,"th",37),a(9,"Tel\xE9fono"),i(),t(10,"th",37),a(11,"Roles"),i(),t(12,"th",37),a(13,"Estado"),i(),t(14,"th",38),a(15,"Acciones"),i()()(),t(16,"tbody",39),w(17,Te,34,14,"tr",40,pe),i()()(),g(19,Ie,28,13,"div",41)),o&2){let e=c();s(17),S(e.users),s(2),f(e.pagination?19:-1)}}var Q=class o{adminService=k(T);themeService=k(N);users=[];roles=[];loading=!0;pagination=null;currentPage=1;itemsPerPage=10;filters={search:"",active:void 0,role:""};ngOnInit(){this.loadRoles(),this.loadUsers()}loadRoles(){this.adminService.getRoles().subscribe({next:r=>{this.roles=r}})}loadUsers(){this.loading=!0,this.adminService.getUsers(this.currentPage,this.itemsPerPage,this.filters.active,this.filters.role,this.filters.search).subscribe({next:r=>{this.users=r.data,this.pagination={current_page:r.current_page,from:r.from,to:r.to,total:r.total,last_page:r.last_page,links:r.links,next_page_url:r.next_page_url,prev_page_url:r.prev_page_url},this.loading=!1},error:()=>{this.loading=!1}})}getUserInitials(r){if(!r||!r.name)return"";let e=r.name.split(" ");return e.length===1?e[0].charAt(0).toUpperCase():(e[0].charAt(0)+e[1].charAt(0)).toUpperCase()}applyFilters(){this.currentPage=1,this.loadUsers()}goToPage(r){r<1||this.pagination&&r>this.pagination.last_page||(this.currentPage=r,this.loadUsers())}activateUser(r){r.id&&confirm(`\xBFEst\xE1s seguro de que deseas activar al usuario ${r.name}?`)&&this.adminService.activateUser(r.id).subscribe({next:()=>{r.active=!0,alert(`El usuario ${r.name} ha sido activado correctamente.`)},error:e=>{console.error("Error al activar usuario:",e),alert(`Error al activar al usuario: ${e.error?.message||"Ha ocurrido un error"}`)}})}deactivateUser(r){r.id&&confirm(`\xBFEst\xE1s seguro de que deseas desactivar al usuario ${r.name}?`)&&this.adminService.deactivateUser(r.id).subscribe({next:()=>{r.active=!1,alert(`El usuario ${r.name} ha sido desactivado correctamente.`)},error:e=>{console.error("Error al desactivar usuario:",e),alert(`Error al desactivar al usuario: ${e.error?.message||"Ha ocurrido un error"}`)}})}deleteUser(r){r.id&&confirm(`\xBFEst\xE1s seguro de que deseas eliminar al usuario ${r.name}? Esta acci\xF3n no se puede deshacer.`)&&this.adminService.deleteUser(r.id).subscribe({next:()=>{this.users=this.users.filter(e=>e.id!==r.id),alert(`El usuario ${r.name} ha sido eliminado correctamente.`),this.users.length===0&&this.currentPage>1?this.goToPage(this.currentPage-1):this.loadUsers()},error:e=>{console.error("Error al eliminar usuario:",e),alert(`Error al eliminar al usuario: ${e.error?.message||"Ha ocurrido un error"}`)}})}isDarkMode(){return this.themeService.isDarkMode()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=U({type:o,selectors:[["app-user-list"]],decls:47,vars:7,consts:[["title","Gesti\xF3n de Usuarios","subtitle","Administra los usuarios del sistema"],[1,"container","mx-auto","px-4","py-8","bg-gray-50","dark:bg-gray-900","min-h-screen","transition-colors","duration-200"],[1,"space-y-6"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between"],[1,"text-xl","font-semibold","text-gray-900","dark:text-white"],[1,"mt-4","sm:mt-0"],["routerLink","/admin/users/create",1,"inline-flex","items-center","rounded-md","bg-primary-600","dark:bg-primary-700","px-4","py-2","text-sm","font-medium","text-white","hover:bg-primary-700","dark:hover:bg-primary-600","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2","focus:ring-offset-gray-900","transition-colors","duration-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"rounded-lg","bg-white","dark:bg-gray-800","p-6","shadow-md","transition-colors","duration-200","border","border-gray-200","dark:border-gray-700"],[1,"grid","grid-cols-1","gap-4","md:grid-cols-4"],["for","search",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],[1,"mt-1"],["type","text","id","search","placeholder","Nombre o email",1,"input-estilo","block","w-full","rounded-md","border","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","dark:focus:border-primary-400","focus:ring-primary-500","dark:focus:ring-primary-400","sm:text-sm","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","transition-colors","duration-200",3,"ngModelChange","ngModel"],["for","active",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","active",1,"select-estilo","block","w-full","rounded-md","border","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","dark:focus:border-primary-400","focus:ring-primary-500","dark:focus:ring-primary-400","sm:text-sm","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","transition-colors","duration-200",3,"ngModelChange","ngModel"],[3,"ngValue"],["for","role",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","role",1,"select-estilo","block","w-full","rounded-md","border","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","dark:focus:border-primary-400","focus:ring-primary-500","dark:focus:ring-primary-400","sm:text-sm","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","transition-colors","duration-200",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"flex","items-end"],["type","button",1,"inline-flex","items-center","rounded-md","bg-primary-600","dark:bg-primary-700","px-4","py-2","text-sm","font-medium","text-white","hover:bg-primary-700","dark:hover:bg-primary-600","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2","focus:ring-offset-gray-900","transition-colors","duration-200",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"],[1,"rounded-lg","bg-white","dark:bg-gray-800","shadow-md","overflow-hidden","transition-colors","duration-200","border","border-gray-200","dark:border-gray-700"],[1,"flex","justify-center","items-center","p-8"],[1,"p-8","text-center"],[1,"inline-block","h-8","w-8","animate-spin","rounded-full","border-4","border-solid","border-primary-400","dark:border-primary-600","border-r-transparent"],[1,"ml-4","text-gray-900","dark:text-gray-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400","dark:text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"],[1,"mt-2","text-sm","font-medium","text-gray-900","dark:text-white"],[1,"mt-1","text-sm","text-gray-500","dark:text-gray-400"],[1,"mt-6"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200","dark:divide-gray-700","transition-colors","duration-200"],[1,"bg-gray-50","dark:bg-gray-700"],["scope","col",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","dark:text-gray-300","uppercase","tracking-wider"],["scope","col",1,"px-6","py-3","text-right","text-xs","font-medium","text-gray-500","dark:text-gray-300","uppercase","tracking-wider"],[1,"bg-white","dark:bg-gray-800","divide-y","divide-gray-200","dark:divide-gray-700"],[1,"hover:bg-gray-50","dark:hover:bg-gray-700","transition-colors","duration-150"],[1,"bg-white","dark:bg-gray-800","px-4","py-3","flex","items-center","justify-between","border-t","border-gray-200","dark:border-gray-700","transition-colors","duration-200","sm:px-6"],[1,"px-6","py-4","whitespace-nowrap"],[1,"flex","items-center"],[1,"h-10","w-10","flex-shrink-0","rounded-full","bg-primary-100","dark:bg-primary-900/40","flex","items-center","justify-center"],[1,"h-10","w-10","rounded-full","object-cover",3,"src","alt"],[1,"text-primary-800","dark:text-primary-300","font-medium"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-900","dark:text-white"],["class","text-xs text-gray-500 dark:text-gray-400",4,"ngIf"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-500","dark:text-gray-400"],[1,"flex","flex-wrap","gap-1"],[1,"text-xs","text-gray-500","dark:text-gray-400"],[1,"inline-flex","rounded-full","bg-green-100","dark:bg-green-900/40","px-2.5","py-0.5","text-xs","font-medium","text-green-800","dark:text-green-300","transition-colors","duration-200"],[1,"inline-flex","rounded-full","bg-red-100","dark:bg-red-900/40","px-2.5","py-0.5","text-xs","font-medium","text-red-800","dark:text-red-300","transition-colors","duration-200"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"flex","items-center","justify-end","space-x-2"],["title","Desactivar",1,"text-red-600","dark:text-red-400","hover:text-red-900","dark:hover:text-red-300","transition-colors","duration-200"],["title","Activar",1,"text-green-600","dark:text-green-400","hover:text-green-900","dark:hover:text-green-300","transition-colors","duration-200"],["title","Editar",1,"text-primary-600","dark:text-primary-400","hover:text-primary-900","dark:hover:text-primary-300","transition-colors","duration-200",3,"routerLink"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["title","Permisos",1,"text-primary-600","dark:text-primary-400","hover:text-primary-900","dark:hover:text-primary-300","transition-colors","duration-200",3,"routerLink"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"],["title","Eliminar",1,"text-red-600","dark:text-red-400","hover:text-red-900","dark:hover:text-red-300","transition-colors","duration-200",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"inline-flex","rounded-full","bg-blue-100","dark:bg-blue-900/40","px-2.5","py-0.5","text-xs","font-medium","text-blue-800","dark:text-blue-300","transition-colors","duration-200"],["title","Desactivar",1,"text-red-600","dark:text-red-400","hover:text-red-900","dark:hover:text-red-300","transition-colors","duration-200",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"],["title","Activar",1,"text-green-600","dark:text-green-400","hover:text-green-900","dark:hover:text-green-300","transition-colors","duration-200",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"hidden","sm:flex-1","sm:flex","sm:items-center","sm:justify-between"],[1,"text-sm","text-gray-700","dark:text-gray-300"],[1,"font-medium"],["aria-label","Pagination",1,"relative","z-0","inline-flex","rounded-md","shadow-sm","-space-x-px"],[1,"relative","inline-flex","items-center","px-2","py-2","rounded-l-md","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","text-sm","font-medium","text-gray-500","dark:text-gray-300","hover:bg-gray-50","dark:hover:bg-gray-650","transition-colors","duration-200",3,"click","disabled"],[1,"sr-only"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"relative","inline-flex","items-center","px-2","py-2","rounded-r-md","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","text-sm","font-medium","text-gray-500","dark:text-gray-300","hover:bg-gray-50","dark:hover:bg-gray-650","transition-colors","duration-200",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"relative","inline-flex","items-center","px-4","py-2","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","text-sm","font-medium","transition-colors","duration-200",3,"bg-primary-50","dark:bg-primary-900","text-primary-600","dark:text-primary-300","text-gray-700","dark:text-gray-300","hover:bg-gray-50","dark:hover:bg-gray-650","disabled"],[1,"relative","inline-flex","items-center","px-4","py-2","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","text-sm","font-medium","transition-colors","duration-200",3,"click","disabled"]],template:function(e,n){e&1&&(l(0,"app-admin-header",0),t(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),a(5,"Listado de Usuarios"),i(),t(6,"div",5)(7,"a",6),u(),t(8,"svg",7),l(9,"path",8),i(),a(10," Nuevo Usuario "),i()()(),x(),t(11,"div",9)(12,"div",10)(13,"div")(14,"label",11),a(15,"Buscar"),i(),t(16,"div",12)(17,"input",13),G("ngModelChange",function(m){return R(n.filters.search,m)||(n.filters.search=m),m}),i()()(),t(18,"div")(19,"label",14),a(20,"Estado"),i(),t(21,"div",12)(22,"select",15),G("ngModelChange",function(m){return R(n.filters.active,m)||(n.filters.active=m),m}),t(23,"option",16),a(24,"Todos"),i(),t(25,"option",16),a(26,"Activos"),i(),t(27,"option",16),a(28,"Inactivos"),i()()()(),t(29,"div")(30,"label",17),a(31,"Rol"),i(),t(32,"div",12)(33,"select",18),G("ngModelChange",function(m){return R(n.filters.role,m)||(n.filters.role=m),m}),t(34,"option",19),a(35,"Todos"),i(),w(36,ve,2,2,"option",20,pe),i()()(),t(38,"div",21)(39,"button",22),h("click",function(){return n.applyFilters()}),u(),t(40,"svg",7),l(41,"path",23),i(),a(42," Filtrar "),i()()()(),x(),t(43,"div",24),g(44,_e,4,0,"div",25)(45,ye,12,0,"div",26)(46,je,20,1),i()()()),e&2&&(s(17),A("ngModel",n.filters.search),s(5),A("ngModel",n.filters.active),s(),p("ngValue",void 0),s(2),p("ngValue",!0),s(2),p("ngValue",!1),s(6),A("ngModel",n.filters.role),s(3),S(n.roles),s(8),f(n.loading?44:n.users.length===0?45:46))},dependencies:[M,re,P,de,q,B,z,$,O,ne,W],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     .dark .bg-primary-50{background-color:#4f46e51a!important}[_nghost-%COMP%]     .dark .dark\\:bg-primary-900\\/40{background-color:#4f46e566!important}[_nghost-%COMP%]     .dark .hover\\:bg-gray-50:hover{background-color:#374151!important}[_nghost-%COMP%]     .dark .dark\\:bg-gray-750{background-color:#1f2937!important}[_nghost-%COMP%]     .dark .dark\\:hover\\:bg-gray-650:hover{background-color:#374151!important}"]})};var Ae=["fileInput"],V=o=>({"border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500":o}),Re=(o,r)=>r.id;function Ge(o,r){o&1&&(t(0,"div",11),l(1,"div",13),t(2,"span",14),a(3,"Cargando datos del usuario..."),i()())}function He(o,r){if(o&1&&l(0,"img",20),o&2){let e=c(2);p("src",e.imagePreview,I)}}function De(o,r){o&1&&(u(),t(0,"svg",21),l(1,"path",34),i())}function Ne(o,r){if(o&1){let e=b();t(0,"button",84),h("click",function(){v(e);let d=c(2);return _(d.removeSelectedImage())}),u(),t(1,"svg",85),l(2,"path",86),i(),a(3," Eliminar "),i()}}function ze(o,r){if(o&1){let e=b();t(0,"button",84),h("click",function(){v(e);let d=c(2);return _(d.removeUserPhoto())}),u(),t(1,"svg",85),l(2,"path",86),i(),a(3," Eliminar foto actual "),i()}}function Oe(o,r){o&1&&(t(0,"div",87),u(),t(1,"svg",88),l(2,"path",89),i()(),x(),t(3,"p",79),a(4,"El nombre completo es requerido"),i())}function $e(o,r){o&1&&a(0," El correo electr\xF3nico es requerido ")}function qe(o,r){o&1&&a(0," Ingrese un correo electr\xF3nico v\xE1lido ")}function Be(o,r){if(o&1&&(t(0,"div",87),u(),t(1,"svg",88),l(2,"path",89),i()(),x(),t(3,"p",79),g(4,$e,1,0)(5,qe,1,0),i()),o&2){let e,n=c(2);s(4),f(!((e=n.userForm.get("email"))==null||e.errors==null)&&e.errors.required?4:!((e=n.userForm.get("email"))==null||e.errors==null)&&e.errors.email?5:-1)}}function We(o,r){o&1&&(t(0,"div",87),u(),t(1,"svg",88),l(2,"path",89),i()(),x(),t(3,"p",79),a(4,"El tel\xE9fono es requerido"),i())}function Qe(o,r){o&1&&a(0," La contrase\xF1a es requerida ")}function Je(o,r){o&1&&a(0," La contrase\xF1a debe tener al menos 8 caracteres ")}function Ke(o,r){if(o&1&&(t(0,"div",87),u(),t(1,"svg",88),l(2,"path",89),i()(),x(),t(3,"p",79),g(4,Qe,1,0)(5,Je,1,0),i()),o&2){let e,n=c(2);s(4),f(!((e=n.userForm.get("password"))==null||e.errors==null)&&e.errors.required?4:!((e=n.userForm.get("password"))==null||e.errors==null)&&e.errors.minlength?5:-1)}}function Xe(o,r){o&1&&(t(0,"p",70),a(1,"Dejar en blanco para mantener la contrase\xF1a actual"),i())}function Ye(o,r){o&1&&a(0," La confirmaci\xF3n de contrase\xF1a es requerida ")}function Ze(o,r){o&1&&a(0," Las contrase\xF1as no coinciden ")}function et(o,r){if(o&1&&(t(0,"div",87),u(),t(1,"svg",88),l(2,"path",89),i()(),x(),t(3,"p",79),g(4,Ye,1,0)(5,Ze,1,0),i()),o&2){let e,n=c(2);s(4),f(!((e=n.userForm.get("password_confirmation"))==null||e.errors==null)&&e.errors.required?4:!((e=n.userForm.get("password_confirmation"))==null||e.errors==null)&&e.errors.mustMatch?5:-1)}}function tt(o,r){if(o&1){let e=b();t(0,"div",78)(1,"div",90)(2,"input",91),h("change",function(d){v(e);let m=c(2);return _(m.onRoleChange(d))}),i()(),t(3,"div",92)(4,"label",93),a(5),i(),t(6,"p",94),a(7),i()()()}if(o&2){let e=r.$implicit,n=c(2);s(2),p("id","role-"+e.id)("value",e.name)("checked",n.isRoleSelected(e.name)),s(2),p("for","role-"+e.id),s(),C(" ",e.name," "),s(2),C("ID: ",e.id,"")}}function rt(o,r){o&1&&(t(0,"p",79),a(1,"Seleccione al menos un rol"),i())}function it(o,r){if(o&1&&(t(0,"div",80)(1,"div",95)(2,"div",96),u(),t(3,"svg",97),l(4,"path",98),i()(),x(),t(5,"div",99)(6,"h3",100),a(7),i()()()()),o&2){let e=c(2);s(7),y(e.error)}}function nt(o,r){o&1&&(u(),t(0,"svg",101),l(1,"circle",102)(2,"path",103),i(),a(3," Guardando... "))}function ot(o,r){if(o&1&&a(0),o&2){let e=c(2);C(" ",e.isEditMode?"Actualizar":"Crear"," ")}}function at(o,r){if(o&1){let e=b();t(0,"form",15),h("ngSubmit",function(){v(e);let d=c();return _(d.onSubmit())}),t(1,"div",16)(2,"label",17),a(3,"Foto de perfil"),i(),t(4,"div",18)(5,"div",19),g(6,He,1,1,"img",20)(7,De,2,0,":svg:svg",21),i(),t(8,"div",22)(9,"label",23)(10,"span",24),u(),t(11,"svg",8),l(12,"path",25),i(),a(13," Subir foto "),i(),x(),t(14,"input",26,0),h("change",function(d){v(e);let m=c();return _(m.onFileSelected(d))}),i()(),g(16,Ne,4,0,"button",27)(17,ze,4,0,"button",27),i()()(),t(18,"div",28)(19,"div",29)(20,"label",30),a(21,"Nombre completo"),i(),t(22,"div",31)(23,"div",32),u(),t(24,"svg",33),l(25,"path",34),i()(),x(),l(26,"input",35),g(27,Oe,5,0),i()(),t(28,"div",36)(29,"label",37),a(30,"Correo electr\xF3nico"),i(),t(31,"div",31)(32,"div",32),u(),t(33,"svg",33),l(34,"path",38),i()(),x(),l(35,"input",39),g(36,Be,6,1),i()(),t(37,"div",36)(38,"label",40),a(39,"Tel\xE9fono"),i(),t(40,"div",31)(41,"div",32),u(),t(42,"svg",33),l(43,"path",41),i()(),x(),l(44,"input",42),g(45,We,5,0),i()(),t(46,"div",36)(47,"label",43),a(48,"Pa\xEDs"),i(),t(49,"div",31)(50,"div",32),u(),t(51,"svg",33),l(52,"path",44),i()(),x(),l(53,"input",45),i()(),t(54,"div",36)(55,"label",46),a(56,"Direcci\xF3n"),i(),t(57,"div",31)(58,"div",32),u(),t(59,"svg",33),l(60,"path",47)(61,"path",48),i()(),x(),l(62,"input",49),i()(),t(63,"div",36)(64,"label",50),a(65,"Fecha de nacimiento"),i(),t(66,"div",31)(67,"div",32),u(),t(68,"svg",33),l(69,"path",51),i()(),x(),l(70,"input",52),i()(),t(71,"div",36)(72,"label",53),a(73,"G\xE9nero"),i(),t(74,"div",31)(75,"div",32),u(),t(76,"svg",33),l(77,"path",34),i()(),x(),t(78,"select",54)(79,"option",55),a(80,"Seleccionar g\xE9nero"),i(),t(81,"option",56),a(82,"Masculino"),i(),t(83,"option",57),a(84,"Femenino"),i(),t(85,"option",58),a(86,"Otro"),i(),t(87,"option",59),a(88,"Prefiero no decirlo"),i()()()(),t(89,"div",36)(90,"label",60),a(91,"Idioma preferido"),i(),t(92,"div",31)(93,"div",32),u(),t(94,"svg",33),l(95,"path",61),i()(),x(),t(96,"select",62)(97,"option",55),a(98,"Seleccionar idioma"),i(),t(99,"option",63),a(100,"Espa\xF1ol"),i(),t(101,"option",64),a(102,"Ingl\xE9s"),i(),t(103,"option",65),a(104,"Portugu\xE9s"),i(),t(105,"option",66),a(106,"Franc\xE9s"),i()()()(),t(107,"div",36)(108,"label",67),a(109,"Contrase\xF1a"),i(),t(110,"div",31)(111,"div",32),u(),t(112,"svg",33),l(113,"path",68),i()(),x(),l(114,"input",69),g(115,Ke,6,1)(116,Xe,2,0,"p",70),i()(),t(117,"div",36)(118,"label",71),a(119,"Confirmar contrase\xF1a"),i(),t(120,"div",31)(121,"div",32),u(),t(122,"svg",33),l(123,"path",72),i()(),x(),l(124,"input",73),g(125,et,6,1),i()(),t(126,"div",36)(127,"label",74),a(128,"Estado"),i(),t(129,"div",31)(130,"div",32),u(),t(131,"svg",33),l(132,"path",75),i()(),x(),t(133,"select",76)(134,"option",55),a(135,"Activo"),i(),t(136,"option",55),a(137,"Inactivo"),i()()()(),t(138,"div",29)(139,"label",17),a(140,"Roles"),i(),t(141,"div",77),w(142,tt,8,6,"div",78,Re),i(),g(144,rt,2,0,"p",79),i()(),g(145,it,8,1,"div",80),t(146,"div",81)(147,"button",82),a(148," Cancelar "),i(),t(149,"button",83),g(150,nt,4,0)(151,ot,1,1),i()()()}if(o&2){let e,n=c();p("formGroup",n.userForm),s(6),f(n.imagePreview?6:7),s(10),f(n.imagePreview&&!n.isUserPhoto?16:n.imagePreview&&n.isUserPhoto?17:-1),s(10),p("ngClass",E(22,V,n.isFieldInvalid("name"))),s(),f(n.isFieldInvalid("name")?27:-1),s(8),p("ngClass",E(24,V,n.isFieldInvalid("email"))),s(),f(n.isFieldInvalid("email")?36:-1),s(8),p("ngClass",E(26,V,n.isFieldInvalid("phone"))),s(),f(n.isFieldInvalid("phone")?45:-1),s(34),p("ngValue",null),s(18),p("ngValue",null),s(17),p("ngClass",E(28,V,n.isFieldInvalid("password"))),s(),f(n.isFieldInvalid("password")?115:-1),s(),f(n.isEditMode?116:-1),s(8),p("ngClass",E(30,V,n.isFieldInvalid("password_confirmation"))),s(),f(n.isFieldInvalid("password_confirmation")?125:-1),s(9),p("ngValue",!0),s(2),p("ngValue",!1),s(6),S(n.availableRoles),s(2),f(((e=n.userForm.get("roles"))==null?null:e.value.length)===0&&n.submitted?144:-1),s(),f(n.error?145:-1),s(4),p("disabled",n.saving),s(),f(n.saving?150:151)}}var L=class o{fb=k(le);adminService=k(T);route=k(H);router=k(D);themeService=k(N);fileInput;userForm;availableRoles=[];userId=null;originalRoles=[];loading=!1;saving=!1;submitted=!1;error="";imagePreview=null;selectedFile=null;isUserPhoto=!1;photoRemoved=!1;get isEditMode(){return this.userId!==null}ngOnInit(){this.initForm(),this.loadRoles();let r=this.route.snapshot.paramMap.get("id");r&&(this.userId=+r,this.loading=!0,this.loadUser(this.userId))}initForm(){this.userForm=this.fb.group({name:["",F.required],email:["",[F.required,F.email]],phone:["",F.required],password:["",this.isEditMode?[]:[F.required,F.minLength(8)]],password_confirmation:["",this.isEditMode?[]:[F.required]],active:[!0],country:[""],birth_date:[""],address:[""],gender:[""],preferred_language:[""],roles:[[]]},{validators:this.mustMatch("password","password_confirmation")}),console.log("Formulario inicializado:",this.userForm.value)}loadRoles(){this.adminService.getRoles().subscribe({next:r=>{this.availableRoles=r},error:r=>{console.error("Error al cargar roles:",r),this.error="Error al cargar los roles. Por favor, intente nuevamente."}})}loadUser(r){this.loading=!0,this.adminService.getUser(r).subscribe({next:e=>{console.log("Respuesta completa:",e);try{if(e&&e.success&&e.data){let n=e.data;if(n){if(console.log("Datos de usuario encontrados:",n),this.userForm.patchValue({name:n.name||"",email:n.email||"",phone:n.phone||"",active:!!n.active,country:n.country||"",address:n.address||"",gender:n.gender||"",preferred_language:n.preferred_language||""}),n.birth_date)try{let d=new Date(n.birth_date);if(isNaN(d.getTime()))this.userForm.get("birth_date")?.setValue(n.birth_date);else{let m=d.toISOString().split("T")[0];this.userForm.get("birth_date")?.setValue(m)}}catch(d){console.error("Error al procesar la fecha:",d)}n.foto_perfil&&(console.log("Foto de perfil encontrada:",n.foto_perfil),this.imagePreview=n.foto_perfil,this.isUserPhoto=!0),n.roles&&Array.isArray(n.roles)?(console.log("Roles encontrados:",n.roles),this.originalRoles=[...n.roles],this.userForm.get("roles")?.setValue(n.roles)):(console.warn("No se encontraron roles en la respuesta"),this.userForm.get("roles")?.setValue([])),e.available_roles&&Array.isArray(e.available_roles)&&(this.availableRoles=e.available_roles),console.log("Formulario actualizado:",this.userForm.value)}else console.error("No se encontraron datos de usuario en la respuesta"),this.error="No se encontraron datos del usuario."}else console.error("Formato de respuesta inesperado",e),this.error="Error al cargar los datos del usuario."}catch(n){console.error("Error al procesar datos del usuario:",n),this.error="Error al procesar los datos del usuario: "+(n instanceof Error?n.message:String(n))}this.loading=!1},error:e=>{console.error("Error al cargar usuario:",e),this.error="Error al cargar los datos del usuario: "+(e.error?.message||e.message||"Error desconocido"),this.loading=!1}})}onFileSelected(r){let e=r.target;if(e.files&&e.files.length>0){this.selectedFile=e.files[0];let n=new FileReader;n.onload=()=>{this.imagePreview=n.result,this.isUserPhoto=!1},n.readAsDataURL(this.selectedFile)}}removeSelectedImage(){this.selectedFile=null,this.imagePreview=null,this.fileInput&&(this.fileInput.nativeElement.value="")}removeUserPhoto(){this.userId&&confirm("\xBFEst\xE1 seguro de que desea eliminar la foto de perfil? Esta acci\xF3n no se puede deshacer.")&&this.adminService.deleteUserProfilePhoto(this.userId).subscribe({next:()=>{this.imagePreview=null,this.isUserPhoto=!1,this.photoRemoved=!0,alert("Foto de perfil eliminada correctamente")},error:r=>{console.error("Error al eliminar foto de perfil:",r),this.error="Error al eliminar la foto de perfil."}})}onRoleChange(r){let e=r.target,n=e.value,d=[...this.userForm.get("roles")?.value||[]];if(e.checked)d.includes(n)||d.push(n);else{let m=d.indexOf(n);m!==-1&&d.splice(m,1)}this.userForm.get("roles")?.setValue(d)}isRoleSelected(r){return(this.userForm.get("roles")?.value||[]).includes(r)}isFieldInvalid(r){let e=this.userForm.get(r);return e?.invalid&&(e?.dirty||e?.touched||this.submitted)||!1}mustMatch(r,e){return n=>{let d=n.controls[r],m=n.controls[e];return!d.value||m.errors&&!m.errors.mustMatch||(d.value!==m.value?m.setErrors({mustMatch:!0}):m.setErrors(null)),null}}prepareFormData(){let r=new FormData,e=this.userForm.value;return Object.keys(e).forEach(n=>{n==="password"&&this.isEditMode&&!e[n]||n!=="password_confirmation"&&n!=="roles"&&(n==="active"&&e[n]!==null&&e[n]!==void 0?r.append(n,e[n]?"1":"0"):e[n]!==null&&e[n]!==void 0&&r.append(n,e[n]))}),this.selectedFile&&r.append("foto_perfil",this.selectedFile),r}onSubmit(){if(this.submitted=!0,this.error="",this.userForm.invalid)return;let r=this.prepareFormData(),e=this.userForm.get("roles")?.value||[];this.saving=!0,this.isEditMode&&this.userId?this.adminService.updateUser(this.userId,r).subscribe({next:n=>{console.log("Usuario actualizado:",n),this.haveRolesChanged(this.originalRoles,e)?this.updateUserRoles(this.userId,e):(this.saving=!1,alert("Usuario actualizado correctamente"),this.router.navigate(["/admin/users"]))},error:n=>{console.error("Error al actualizar usuario:",n),this.error=n.error?.message||"Error al actualizar el usuario. Por favor, intente nuevamente.",this.saving=!1}}):(e&&e.length>0&&(r.delete("roles[]"),e.forEach(n=>{r.append("roles[]",n)})),this.adminService.createUser(r).subscribe({next:n=>{this.saving=!1,alert("Usuario creado correctamente"),this.router.navigate(["/admin/users"])},error:n=>{console.error("Error al crear usuario:",n),this.error=n.error?.message||"Error al crear el usuario. Por favor, intente nuevamente.",this.saving=!1}}))}haveRolesChanged(r,e){if(r.length!==e.length)return!0;let n=[...r].sort(),d=[...e].sort();for(let m=0;m<n.length;m++)if(n[m]!==d[m])return!0;return!1}updateUserRoles(r,e){if(r===null){console.error("ID de usuario no v\xE1lido"),this.error="Error al actualizar roles: ID de usuario no v\xE1lido",this.saving=!1;return}this.adminService.assignRolesToUser(r,e).subscribe({next:()=>{this.saving=!1,this.originalRoles=[...e],alert("Usuario y roles actualizados correctamente"),this.router.navigate(["/admin/users"])},error:n=>{console.error("Error al actualizar roles:",n),this.error=n.error?.message||"Error al actualizar los roles. Por favor, intente nuevamente.",this.saving=!1}})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=U({type:o,selectors:[["app-user-form"]],viewQuery:function(e,n){if(e&1&&Y(Ae,5),e&2){let d;Z(d=ee())&&(n.fileInput=d.first)}},decls:14,vars:4,consts:[["fileInput",""],[3,"title","subtitle"],[1,"container","mx-auto","px-4","py-8","bg-gray-50","dark:bg-gray-900","min-h-screen","transition-colors","duration-200"],[1,"space-y-6"],[1,"sm:flex","sm:items-center","sm:justify-between"],[1,"text-xl","font-semibold","text-gray-900","dark:text-white"],[1,"mt-4","sm:mt-0"],["routerLink","/admin/users",1,"inline-flex","items-center","rounded-md","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","px-4","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-200","shadow-sm","hover:bg-gray-50","dark:hover:bg-gray-600","focus:outline-none","focus:ring-2","focus:ring-primary-500","dark:focus:ring-primary-400","focus:ring-offset-2","focus:ring-offset-gray-900","transition-colors","duration-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5","text-gray-500","dark:text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"bg-white","dark:bg-gray-800","shadow-md","rounded-lg","transition-colors","duration-200","border","border-gray-200","dark:border-gray-700"],[1,"flex","justify-center","items-center","p-8"],[1,"space-y-6","p-6",3,"formGroup"],[1,"inline-block","h-8","w-8","animate-spin","rounded-full","border-4","border-solid","border-primary-400","dark:border-primary-600","border-r-transparent"],[1,"ml-4","text-gray-700","dark:text-gray-300"],[1,"space-y-6","p-6",3,"ngSubmit","formGroup"],[1,"sm:col-span-6","flex","flex-col","items-center","sm:items-start"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-2"],[1,"flex","items-center"],[1,"h-24","w-24","rounded-full","overflow-hidden","bg-gray-100","dark:bg-gray-700","flex","items-center","justify-center","border-2","border-gray-300","dark:border-gray-600"],["alt","Vista previa de la foto",1,"h-full","w-full","object-cover",3,"src"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-12","w-12","text-gray-400","dark:text-gray-500"],[1,"ml-5","flex","flex-col","space-y-2"],["for","foto_perfil",1,"relative","cursor-pointer","rounded-md","bg-white","dark:bg-gray-700","font-medium","text-primary-600","dark:text-primary-400","hover:text-primary-500","dark:hover:text-primary-300","focus-within:outline-none"],[1,"inline-flex","items-center","rounded-md","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","px-4","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-200","shadow-sm","hover:bg-gray-50","dark:hover:bg-gray-600","focus:outline-none","focus:ring-2","focus:ring-primary-500","dark:focus:ring-primary-400","focus:ring-offset-2","transition-colors","duration-200"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"],["id","foto_perfil","type","file","accept","image/*",1,"sr-only",3,"change"],["type","button",1,"inline-flex","items-center","rounded-md","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","px-4","py-2","text-sm","font-medium","text-red-600","dark:text-red-400","shadow-sm","hover:bg-gray-50","dark:hover:bg-gray-600","focus:outline-none","focus:ring-2","focus:ring-red-500","dark:focus:ring-red-400","focus:ring-offset-2","transition-colors","duration-200"],[1,"grid","grid-cols-1","gap-y-6","gap-x-4","sm:grid-cols-6"],[1,"sm:col-span-6"],["for","name",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],[1,"mt-1","relative","rounded-md","shadow-sm"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-gray-400","dark:text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],["type","text","id","name","formControlName","name","placeholder","Ingrese el nombre completo",1,"pl-10","py-3","block","w-full","rounded-md","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","dark:focus:border-primary-400","focus:ring-primary-500","dark:focus:ring-primary-400","sm:text-base","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","transition-colors","duration-200",3,"ngClass"],[1,"sm:col-span-3"],["for","email",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"],["type","email","id","email","formControlName","email","placeholder","correo@ejemplo.com",1,"pl-10","py-3","block","w-full","rounded-md","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","dark:focus:border-primary-400","focus:ring-primary-500","dark:focus:ring-primary-400","sm:text-base","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","transition-colors","duration-200",3,"ngClass"],["for","phone",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"],["type","tel","id","phone","formControlName","phone","placeholder","999888777",1,"pl-10","py-3","block","w-full","rounded-md","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","dark:focus:border-primary-400","focus:ring-primary-500","dark:focus:ring-primary-400","sm:text-base","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","transition-colors","duration-200",3,"ngClass"],["for","country",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],["type","text","id","country","formControlName","country","placeholder","Ingrese el pa\xEDs",1,"pl-10","py-3","block","w-full","rounded-md","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","dark:focus:border-primary-400","focus:ring-primary-500","dark:focus:ring-primary-400","sm:text-base","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","transition-colors","duration-200"],["for","address",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 11a3 3 0 11-6 0 3 3 0 016 0z"],["type","text","id","address","formControlName","address","placeholder","Ingrese la direcci\xF3n",1,"pl-10","py-3","block","w-full","rounded-md","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","dark:focus:border-primary-400","focus:ring-primary-500","dark:focus:ring-primary-400","sm:text-base","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","transition-colors","duration-200"],["for","birth_date",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],["type","date","id","birth_date","formControlName","birth_date",1,"pl-10","py-3","block","w-full","rounded-md","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","dark:focus:border-primary-400","focus:ring-primary-500","dark:focus:ring-primary-400","sm:text-base","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","transition-colors","duration-200"],["for","gender",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","gender","formControlName","gender",1,"pl-10","py-3","block","w-full","rounded-md","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","dark:focus:border-primary-400","focus:ring-primary-500","dark:focus:ring-primary-400","sm:text-base","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","transition-colors","duration-200"],[3,"ngValue"],["value","male"],["value","female"],["value","other"],["value","prefer_not_to_say"],["for","preferred_language",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"],["id","preferred_language","formControlName","preferred_language",1,"pl-10","py-3","block","w-full","rounded-md","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","dark:focus:border-primary-400","focus:ring-primary-500","dark:focus:ring-primary-400","sm:text-base","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","transition-colors","duration-200"],["value","es"],["value","en"],["value","pt"],["value","fr"],["for","password",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"],["type","password","id","password","formControlName","password","placeholder","Ingrese la contrase\xF1a",1,"pl-10","py-3","block","w-full","rounded-md","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","dark:focus:border-primary-400","focus:ring-primary-500","dark:focus:ring-primary-400","sm:text-base","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","transition-colors","duration-200",3,"ngClass"],[1,"mt-2","text-sm","text-gray-500","dark:text-gray-400"],["for","password_confirmation",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"],["type","password","id","password_confirmation","formControlName","password_confirmation","placeholder","Confirme la contrase\xF1a",1,"pl-10","py-3","block","w-full","rounded-md","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","dark:focus:border-primary-400","focus:ring-primary-500","dark:focus:ring-primary-400","sm:text-base","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","transition-colors","duration-200",3,"ngClass"],["for","active",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],["id","active","formControlName","active",1,"pl-10","py-3","block","w-full","rounded-md","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","dark:focus:border-primary-400","focus:ring-primary-500","dark:focus:ring-primary-400","sm:text-base","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","transition-colors","duration-200"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-3"],[1,"relative","flex","items-start","hover:bg-gray-50","dark:hover:bg-gray-700","p-3","rounded-lg","transition-colors","duration-150","border","border-gray-200","dark:border-gray-700"],[1,"mt-2","text-sm","text-red-600","dark:text-red-400"],[1,"rounded-md","bg-red-50","dark:bg-red-900/20","p-4","transition-colors","duration-200"],[1,"flex","justify-end","space-x-3"],["type","button","routerLink","/admin/users",1,"inline-flex","justify-center","rounded-md","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","px-4","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-200","shadow-sm","hover:bg-gray-50","dark:hover:bg-gray-600","focus:outline-none","focus:ring-2","focus:ring-primary-500","dark:focus:ring-primary-400","focus:ring-offset-2","transition-colors","duration-200"],["type","submit",1,"inline-flex","justify-center","rounded-md","border","border-transparent","bg-primary-600","dark:bg-primary-700","px-6","py-2","text-sm","font-medium","text-white","shadow-sm","hover:bg-primary-700","dark:hover:bg-primary-600","focus:outline-none","focus:ring-2","focus:ring-primary-500","dark:focus:ring-primary-400","focus:ring-offset-2","transition-colors","duration-200",3,"disabled"],["type","button",1,"inline-flex","items-center","rounded-md","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","px-4","py-2","text-sm","font-medium","text-red-600","dark:text-red-400","shadow-sm","hover:bg-gray-50","dark:hover:bg-gray-600","focus:outline-none","focus:ring-2","focus:ring-red-500","dark:focus:ring-red-400","focus:ring-offset-2","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"absolute","inset-y-0","right-0","flex","items-center","pr-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"flex","items-center","h-5"],["type","checkbox",1,"h-5","w-5","rounded","border-gray-300","dark:border-gray-600","text-primary-600","dark:text-primary-500","focus:ring-primary-500","dark:focus:ring-primary-400","transition-colors","duration-200",3,"change","id","value","checked"],[1,"ml-3","text-sm"],[1,"font-medium","text-gray-700","dark:text-gray-300",3,"for"],[1,"text-gray-500","dark:text-gray-400","text-xs"],[1,"flex"],[1,"flex-shrink-0"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-red-400","dark:text-red-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],[1,"ml-3"],[1,"text-sm","font-medium","text-red-800","dark:text-red-300"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-2","h-4","w-4","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,n){e&1&&(l(0,"app-admin-header",1),t(1,"div",2)(2,"div",3)(3,"div",4)(4,"h2",5),a(5),i(),t(6,"div",6)(7,"a",7),u(),t(8,"svg",8),l(9,"path",9),i(),a(10," Volver al listado "),i()()(),x(),t(11,"div",10),g(12,Ge,4,0,"div",11)(13,at,152,32,"form",12),i()()()),e&2&&(p("title",n.isEditMode?"Editar Usuario":"Crear Usuario")("subtitle",n.isEditMode?"Modificar informaci\xF3n del usuario":"Agregar un nuevo usuario al sistema"),s(5),y(n.isEditMode?"Formulario de Edici\xF3n":"Formulario de Creaci\xF3n"),s(7),f(n.loading?12:13))},dependencies:[M,te,P,me,oe,q,B,z,$,O,ie,ae,se,W],styles:[`[_nghost-%COMP%]{display:block;min-height:100vh;background-color:#f9fafb}.dark-theme[_nghost-%COMP%], .dark-theme   [_nghost-%COMP%]{background-color:#111827}.dark[_ngcontent-%COMP%]   .hover[_ngcontent-%COMP%]:bg-gray-50:hover{background-color:#374151!important}input[type=checkbox][_ngcontent-%COMP%]:checked{background-image:url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e")}`]})};var st=(o,r)=>r.id;function lt(o,r){o&1&&(t(0,"div",7)(1,"div",10),l(2,"div",11),t(3,"span",12),a(4,"Cargando permisos..."),i()()())}function dt(o,r){if(o&1&&(t(0,"div",8)(1,"div",13)(2,"div",14)(3,"h3",15),a(4),i()()()()),o&2){let e=c();s(4),y(e.error)}}function mt(o,r){if(o&1){let e=b();t(0,"div",29)(1,"input",36),h("change",function(){let d=v(e).$implicit,m=c(2);return _(m.togglePermission(d.name))}),i(),t(2,"label",37),a(3),i()()}if(o&2){let e=r.$implicit,n=c(2);s(),p("id","permission-"+e.id)("value",e.name)("checked",n.isPermissionSelected(e.name)),s(),p("for","permission-"+e.id),s(),C(" ",e.name," ")}}function ct(o,r){if(o&1&&(t(0,"span",38),a(1),i()),o&2){let e=r.$implicit;s(),C(" ",e," ")}}function ut(o,r){if(o&1&&(t(0,"div",32),w(1,ct,2,1,"span",38,X),i()),o&2){let e=c(2);s(),S(e.userPermissions==null?null:e.userPermissions.permissions_via_roles)}}function pt(o,r){o&1&&(t(0,"p",33),a(1,"Este usuario no tiene permisos asignados a trav\xE9s de roles."),i())}function gt(o,r){o&1&&(u(),t(0,"svg",39),l(1,"circle",40)(2,"path",41),i(),a(3," Guardando... "))}function ft(o,r){o&1&&a(0," Guardar Cambios ")}function xt(o,r){if(o&1){let e=b();t(0,"div",9)(1,"div",16)(2,"div",17)(3,"div",18)(4,"div",19)(5,"span",20),a(6),i()()(),t(7,"div",21)(8,"h2",22),a(9),i(),t(10,"p",23),a(11),i()()()(),t(12,"div",24)(13,"h3",22),a(14,"Administrar Permisos"),i(),t(15,"p",25),a(16,"Seleccione los permisos que desea asignar directamente a este usuario."),i(),t(17,"div",26)(18,"div")(19,"h4",27),a(20,"Permisos disponibles"),i(),t(21,"div",28),w(22,mt,4,5,"div",29,st),i()(),t(24,"div",30)(25,"h4",27),a(26,"Permisos desde roles"),i(),t(27,"p",25),a(28,"Estos permisos provienen de los roles asignados al usuario y no pueden ser modificados directamente."),i(),t(29,"div",31),g(30,ut,3,0,"div",32)(31,pt,2,0,"p",33),i()(),t(32,"div",34)(33,"button",35),h("click",function(){v(e);let d=c();return _(d.savePermissions())}),g(34,gt,4,0)(35,ft,1,0),i()()()()()}if(o&2){let e=c();s(6),y(e.getUserInitials(e.userPermissions==null?null:e.userPermissions.user)),s(3),y(e.userPermissions==null||e.userPermissions.user==null?null:e.userPermissions.user.name),s(2),y(e.userPermissions==null||e.userPermissions.user==null?null:e.userPermissions.user.email),s(11),S(e.availablePermissions),s(8),f(!(e.userPermissions==null||e.userPermissions.permissions_via_roles==null)&&e.userPermissions.permissions_via_roles.length?30:31),s(3),p("disabled",e.saving),s(),f(e.saving?34:35)}}var J=class o{adminService=k(T);route=k(H);router=k(D);userId=null;userPermissions=null;availablePermissions=[];selectedPermissions=[];loading=!0;saving=!1;error="";ngOnInit(){let r=this.route.snapshot.paramMap.get("id");r?(this.userId=+r,this.loadPermissions(),this.loadAllPermissions()):(this.error="ID de usuario no v\xE1lido",this.loading=!1)}loadPermissions(){this.userId&&this.adminService.getUserPermissions(this.userId).subscribe({next:r=>{this.userPermissions=r.data,this.selectedPermissions=[...this.userPermissions?.direct_permissions??[]],this.loading=!1},error:r=>{console.error("Error al cargar permisos del usuario:",r),this.error="Error al cargar los permisos del usuario. Por favor, intente nuevamente.",this.loading=!1}})}loadAllPermissions(){this.adminService.getPermissions().subscribe({next:r=>{this.availablePermissions=r},error:r=>{console.error("Error al cargar permisos disponibles:",r),this.error="Error al cargar los permisos disponibles. Por favor, intente nuevamente."}})}getUserInitials(r){if(!r||!r.name)return"";let e=r.name.split(" ");return e.length===1?e[0].charAt(0).toUpperCase():(e[0].charAt(0)+e[1].charAt(0)).toUpperCase()}isPermissionSelected(r){return this.selectedPermissions.includes(r)}togglePermission(r){let e=this.selectedPermissions.indexOf(r);e===-1?this.selectedPermissions.push(r):this.selectedPermissions.splice(e,1)}savePermissions(){this.userId&&(this.saving=!0,this.error="",this.adminService.assignPermissionsToUser(this.userId,this.selectedPermissions).subscribe({next:()=>{this.saving=!1,alert("Permisos guardados correctamente"),this.loadPermissions()},error:r=>{console.error("Error al guardar permisos:",r),this.error=r.error?.message||"Error al guardar los permisos. Por favor, intente nuevamente.",this.saving=!1}}))}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=U({type:o,selectors:[["app-user-permissions"]],decls:12,vars:1,consts:[[1,"space-y-6"],[1,"sm:flex","sm:items-center","sm:justify-between"],[1,"text-2xl","font-bold","text-gray-900","dark:text-white"],[1,"mt-4","sm:mt-0"],["routerLink","/admin/users",1,"inline-flex","items-center","rounded-md","border","border-gray-300","bg-white","px-4","py-2","text-sm","font-medium","text-gray-700","shadow-sm","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2","dark:bg-gray-800","dark:border-gray-600","dark:text-gray-300","dark:hover:bg-gray-700","dark:focus:ring-offset-gray-900"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5","text-gray-500","dark:text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"rounded-lg","bg-white","shadow-sm","dark:bg-gray-800"],[1,"rounded-md","bg-red-50","p-4","dark:bg-red-900/20"],[1,"overflow-hidden","rounded-lg","bg-white","shadow-sm","dark:bg-gray-800"],[1,"flex","items-center","justify-center","p-8"],["role","status",1,"inline-block","h-8","w-8","animate-spin","rounded-full","border-4","border-solid","border-primary-500","border-r-transparent","align-[-0.125em]","text-primary","motion-reduce:animate-[spin_1.5s_linear_infinite]"],[1,"ml-4","text-gray-700","dark:text-gray-300"],[1,"flex"],[1,"ml-3"],[1,"text-sm","font-medium","text-red-800","dark:text-red-300"],[1,"border-b","border-gray-200","bg-white","px-6","py-5","dark:border-gray-700","dark:bg-gray-800"],[1,"flex","flex-wrap","items-center"],[1,"flex-shrink-0"],[1,"flex","h-12","w-12","items-center","justify-center","rounded-full","bg-primary-100","dark:bg-primary-900/50"],[1,"text-lg","font-medium","text-primary-800","dark:text-primary-300"],[1,"ml-4"],[1,"text-lg","font-medium","text-gray-900","dark:text-white"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"px-6","py-5"],[1,"mt-1","text-sm","text-gray-500","dark:text-gray-400"],[1,"mt-6","space-y-6"],[1,"text-sm","font-medium","text-gray-900","dark:text-white"],[1,"mt-4","grid","grid-cols-1","gap-x-4","gap-y-2","sm:grid-cols-2","lg:grid-cols-3"],[1,"flex","items-center"],[1,"border-t","border-gray-200","pt-6","dark:border-gray-700"],[1,"mt-4"],[1,"flex","flex-wrap","gap-2"],[1,"text-sm","italic","text-gray-500","dark:text-gray-400"],[1,"flex","justify-end"],["type","button",1,"inline-flex","justify-center","rounded-md","border","border-transparent","bg-primary-600","px-4","py-2","text-sm","font-medium","text-white","shadow-sm","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2","disabled:opacity-50","dark:focus:ring-offset-gray-800",3,"click","disabled"],["type","checkbox",1,"h-4","w-4","rounded","border-gray-300","bg-gray-100","text-primary-600","focus:ring-primary-500","dark:border-gray-600","dark:bg-gray-700","dark:ring-offset-gray-800","dark:focus:ring-primary-600",3,"change","id","value","checked"],[1,"ml-2","block","text-sm","text-gray-700","dark:text-gray-300",3,"for"],[1,"inline-flex","rounded-full","bg-gray-100","px-2.5","py-0.5","text-xs","font-medium","text-gray-800","dark:bg-gray-700","dark:text-gray-200"],["fill","none","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5","animate-spin","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,n){e&1&&(t(0,"div",0)(1,"div",1)(2,"h1",2),a(3,"Permisos de Usuario"),i(),t(4,"div",3)(5,"a",4),u(),t(6,"svg",5),l(7,"path",6),i(),a(8," Volver al listado "),i()()(),g(9,lt,5,0,"div",7)(10,dt,5,1,"div",8)(11,xt,36,6,"div",9),i()),e&2&&(s(9),f(n.loading?9:n.error?10:11))},dependencies:[M,P],encapsulation:2})};var Xt=[{path:"",component:Q,title:"Listado de Usuarios"},{path:"create",component:L,title:"Crear Usuario"},{path:"edit/:id",component:L,title:"Editar Usuario"},{path:":id/permissions",component:J,title:"Permisos de Usuario"}];export{Xt as USERS_ROUTES};
