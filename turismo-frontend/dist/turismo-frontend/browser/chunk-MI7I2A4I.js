import{a as U,b as B,c as z,d as q,e as H,h as W,i as J,l as K,o as Q,x as X,y as Y,z as Z}from"./chunk-KTW5JVGU.js";import{Gb as a,Hb as _,Hc as L,Ib as E,La as l,Lb as O,Mb as V,Nb as D,Oc as j,Pb as N,Pc as $,Sc as G,U as k,Va as M,_ as C,_a as x,fb as g,ga as p,ha as u,hb as v,ia as I,ib as y,ja as P,ob as n,p as b,pb as r,qb as f,rb as T,sb as F,tb as h,ub as m,vb as c,vc as R,wc as A}from"./chunk-ETYZCZA5.js";import"./chunk-4CLCTAJ7.js";var w=class s{http=C($);API_URL=G.apiUrl;getCategorias(t=1,e=10,i){let o=new j().set("page",t.toString()).set("per_page",e.toString());return i&&(o=o.set("search",i)),this.http.get(`${this.API_URL}/categorias`,{params:o}).pipe(b(d=>d.data))}getCategoria(t){return this.http.get(`${this.API_URL}/categorias/${t}`).pipe(b(e=>e.data))}createCategoria(t){return this.http.post(`${this.API_URL}/categorias`,t).pipe(b(e=>e.data))}updateCategoria(t,e){return this.http.put(`${this.API_URL}/categorias/${t}`,e).pipe(b(i=>i.data))}deleteCategoria(t){return this.http.delete(`${this.API_URL}/categorias/${t}`)}toggleEstado(t,e){return this.http.patch(`${this.API_URL}/categorias/${t}/estado`,{estado:e}).pipe(b(i=>i.data))}static \u0275fac=function(e){return new(e||s)};static \u0275prov=k({token:s,factory:s.\u0275fac,providedIn:"root"})};var te=()=>[];function ie(s,t){s&1&&(n(0,"tr")(1,"td",16),a(2,"Cargando categor\xEDas..."),r()())}function re(s,t){s&1&&(n(0,"tr")(1,"td",16),a(2,"No se encontraron categor\xEDas"),r()())}function ne(s,t){if(s&1){let e=h();n(0,"tr",17)(1,"td",18),a(2),r(),n(3,"td",18),a(4),r(),n(5,"td",18),a(6),r(),n(7,"td",18)(8,"span",19),a(9),r()(),n(10,"td",18),a(11),r(),n(12,"td",20)(13,"button",21),m("click",function(){let o=p(e).$implicit,d=c();return u(d.openEditModal(o))}),a(14," Editar "),r(),n(15,"button",22),m("click",function(){let o=p(e).$implicit,d=c();return u(d.toggleEstado(o))}),a(16),r(),n(17,"button",23),m("click",function(){let o=p(e).$implicit,d=c();return u(d.deleteCategoria(o.id))}),a(18," Eliminar "),r()()()}if(s&2){let e=t.$implicit,i=c();l(2),_(e.id),l(2),_(e.nombre),l(2),_(e.descripcion||"Sin descripci\xF3n"),l(2),y(e.estado?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),l(),E(" ",e.estado?"Activo":"Inactivo"," "),l(2),_(i.formatDate(e.created_at)),l(4),y(e.estado?"bg-orange-500 hover:bg-orange-600":"bg-green-500 hover:bg-green-600"),l(),E(" ",e.estado?"Desactivar":"Activar"," ")}}function oe(s,t){if(s&1){let e=h();T(0),n(1,"button",29),m("click",function(){let o=p(e).index,d=c(2);return u(d.changePage(o+1))}),a(2),r(),F()}if(s&2){let e=t.index,i=c(2);l(),y(i.currentPage===e+1?"bg-blue-600 text-white":"bg-white"),l(),E(" ",e+1," ")}}function ae(s,t){if(s&1){let e=h();n(0,"div",24)(1,"nav",25)(2,"button",26),m("click",function(){p(e);let o=c();return u(o.changePage(o.currentPage-1))}),a(3," Anterior "),r(),x(4,oe,3,3,"ng-container",27),n(5,"button",28),m("click",function(){p(e);let o=c();return u(o.changePage(o.currentPage+1))}),a(6," Siguiente "),r()()()}if(s&2){let e=c();l(2),v("opacity-50",e.currentPage===1),g("disabled",e.currentPage===1),l(2),g("ngForOf",N(7,te).constructor(e.paginacion.last_page)),l(),v("opacity-50",e.currentPage===e.paginacion.last_page),g("disabled",e.currentPage===e.paginacion.last_page)}}function se(s,t){s&1&&(n(0,"div",52),a(1," El nombre es obligatorio "),r())}function le(s,t){if(s&1){let e=h();n(0,"div",30)(1,"div",31)(2,"div",32)(3,"h2",33),a(4),r(),n(5,"button",34),m("click",function(){p(e);let o=c();return u(o.closeModal())}),I(),n(6,"svg",35),f(7,"path",36),r()()(),P(),n(8,"form",37),m("ngSubmit",function(){p(e);let o=c();return u(o.saveCategoria())}),n(9,"div",38)(10,"label",39),a(11,"Nombre *"),r(),f(12,"input",40),x(13,se,2,0,"div",41),r(),n(14,"div",38)(15,"label",42),a(16,"Descripci\xF3n"),r(),f(17,"textarea",43),r(),n(18,"div",38)(19,"label",44),a(20,"URL de Imagen"),r(),f(21,"input",45),r(),n(22,"div",46),f(23,"input",47),n(24,"label",48),a(25,"Activo"),r()(),n(26,"div",49)(27,"button",50),m("click",function(){p(e);let o=c();return u(o.closeModal())}),a(28," Cancelar "),r(),n(29,"button",51),a(30," Guardar "),r()()()()()}if(s&2){let e,i,o=c();l(4),_(o.isEditing?"Editar Categor\xEDa":"Nueva Categor\xEDa"),l(4),g("formGroup",o.categoriaForm),l(4),v("border-red-500",((e=o.categoriaForm.get("nombre"))==null?null:e.invalid)&&((e=o.categoriaForm.get("nombre"))==null?null:e.touched)),l(),g("ngIf",((i=o.categoriaForm.get("nombre"))==null?null:i.invalid)&&((i=o.categoriaForm.get("nombre"))==null?null:i.touched))}}var S=class s{categoriasService=C(w);fb=C(X);categorias=[];paginacion=null;loading=!0;currentPage=1;searchTerm="";categoriaForm;isModalOpen=!1;isEditing=!1;currentCategoriaId=null;constructor(){this.categoriaForm=this.fb.group({nombre:["",[z.required]],descripcion:[""],imagen:[""],estado:[!0]})}ngOnInit(){this.loadCategorias()}loadCategorias(t=1){this.loading=!0,this.currentPage=t,this.categoriasService.getCategorias(t,10,this.searchTerm).subscribe({next:e=>{this.paginacion=e,this.categorias=e.data,this.loading=!1},error:e=>{console.error("Error al cargar categor\xEDas:",e),this.loading=!1}})}search(){this.loadCategorias(1)}openCreateModal(){this.isEditing=!1,this.currentCategoriaId=null,this.categoriaForm.reset({estado:!0}),this.isModalOpen=!0}openEditModal(t){this.isEditing=!0,this.currentCategoriaId=t.id,this.categoriaForm.patchValue({nombre:t.nombre,descripcion:t.descripcion,imagen:t.imagen,estado:t.estado}),this.isModalOpen=!0}closeModal(){this.isModalOpen=!1}saveCategoria(){if(this.categoriaForm.invalid){this.categoriaForm.markAllAsTouched();return}let t=this.categoriaForm.value;this.isEditing&&this.currentCategoriaId?this.categoriasService.updateCategoria(this.currentCategoriaId,t).subscribe({next:()=>{this.loadCategorias(this.currentPage),this.closeModal()},error:e=>{console.error("Error al actualizar categor\xEDa:",e)}}):this.categoriasService.createCategoria(t).subscribe({next:()=>{this.loadCategorias(this.currentPage),this.closeModal()},error:e=>{console.error("Error al crear categor\xEDa:",e)}})}deleteCategoria(t){confirm("\xBFEst\xE1s seguro de que quieres eliminar esta categor\xEDa?")&&this.categoriasService.deleteCategoria(t).subscribe({next:()=>{this.loadCategorias(this.currentPage)},error:e=>{console.error("Error al eliminar categor\xEDa:",e)}})}toggleEstado(t){this.categoriasService.toggleEstado(t.id,!t.estado).subscribe({next:()=>{this.loadCategorias(this.currentPage)},error:e=>{console.error("Error al cambiar estado de la categor\xEDa:",e)}})}changePage(t){this.loadCategorias(t)}formatDate(t){return t?new Date(t).toLocaleDateString():""}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=M({type:s,selectors:[["app-categorias"]],decls:32,vars:6,consts:[[1,"container","mx-auto","px-4","py-6"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold"],[1,"bg-blue-600","hover:bg-blue-700","text-white","font-medium","py-2","px-4","rounded",3,"click"],[1,"mb-6","flex"],["type","text","placeholder","Buscar categor\xEDas...",1,"border","rounded-l","px-4","py-2","w-full","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","keyup.enter","ngModel"],[1,"bg-gray-200","hover:bg-gray-300","px-4","py-2","rounded-r",3,"click"],[1,"overflow-x-auto","rounded-lg","shadow"],[1,"min-w-full","bg-white"],[1,"bg-gray-100"],[1,"py-3","px-4","text-left","font-medium","text-gray-600","uppercase","tracking-wider"],[1,"divide-y","divide-gray-200"],[4,"ngIf"],["class","hover:bg-gray-50",4,"ngFor","ngForOf"],["class","mt-4 flex justify-center",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",4,"ngIf"],["colspan","6",1,"py-4","px-4","text-center"],[1,"hover:bg-gray-50"],[1,"py-3","px-4"],[1,"px-2","py-1","rounded-full","text-xs","font-medium"],[1,"py-3","px-4","space-x-2"],[1,"bg-yellow-500","hover:bg-yellow-600","text-white","px-3","py-1","rounded","text-sm",3,"click"],[1,"text-white","px-3","py-1","rounded","text-sm",3,"click"],[1,"bg-red-500","hover:bg-red-600","text-white","px-3","py-1","rounded","text-sm",3,"click"],[1,"mt-4","flex","justify-center"],[1,"inline-flex"],[1,"px-3","py-1","rounded-l","border","bg-white",3,"click","disabled"],[4,"ngFor","ngForOf"],[1,"px-3","py-1","rounded-r","border","bg-white",3,"click","disabled"],[1,"px-3","py-1","border-t","border-b",3,"click"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","p-4","z-50"],[1,"bg-white","rounded-lg","shadow-xl","max-w-md","w-full","p-6"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-xl","font-bold"],[1,"text-gray-500","hover:text-gray-700",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[3,"ngSubmit","formGroup"],[1,"mb-4"],["for","nombre",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","id","nombre","formControlName","nombre",1,"w-full","px-3","py-2","border","rounded-md","focus:outline-none","focus:ring-blue-500","focus:border-blue-500"],["class","text-red-500 text-sm mt-1",4,"ngIf"],["for","descripcion",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","descripcion","formControlName","descripcion","rows","3",1,"w-full","px-3","py-2","border","rounded-md","focus:outline-none","focus:ring-blue-500","focus:border-blue-500"],["for","imagen",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","id","imagen","formControlName","imagen",1,"w-full","px-3","py-2","border","rounded-md","focus:outline-none","focus:ring-blue-500","focus:border-blue-500"],[1,"mb-4","flex","items-center"],["type","checkbox","id","estado","formControlName","estado",1,"h-4","w-4","text-blue-600","focus:ring-blue-500","border-gray-300","rounded"],["for","estado",1,"ml-2","block","text-sm","text-gray-700"],[1,"flex","justify-end","gap-2"],["type","button",1,"px-4","py-2","border","border-gray-300","rounded-md","shadow-sm","text-sm","font-medium","text-gray-700","bg-white","hover:bg-gray-50",3,"click"],["type","submit",1,"px-4","py-2","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500"],[1,"text-red-500","text-sm","mt-1"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),a(3,"Gesti\xF3n de Categor\xEDas"),r(),n(4,"button",3),m("click",function(){return i.openCreateModal()}),a(5," Nueva Categor\xEDa "),r()(),n(6,"div",4)(7,"input",5),D("ngModelChange",function(d){return V(i.searchTerm,d)||(i.searchTerm=d),d}),m("keyup.enter",function(){return i.search()}),r(),n(8,"button",6),m("click",function(){return i.search()}),a(9," Buscar "),r()(),n(10,"div",7)(11,"table",8)(12,"thead",9)(13,"tr")(14,"th",10),a(15,"ID"),r(),n(16,"th",10),a(17,"Nombre"),r(),n(18,"th",10),a(19,"Descripci\xF3n"),r(),n(20,"th",10),a(21,"Estado"),r(),n(22,"th",10),a(23,"Creado"),r(),n(24,"th",10),a(25,"Acciones"),r()()(),n(26,"tbody",11),x(27,ie,3,0,"tr",12)(28,re,3,0,"tr",12)(29,ne,19,10,"tr",13),r()()(),x(30,ae,7,8,"div",14),r(),x(31,le,31,5,"div",15)),e&2&&(l(7),O("ngModel",i.searchTerm),l(20),g("ngIf",i.loading),l(),g("ngIf",!i.loading&&i.categorias.length===0),l(),g("ngForOf",i.categorias),l(),g("ngIf",i.paginacion&&i.paginacion.last_page>1),l(),g("ngIf",i.isModalOpen))},dependencies:[L,R,A,Z,J,B,U,q,H,K,Q,Y,W],styles:[".modal-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;z-index:40}.modal-enter-active[_ngcontent-%COMP%], .modal-leave-active[_ngcontent-%COMP%]{transition:opacity .3s}.modal-enter[_ngcontent-%COMP%], .modal-leave-to[_ngcontent-%COMP%]{opacity:0}"]})};var Pe=[{path:"",component:S,title:"Categorias"}];export{Pe as CATEGORIAS_ROUTES,S as CategoriasComponent};
