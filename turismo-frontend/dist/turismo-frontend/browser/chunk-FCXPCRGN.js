import{a as K}from"./chunk-XKQSEP7P.js";import{a as te}from"./chunk-ZMYNNKPK.js";import{a as Z}from"./chunk-JPXMOWFC.js";import{a as I}from"./chunk-UD255BT3.js";import{a as ee,b as B,c as V,d as O,e as $,i as R,j as ie,l as U,o as q,x as Y,z as J}from"./chunk-DV54EIF6.js";import{d as D,f as j,g as T}from"./chunk-ZI6AQ4XN.js";import{Ga as L,Gb as a,Hb as y,Hc as A,Ib as M,La as d,Qb as k,Rb as F,Va as E,_,_a as g,fb as p,ga as x,ha as f,ia as m,ja as v,jb as u,mb as G,nb as P,ob as i,pb as t,qb as l,tb as C,ub as b,uc as H,vb as c,wc as X}from"./chunk-T2OCC6GX.js";import{a as S,b as w}from"./chunk-4CLCTAJ7.js";var de=r=>["/admin/municipalidad/edit",r],le=r=>["/admin/municipalidad",r,"asociaciones"],se=(r,n)=>n.id;function ce(r,n){r&1&&(i(0,"div",10),l(1,"div",13),i(2,"span",14),a(3,"Cargando datos..."),t()())}function me(r,n){r&1&&(i(0,"div",11),m(),i(1,"svg",15),l(2,"path",16),t(),v(),i(3,"h3",17),a(4,"No se encontraron municipalidades"),t(),i(5,"p",18),a(6,"Comienza creando una nueva municipalidad."),t(),i(7,"div",19)(8,"a",6),m(),i(9,"svg",7),l(10,"path",8),t(),a(11," Nueva Municipalidad "),t()()())}function ue(r,n){if(r&1&&(i(0,"a",32),m(),i(1,"svg",44),l(2,"path",45),t()()),r&2){let e=c().$implicit;p("href",e.red_facebook,L)}}function pe(r,n){if(r&1&&(i(0,"a",33),m(),i(1,"svg",44),l(2,"path",46),t()()),r&2){let e=c().$implicit;p("href",e.red_instagram,L)}}function xe(r,n){if(r&1&&(i(0,"a",34),m(),i(1,"svg",44),l(2,"path",47),t()()),r&2){let e=c().$implicit;p("href",e.red_youtube,L)}}function fe(r,n){if(r&1){let e=C();i(0,"tr",25)(1,"td",26)(2,"div",27),a(3),t()(),i(4,"td",28)(5,"div",29),a(6),t()(),i(7,"td",26)(8,"div",30),a(9),t()(),i(10,"td",26)(11,"div",31),g(12,ue,3,1,"a",32)(13,pe,3,1,"a",33)(14,xe,3,1,"a",34),t()(),i(15,"td",35)(16,"div",36)(17,"a",37),m(),i(18,"svg",38),l(19,"path",39),t()(),v(),i(20,"a",40),m(),i(21,"svg",38),l(22,"path",41),t()(),v(),i(23,"button",42),b("click",function(){let s=x(e).$implicit,h=c(2);return f(h.deleteMunicipalidad(s))}),m(),i(24,"svg",38),l(25,"path",43),t()()()()()}if(r&2){let e=n.$implicit;d(3),y(e.nombre),d(3),y(e.descripcion),d(3),y(e.correo||"No disponible"),d(3),u(e.red_facebook?12:-1),d(),u(e.red_instagram?13:-1),d(),u(e.red_youtube?14:-1),d(3),p("routerLink",k(8,de,e.id)),d(3),p("routerLink",k(10,le,e.id))}}function ge(r,n){if(r&1&&(i(0,"div",12)(1,"table",20)(2,"thead",21)(3,"tr")(4,"th",22),a(5,"Nombre"),t(),i(6,"th",22),a(7,"Descripci\xF3n"),t(),i(8,"th",22),a(9,"Correo"),t(),i(10,"th",22),a(11,"Redes Sociales"),t(),i(12,"th",23),a(13,"Acciones"),t()()(),i(14,"tbody",24),G(15,fe,26,12,"tr",25,se),t()()()),r&2){let e=c();d(15),P(e.municipalidades)}}var Q=class r{turismoService=_(I);themeService=_(Z);municipalidades=[];loading=!0;ngOnInit(){this.loadMunicipalidades()}isDarkMode(){return this.themeService.isDarkMode()}loadMunicipalidades(){this.loading=!0,this.turismoService.getMunicipalidades().subscribe({next:n=>{this.municipalidades=n,this.loading=!1},error:n=>{console.error("Error al cargar municipalidades:",n),this.loading=!1}})}deleteMunicipalidad(n){n.id&&confirm('\xBFEst\xE1 seguro de eliminar la municipalidad "'+n.nombre+'"? Esta acci\xF3n no se puede deshacer y eliminar\xE1 toda la informaci\xF3n relacionada, incluyendo asociaciones y emprendedores.')&&this.turismoService.deleteMunicipalidad(n.id).subscribe({next:()=>{this.municipalidades=this.municipalidades.filter(e=>e.id!==n.id),alert("Municipalidad eliminada correctamente")},error:e=>{console.error("Error al eliminar municipalidad:",e),alert("Error al eliminar la municipalidad. Por favor, intente nuevamente.")}})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=E({type:r,selectors:[["app-municipalidad-list"]],decls:15,vars:1,consts:[["title","Gesti\xF3n de Municipalidad","subtitle","Administra la informaci\xF3n general de la municipalidad"],[1,"container","mx-auto","px-4","py-8","bg-gray-50","dark:bg-gray-900","min-h-screen","transition-colors","duration-200"],[1,"space-y-6","transition-colors","duration-300"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between"],[1,"text-2xl","font-bold","text-gray-900","dark:text-white","transition-colors","duration-300"],[1,"mt-4","sm:mt-0"],["routerLink","/admin/municipalidad/create",1,"inline-flex","items-center","rounded-md","bg-primary-600","px-4","py-2","text-sm","font-medium","text-white","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2","dark:ring-offset-gray-900","transition-colors","duration-300"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"rounded-lg","bg-white","dark:bg-gray-800","shadow-sm","overflow-hidden","transition-colors","duration-300"],[1,"flex","justify-center","items-center","p-8"],[1,"p-8","text-center"],[1,"overflow-x-auto"],[1,"inline-block","h-8","w-8","animate-spin","rounded-full","border-4","border-solid","border-primary-400","border-r-transparent"],[1,"ml-4","dark:text-gray-200","transition-colors","duration-300"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400","dark:text-gray-500","transition-colors","duration-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"],[1,"mt-2","text-sm","font-medium","text-gray-900","dark:text-white","transition-colors","duration-300"],[1,"mt-1","text-sm","text-gray-500","dark:text-gray-400","transition-colors","duration-300"],[1,"mt-6"],[1,"min-w-full","divide-y","divide-gray-200","dark:divide-gray-700","transition-colors","duration-300"],[1,"bg-gray-50","dark:bg-gray-700","transition-colors","duration-300"],["scope","col",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","dark:text-gray-300","uppercase","tracking-wider","transition-colors","duration-300"],["scope","col",1,"px-6","py-3","text-right","text-xs","font-medium","text-gray-500","dark:text-gray-300","uppercase","tracking-wider","transition-colors","duration-300"],[1,"bg-white","dark:bg-gray-800","divide-y","divide-gray-200","dark:divide-gray-700","transition-colors","duration-300"],[1,"hover:bg-gray-50","dark:hover:bg-gray-700","transition-colors","duration-300"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","font-medium","text-gray-900","dark:text-white","transition-colors","duration-300"],[1,"px-6","py-4"],[1,"text-sm","text-gray-500","dark:text-gray-300","truncate","max-w-xs","transition-colors","duration-300"],[1,"text-sm","text-gray-500","dark:text-gray-300","transition-colors","duration-300"],[1,"flex","space-x-2"],["target","_blank",1,"text-blue-600","hover:text-blue-900","dark:text-blue-400","dark:hover:text-blue-300","transition-colors","duration-300",3,"href"],["target","_blank",1,"text-pink-600","hover:text-pink-900","dark:text-pink-400","dark:hover:text-pink-300","transition-colors","duration-300",3,"href"],["target","_blank",1,"text-red-600","hover:text-red-900","dark:text-red-400","dark:hover:text-red-300","transition-colors","duration-300",3,"href"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"flex","items-center","justify-end","space-x-2"],["title","Editar",1,"text-primary-600","hover:text-primary-900","dark:text-primary-400","dark:hover:text-primary-300","transition-colors","duration-300",3,"routerLink"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["title","Ver asociaciones",1,"text-green-600","hover:text-green-900","dark:text-green-400","dark:hover:text-green-300","transition-colors","duration-300",3,"routerLink"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],["title","Eliminar",1,"text-red-600","hover:text-red-900","dark:text-red-400","dark:hover:text-red-300","transition-colors","duration-300",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],["fill","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["d","M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.987C18.343 21.128 22 16.991 22 12z"],["d","M12.315 2c2.43 0 2.784.013 3.808.06 1.064.049 1.791.218 2.427.465a4.902 4.902 0 011.772 1.153 4.902 4.902 0 011.153 1.772c.247.636.416 1.363.465 2.427.048 1.067.06 1.407.06 4.123v.08c0 2.643-.012 2.987-.06 4.043-.049 1.064-.218 1.791-.465 2.427a4.902 4.902 0 01-1.153 1.772 4.902 4.902 0 01-1.772 1.153c-.636.247-1.363.416-2.427.465-1.067.048-1.407.06-4.123.06h-.08c-2.643 0-2.987-.012-4.043-.06-1.064-.049-1.791-.218-2.427-.465a4.902 4.902 0 01-1.772-1.153 4.902 4.902 0 01-1.153-1.772c-.247-.636-.416-1.363-.465-2.427-.047-1.024-.06-1.379-.06-3.808v-.63c0-2.43.013-2.784.06-3.808.049-1.064.218-1.791.465-2.427a4.902 4.902 0 011.153-1.772A4.902 4.902 0 015.45 2.525c.636-.247 1.363-.416 2.427-.465C8.901 2.013 9.256 2 11.685 2h.63zm-.081 1.802h-.468c-2.456 0-2.784.011-3.807.058-.975.045-1.504.207-1.857.344-.467.182-.8.398-1.15.748-.35.35-.566.683-.748 1.15-.137.353-.3.882-.344 1.857-.047 1.023-.058 1.351-.058 3.807v.468c0 2.456.011 2.784.058 3.807.045.975.207 1.504.344 1.857.182.466.399.8.748 1.15.35.35.683.566 1.15.748.353.137.882.3 1.857.344 1.054.048 1.37.058 4.041.058h.08c2.597 0 2.917-.01 3.96-.058.976-.045 1.505-.207 1.858-.344.466-.182.8-.398 1.15-.748.35-.35.566-.683.748-1.15.137-.353.3-.882.344-1.857.048-1.055.058-1.37.058-4.041v-.08c0-2.597-.01-2.917-.058-3.96-.045-.976-.207-1.505-.344-1.858a3.097 3.097 0 00-.748-1.15 3.098 3.098 0 00-1.15-.748c-.353-.137-.882-.3-1.857-.344-1.023-.047-1.351-.058-3.807-.058zM12 6.865a5.135 5.135 0 110 10.27 5.135 5.135 0 010-10.27zm0 1.802a3.333 3.333 0 100 6.666 3.333 3.333 0 000-6.666zm5.338-3.205a1.2 1.2 0 110 2.4 1.2 1.2 0 010-2.4z"],["d","M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"]],template:function(e,o){e&1&&(l(0,"app-admin-header",0),i(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),a(5,"Municipalidad"),t(),i(6,"div",5)(7,"a",6),m(),i(8,"svg",7),l(9,"path",8),t(),a(10," Nueva Municipalidad "),t()()(),v(),i(11,"div",9),g(12,ce,4,0,"div",10)(13,me,12,0,"div",11)(14,ge,17,0,"div",12),t()()()),e&2&&(d(12),u(o.loading?12:o.municipalidades.length===0?13:14))},dependencies:[A,T,K],encapsulation:2})};var z=(r,n)=>({"border-primary-500 text-primary-600 dark:text-primary-400":r,"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600":n}),ae=r=>({"border-red-300 dark:border-red-700 focus:border-red-500 focus:ring-red-500":r});function ve(r,n){r&1&&(i(0,"div",9),l(1,"div",11),i(2,"span",12),a(3,"Cargando..."),t()())}function ye(r,n){r&1&&(i(0,"p",28),a(1,"El nombre es requerido"),t())}function _e(r,n){r&1&&(i(0,"p",28),a(1,"La descripci\xF3n es requerida"),t())}function ke(r,n){if(r&1&&(i(0,"div",18)(1,"div",23)(2,"div",24)(3,"label",25),a(4,"Nombre"),t(),i(5,"div",26),l(6,"input",27),g(7,ye,2,0,"p",28),t()(),i(8,"div",24)(9,"label",29),a(10,"Descripci\xF3n"),t(),i(11,"div",26),l(12,"textarea",30),g(13,_e,2,0,"p",28),t()(),i(14,"div",24)(15,"label",31),a(16,"Frase caracter\xEDstica"),t(),i(17,"div",26),l(18,"input",32),t(),i(19,"p",33),a(20,"Una frase representativa o eslogan de la municipalidad"),t()(),i(21,"div",24)(22,"label",34),a(23,"Comunidades"),t(),i(24,"div",26),l(25,"textarea",35),t()()()()),r&2){let e=c(2);d(6),p("ngClass",k(4,ae,e.isFieldInvalid("nombre"))),d(),u(e.isFieldInvalid("nombre")?7:-1),d(5),p("ngClass",k(6,ae,e.isFieldInvalid("descripcion"))),d(),u(e.isFieldInvalid("descripcion")?13:-1)}}function Se(r,n){r&1&&(i(0,"div",18)(1,"div",23)(2,"div",36)(3,"label",37),a(4,"Correo Electr\xF3nico"),t(),i(5,"div",26),l(6,"input",38),t()(),i(7,"div",36)(8,"label",39),a(9,"Horario de Atenci\xF3n"),t(),i(10,"div",26),l(11,"input",40),t()(),i(12,"div",24)(13,"h3",41),a(14,"Redes Sociales"),t(),i(15,"div",42)(16,"label",43),a(17,"Facebook"),t(),i(18,"div",44)(19,"span",45),m(),i(20,"svg",46),l(21,"path",47),t()(),v(),l(22,"input",48),t()(),i(23,"div",49)(24,"label",50),a(25,"Instagram"),t(),i(26,"div",44)(27,"span",51),m(),i(28,"svg",46),l(29,"path",52),t()(),v(),l(30,"input",53),t()(),i(31,"div",49)(32,"label",54),a(33,"YouTube"),t(),i(34,"div",44)(35,"span",55),m(),i(36,"svg",46),l(37,"path",56),t()(),v(),l(38,"input",57),t()()()()())}function Ce(r,n){r&1&&(i(0,"div",18)(1,"div",23)(2,"div",24)(3,"label",58),a(4,"Misi\xF3n"),t(),i(5,"div",26),l(6,"textarea",59),t()(),i(7,"div",24)(8,"label",60),a(9,"Visi\xF3n"),t(),i(10,"div",26),l(11,"textarea",61),t()(),i(12,"div",24)(13,"label",62),a(14,"Valores"),t(),i(15,"div",26),l(16,"textarea",63),t()(),i(17,"div",24)(18,"label",64),a(19,"Comit\xE9"),t(),i(20,"div",26),l(21,"textarea",65),t()(),i(22,"div",24)(23,"label",66),a(24,"Ordenanza Municipal"),t(),i(25,"div",26),l(26,"textarea",67),t()(),i(27,"div",24)(28,"label",68),a(29,"Alianzas"),t(),i(30,"div",26),l(31,"textarea",69),t()()()())}function we(r,n){r&1&&(i(0,"div",18)(1,"div",23)(2,"div",36)(3,"label",70),a(4,"Latitud"),t(),i(5,"div",26),l(6,"input",71),t()(),i(7,"div",36)(8,"label",72),a(9,"Longitud"),t(),i(10,"div",26),l(11,"input",73),t()(),i(12,"div",24)(13,"label",74),a(14,"Historia de Capachica"),t(),i(15,"div",26),l(16,"textarea",75),t()(),i(17,"div",24)(18,"label",76),a(19,"Historia de Familias"),t(),i(20,"div",26),l(21,"textarea",77),t()()()())}function Ee(r,n){if(r&1){let e=C();i(0,"div",18)(1,"app-slider-upload",78),b("changeSlidersEvent",function(s){x(e);let h=c(2);return f(h.onSlidersPrincipalesChange(s))})("deletedSlidersEvent",function(s){x(e);let h=c(2);return f(h.onDeletedSlidersPrincipalesChange(s))}),t(),i(2,"app-slider-upload",79),b("changeSlidersEvent",function(s){x(e);let h=c(2);return f(h.onSlidersSecundariosChange(s))})("deletedSlidersEvent",function(s){x(e);let h=c(2);return f(h.onDeletedSlidersSecundariosChange(s))}),t()()}if(r&2){let e=c(2);d(),p("slidersFormArray",e.slidersPrincipalesArray)("existingSliders",e.slidersPrincipales)("isSliderPrincipal",!0),d(),p("slidersFormArray",e.slidersSecundariosArray)("existingSliders",e.slidersSecundarios)("isSliderPrincipal",!1)}}function Me(r,n){if(r&1&&(i(0,"div",19)(1,"div",80)(2,"div",81),m(),i(3,"svg",82),l(4,"path",83),t()(),v(),i(5,"div",84)(6,"h3",85),a(7),t()()()()),r&2){let e=c(2);d(7),y(e.error)}}function Fe(r,n){r&1&&(m(),i(0,"svg",86),l(1,"circle",87)(2,"path",88),t(),a(3," Guardando... "))}function Ae(r,n){if(r&1&&a(0),r&2){let e=c(2);M(" ",e.isEditMode?"Actualizar":"Crear"," ")}}function Te(r,n){if(r&1){let e=C();i(0,"form",13),b("ngSubmit",function(){x(e);let s=c();return f(s.onSubmit())}),i(1,"div",14)(2,"nav",15)(3,"button",16),b("click",function(){x(e);let s=c();return f(s.activeTab="informacion-general")}),a(4," Informaci\xF3n General "),t(),i(5,"button",16),b("click",function(){x(e);let s=c();return f(s.activeTab="contacto")}),a(6," Contacto "),t(),i(7,"button",16),b("click",function(){x(e);let s=c();return f(s.activeTab="info-institucional")}),a(8," Informaci\xF3n Institucional "),t(),i(9,"button",16),b("click",function(){x(e);let s=c();return f(s.activeTab="ubicacion")}),a(10," Ubicaci\xF3n "),t(),i(11,"button",16),b("click",function(){x(e);let s=c();return f(s.activeTab="imagenes")}),a(12," Im\xE1genes "),t()()(),i(13,"div",17),g(14,ke,26,8,"div",18)(15,Se,39,0,"div",18)(16,Ce,32,0,"div",18)(17,we,22,0,"div",18)(18,Ee,3,6,"div",18),t(),g(19,Me,8,1,"div",19),i(20,"div",20)(21,"button",21),a(22," Cancelar "),t(),i(23,"button",22),b("click",function(s){x(e);let h=c();return f(h.logFormState(s))}),g(24,Fe,4,0)(25,Ae,1,1),t()()()}if(r&2){let e=c();p("formGroup",e.municipalidadForm),d(3),p("ngClass",F(14,z,e.activeTab==="informacion-general",e.activeTab!=="informacion-general")),d(2),p("ngClass",F(17,z,e.activeTab==="contacto",e.activeTab!=="contacto")),d(2),p("ngClass",F(20,z,e.activeTab==="info-institucional",e.activeTab!=="info-institucional")),d(2),p("ngClass",F(23,z,e.activeTab==="ubicacion",e.activeTab!=="ubicacion")),d(2),p("ngClass",F(26,z,e.activeTab==="imagenes",e.activeTab!=="imagenes")),d(3),u(e.activeTab==="informacion-general"?14:-1),d(),u(e.activeTab==="contacto"?15:-1),d(),u(e.activeTab==="info-institucional"?16:-1),d(),u(e.activeTab==="ubicacion"?17:-1),d(),u(e.activeTab==="imagenes"?18:-1),d(),u(e.error?19:-1),d(4),p("disabled",e.saving||e.municipalidadForm.invalid),d(),u(e.saving?24:25)}}var N=class r{fb=_(Y);turismoService=_(I);route=_(D);router=_(j);municipalidadForm;municipalidadId=null;deletedSlidersPrincipales=[];deletedSlidersSecundarios=[];slidersPrincipales=[];slidersSecundarios=[];loading=!0;saving=!1;submitted=!1;error="";previousInvalidState=!1;activeTab="informacion-general";get slidersPrincipalesArray(){return this.municipalidadForm.get("sliders_principales")}get slidersSecundariosArray(){return this.municipalidadForm.get("sliders_secundarios")}get isEditMode(){return this.municipalidadId!==null}ngOnInit(){this.initForm();let n=this.route.snapshot.paramMap.get("id");n?(this.municipalidadId=+n,this.loadMunicipalidad(this.municipalidadId)):this.loading=!1}ngDoCheck(){this.municipalidadForm&&this.municipalidadForm.invalid&&!this.previousInvalidState&&console.log("Form became invalid. Current status:",{formInvalid:this.municipalidadForm.invalid,formErrors:this.getFormErrors(),slidersSecundarios:this.slidersSecundariosArray.value}),this.previousInvalidState=this.municipalidadForm?this.municipalidadForm.invalid:!1}getFormErrors(){let n={};return Object.keys(this.municipalidadForm.controls).forEach(e=>{let o=this.municipalidadForm.get(e);o&&o.errors&&(n[e]=o.errors)}),n}logFormState(n){if(this.municipalidadForm.invalid){n.preventDefault(),console.error("Form is invalid. Details:",{formErrors:this.getFormErrors(),slidersPrincipales:this.slidersPrincipales.length,slidersSecundarios:this.slidersSecundarios.length});let e=this.slidersSecundarios.filter(o=>!o.nombre||!o.orden||!this.isEditMode&&!o.imagen);e.length>0&&(console.error("Invalid secondary sliders:",e),this.activeTab="imagenes",this.error="Hay problemas con las im\xE1genes secundarias. Por favor, verifica que todas tengan nombre y orden.")}}initForm(){this.municipalidadForm=this.fb.group({nombre:["",V.required],descripcion:["",V.required],frase:[""],comunidades:[""],correo:[""],horariodeatencion:[""],red_facebook:[""],red_instagram:[""],red_youtube:[""],mision:[""],vision:[""],valores:[""],comite:[""],ordenanzamunicipal:[""],alianzas:[""],coordenadas_x:[""],coordenadas_y:[""],historiafamilias:[""],historiacapachica:[""],sliders_principales:this.fb.array([]),sliders_secundarios:this.fb.array([])})}loadMunicipalidad(n){this.loading=!0,this.turismoService.getMunicipalidad(n).subscribe({next:e=>{console.log("Municipalidad cargada:",e),this.municipalidadForm.patchValue({nombre:e.nombre,descripcion:e.descripcion,frase:e.frase||"",comunidades:e.comunidades||"",correo:e.correo||"",horariodeatencion:e.horariodeatencion||"",red_facebook:e.red_facebook||"",red_instagram:e.red_instagram||"",red_youtube:e.red_youtube||"",mision:e.mision||"",vision:e.vision||"",valores:e.valores||"",comite:e.comite||"",ordenanzamunicipal:e.ordenanzamunicipal||"",alianzas:e.alianzas||"",coordenadas_x:e.coordenadas_x||"",coordenadas_y:e.coordenadas_y||"",historiafamilias:e.historiafamilias||"",historiacapachica:e.historiacapachica||""}),this.slidersPrincipales=[],this.slidersSecundarios=[],e.sliders_principales&&e.sliders_principales.length>0&&(console.log("Sliders principales encontrados:",e.sliders_principales.length),this.slidersPrincipales=e.sliders_principales.map(o=>({id:o.id,nombre:o.nombre,es_principal:!0,orden:o.orden||1,imagen:o.url_completa||"",url_completa:o.url_completa}))),e.sliders_secundarios&&e.sliders_secundarios.length>0&&(console.log("Sliders secundarios encontrados:",e.sliders_secundarios.length),this.slidersSecundarios=e.sliders_secundarios.map(o=>{let s="",h="";return o.descripcion&&typeof o.descripcion=="object"&&(s=o.descripcion.titulo||"",h=o.descripcion.descripcion||""),{id:o.id,nombre:o.nombre,es_principal:!1,orden:o.orden||1,imagen:o.url_completa||"",url_completa:o.url_completa,titulo:s,descripcion:h}})),console.log("Sliders principales procesados:",this.slidersPrincipales),console.log("Sliders secundarios procesados:",this.slidersSecundarios),this.loading=!1},error:e=>{console.error("Error al cargar municipalidad:",e),this.error="Error al cargar los datos de la municipalidad.",this.loading=!1}})}onDeletedSlidersPrincipalesChange(n){this.deletedSlidersPrincipales=n,console.log("Sliders principales eliminados:",n)}onDeletedSlidersSecundariosChange(n){this.deletedSlidersSecundarios=n,console.log("Sliders secundarios eliminados:",n)}onSlidersPrincipalesChange(n){console.log("Cambio en sliders principales:",n),this.slidersPrincipales=n.map(e=>w(S({},e),{es_principal:!0,nombre:e.nombre||"",orden:e.orden||this.slidersPrincipales.length+1})),console.log("Updated sliders principales:",this.slidersPrincipales)}onSlidersSecundariosChange(n){console.log("Original sliders secundarios:",n),this.slidersSecundarios=n.map(e=>w(S({},e),{es_principal:!1,nombre:e.nombre||"",orden:e.orden||this.slidersSecundarios.length+1,titulo:e.titulo||"",descripcion:e.descripcion||""})),console.log("Updated sliders secundarios:",this.slidersSecundarios)}isFieldInvalid(n){let e=this.municipalidadForm.get(n);return e?.invalid&&(e?.dirty||e?.touched||this.submitted)||!1}onSubmit(){if(this.submitted=!0,this.error="",this.municipalidadForm.invalid){(this.isFieldInvalid("nombre")||this.isFieldInvalid("descripcion"))&&(this.activeTab="informacion-general");return}let n=this.municipalidadForm.value;n.sliders_principales=this.slidersPrincipales.map(e=>{let o=S({},e);return o.nombre||(o.nombre="Slider Principal "+(e.orden||1)),o.orden||(o.orden=this.slidersPrincipales.indexOf(e)+1),o.imagen instanceof File||delete o.imagen,w(S({},o),{es_principal:!0})}),n.sliders_secundarios=this.slidersSecundarios.map(e=>{let o=S({},e);return o.nombre||(o.nombre="Slider Secundario "+(e.orden||1)),o.orden||(o.orden=this.slidersSecundarios.indexOf(e)+1),o.imagen instanceof File||delete o.imagen,w(S({},o),{es_principal:!1,titulo:o.titulo||"",descripcion:o.descripcion||""})}),n.deleted_sliders=[...this.deletedSlidersPrincipales,...this.deletedSlidersSecundarios],console.log("Datos a enviar:",n),this.saving=!0,this.isEditMode&&this.municipalidadId?(console.log("Updating municipalidad with PUT method"),this.turismoService.updateMunicipalidad(this.municipalidadId,n).subscribe({next:()=>{this.saving=!1,alert(`Municipalidad ${this.isEditMode?"actualizada":"creada"} correctamente`),this.router.navigate(["/admin/municipalidad"])},error:e=>{console.error("Error al actualizar municipalidad:",e),this.error=e.error?.message||"Error al actualizar la municipalidad. Por favor, intente nuevamente.",this.saving=!1}})):(console.log("Creating new municipalidad with POST method"),this.turismoService.createMunicipalidad(n).subscribe({next:()=>{this.saving=!1,alert(`Municipalidad ${this.isEditMode?"actualizada":"creada"} correctamente`),this.router.navigate(["/admin/municipalidad"])},error:e=>{console.error("Error al crear municipalidad:",e),this.error=e.error?.message||"Error al crear la municipalidad. Por favor, intente nuevamente.",this.saving=!1}}))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=E({type:r,selectors:[["app-municipalidad-form"]],decls:13,vars:2,consts:[["title","Gesti\xF3n de Municipalidad","subtitle","Crea o edita la municipalidad"],[1,"container","mx-auto","px-4","py-8","space-y-6","bg-gray-50","dark:bg-gray-900","min-h-screen","transition-colors","duration-200"],[1,"sm:flex","sm:items-center","sm:justify-between"],[1,"text-2xl","font-bold","text-gray-900","dark:text-gray-100"],[1,"mt-4","sm:mt-0"],["routerLink","/admin/municipalidad",1,"inline-flex","items-center","rounded-md","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","px-4","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-200","shadow-sm","hover:bg-gray-50","dark:hover:bg-gray-600","focus:outline-none","focus:ring-2","focus:ring-primary-500","dark:focus:ring-primary-400","focus:ring-offset-2","focus:ring-offset-gray-900","transition-colors","duration-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5","text-gray-500","dark:text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"bg-white","dark:bg-gray-800","shadow-sm","rounded-lg","transition-colors","duration-200"],[1,"flex","justify-center","items-center","p-8"],[3,"formGroup"],[1,"inline-block","h-8","w-8","animate-spin","rounded-full","border-4","border-solid","border-primary-400","border-r-transparent"],[1,"ml-4"],[3,"ngSubmit","formGroup"],[1,"border-b","border-gray-200","dark:border-gray-700","transition-colors","duration-200"],[1,"-mb-px","flex","flex-wrap","space-x-8","p-4"],["type","button",1,"pb-4","px-1","border-b-2","font-medium","text-sm","transition-colors","duration-200",3,"click","ngClass"],[1,"p-6"],[1,"space-y-6"],[1,"rounded-md","bg-red-50","dark:bg-red-900/30","p-4","m-6","transition-colors","duration-200"],[1,"flex","justify-end","space-x-3","p-6","bg-gray-50","dark:bg-gray-900","transition-colors","duration-200"],["type","button","routerLink","/admin/municipalidad",1,"inline-flex","justify-center","rounded-md","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","px-4","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-200","shadow-sm","hover:bg-gray-50","dark:hover:bg-gray-600","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2","transition-colors","duration-200"],["type","submit",1,"inline-flex","justify-center","rounded-md","border","border-transparent","bg-primary-600","px-4","py-2","text-sm","font-medium","text-white","shadow-sm","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2","transition-colors","duration-200",3,"click","disabled"],[1,"grid","grid-cols-1","gap-y-6","gap-x-4","sm:grid-cols-6"],[1,"sm:col-span-6"],["for","nombre",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],[1,"mt-2"],["type","text","id","nombre","formControlName","nombre",1,"block","w-full","h-10","px-3","rounded-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200",3,"ngClass"],[1,"mt-2","text-sm","text-red-600","dark:text-red-400","transition-colors","duration-200"],["for","descripcion",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],["id","descripcion","formControlName","descripcion","rows","4",1,"block","w-full","px-3","py-2","rounded-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200",3,"ngClass"],["for","frase",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],["type","text","id","frase","formControlName","frase",1,"block","w-full","h-10","px-3","rounded-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],[1,"mt-2","text-xs","text-gray-500","dark:text-gray-400","transition-colors","duration-200"],["for","comunidades",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],["id","comunidades","formControlName","comunidades","rows","3",1,"block","w-full","px-3","py-2","rounded-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],[1,"sm:col-span-3"],["for","correo",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],["type","email","id","correo","formControlName","correo",1,"block","w-full","h-10","px-3","rounded-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],["for","horariodeatencion",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],["type","text","id","horariodeatencion","formControlName","horariodeatencion",1,"block","w-full","h-10","px-3","rounded-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],[1,"text-lg","font-medium","text-gray-700","dark:text-gray-300","mb-3"],[1,"mt-3"],["for","red_facebook",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],[1,"mt-2","flex","rounded-md","shadow-sm"],[1,"inline-flex","items-center","rounded-l-md","border","border-r-0","border-gray-300","dark:border-gray-700","bg-gray-50","dark:bg-gray-800","px-3","text-gray-500","dark:text-gray-400","sm:text-sm","transition-colors","duration-200"],["fill","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["d","M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.987C18.343 21.128 22 16.991 22 12z"],["type","text","id","red_facebook","formControlName","red_facebook","placeholder","https://facebook.com/municipalidad",1,"block","w-full","h-10","flex-1","rounded-none","rounded-r-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],[1,"mt-4"],["for","red_instagram",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],[1,"inline-flex","items-center","rounded-l-md","border","border-r-0","border-gray-300","dark:border-gray-700","bg-gray-50","dark:bg-gray-800","px-3","text-pink-500","dark:text-pink-400","sm:text-sm","transition-colors","duration-200"],["d","M12.315 2c2.43 0 2.784.013 3.808.06 1.064.049 1.791.218 2.427.465a4.902 4.902 0 011.772 1.153 4.902 4.902 0 011.153 1.772c.247.636.416 1.363.465 2.427.048 1.067.06 1.407.06 4.123v.08c0 2.643-.012 2.987-.06 4.043-.049 1.064-.218 1.791-.465 2.427a4.902 4.902 0 01-1.153 1.772 4.902 4.902 0 01-1.772 1.153c-.636.247-1.363.416-2.427.465-1.067.048-1.407.06-4.123.06h-.08c-2.643 0-2.987-.012-4.043-.06-1.064-.049-1.791-.218-2.427-.465a4.902 4.902 0 01-1.772-1.153 4.902 4.902 0 01-1.153-1.772c-.247-.636-.416-1.363-.465-2.427-.047-1.024-.06-1.379-.06-3.808v-.63c0-2.43.013-2.784.06-3.808.049-1.064.218-1.791.465-2.427a4.902 4.902 0 011.153-1.772A4.902 4.902 0 015.45 2.525c.636-.247 1.363-.416 2.427-.465C8.901 2.013 9.256 2 11.685 2h.63zm-.081 1.802h-.468c-2.456 0-2.784.011-3.807.058-.975.045-1.504.207-1.857.344-.467.182-.8.398-1.15.748-.35.35-.566.683-.748 1.15-.137.353-.3.882-.344 1.857-.047 1.023-.058 1.351-.058 3.807v.468c0 2.456.011 2.784.058 3.807.045.975.207 1.504.344 1.857.182.466.399.8.748 1.15.35.35.683.566 1.15.748.353.137.882.3 1.857.344 1.054.048 1.37.058 4.041.058h.08c2.597 0 2.917-.01 3.96-.058.976-.045 1.505-.207 1.858-.344.466-.182.8-.398 1.15-.748.35-.35.566-.683.748-1.15.137-.353.3-.882.344-1.857.048-1.055.058-1.37.058-4.041v-.08c0-2.597-.01-2.917-.058-3.96-.045-.976-.207-1.505-.344-1.858a3.097 3.097 0 00-.748-1.15 3.098 3.098 0 00-1.15-.748c-.353-.137-.882-.3-1.857-.344-1.023-.047-1.351-.058-3.807-.058zM12 6.865a5.135 5.135 0 110 10.27 5.135 5.135 0 010-10.27zm0 1.802a3.333 3.333 0 100 6.666 3.333 3.333 0 000-6.666zm5.338-3.205a1.2 1.2 0 110 2.4 1.2 1.2 0 010-2.4z"],["type","text","id","red_instagram","formControlName","red_instagram","placeholder","https://instagram.com/municipalidad",1,"block","w-full","h-10","flex-1","rounded-none","rounded-r-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],["for","red_youtube",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],[1,"inline-flex","items-center","rounded-l-md","border","border-r-0","border-gray-300","dark:border-gray-700","bg-gray-50","dark:bg-gray-800","px-3","text-red-500","dark:text-red-400","sm:text-sm","transition-colors","duration-200"],["d","M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"],["type","text","id","red_youtube","formControlName","red_youtube","placeholder","https://youtube.com/channel/municipalidad",1,"block","w-full","h-10","flex-1","rounded-none","rounded-r-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],["for","mision",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],["id","mision","formControlName","mision","rows","3",1,"block","w-full","px-3","py-2","rounded-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],["for","vision",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],["id","vision","formControlName","vision","rows","3",1,"block","w-full","px-3","py-2","rounded-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],["for","valores",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],["id","valores","formControlName","valores","rows","3",1,"block","w-full","px-3","py-2","rounded-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],["for","comite",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],["id","comite","formControlName","comite","rows","3",1,"block","w-full","px-3","py-2","rounded-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],["for","ordenanzamunicipal",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],["id","ordenanzamunicipal","formControlName","ordenanzamunicipal","rows","3",1,"block","w-full","px-3","py-2","rounded-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],["for","alianzas",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],["id","alianzas","formControlName","alianzas","rows","3",1,"block","w-full","px-3","py-2","rounded-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],["for","coordenadas_x",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],["type","number","step","0.0000001","id","coordenadas_x","formControlName","coordenadas_x",1,"block","w-full","h-10","px-3","rounded-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],["for","coordenadas_y",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],["type","number","step","0.0000001","id","coordenadas_y","formControlName","coordenadas_y",1,"block","w-full","h-10","px-3","rounded-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],["for","historiacapachica",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],["id","historiacapachica","formControlName","historiacapachica","rows","4",1,"block","w-full","px-3","py-2","rounded-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],["for","historiafamilias",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],["id","historiafamilias","formControlName","historiafamilias","rows","4",1,"block","w-full","px-3","py-2","rounded-md","border-gray-300","dark:border-gray-700","dark:bg-gray-900","dark:text-white","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],["title","Im\xE1genes Principales",3,"changeSlidersEvent","deletedSlidersEvent","slidersFormArray","existingSliders","isSliderPrincipal"],["title","Im\xE1genes Secundarias (con descripci\xF3n)",3,"changeSlidersEvent","deletedSlidersEvent","slidersFormArray","existingSliders","isSliderPrincipal"],[1,"flex"],[1,"flex-shrink-0"],["viewBox","0 0 20 20","fill","currentColor","aria-hidden","true",1,"h-5","w-5","text-red-400"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z","clip-rule","evenodd"],[1,"ml-3"],[1,"text-sm","font-medium","text-red-800","dark:text-red-400","transition-colors","duration-200"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-2","h-4","w-4","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,o){e&1&&(l(0,"app-admin-header",0),i(1,"div",1)(2,"div",2)(3,"h1",3),a(4),t(),i(5,"div",4)(6,"a",5),m(),i(7,"svg",6),l(8,"path",7),t(),a(9," Volver al listado "),t()()(),v(),i(10,"div",8),g(11,ve,4,0,"div",9)(12,Te,26,29,"form",10),t()()),e&2&&(d(4),y(o.isEditMode?"Editar Municipalidad":"Crear Municipalidad"),d(7),u(o.loading?11:12))},dependencies:[A,H,T,J,R,B,ie,O,$,U,q,te,K],encapsulation:2})};var oe=r=>({"border-red-300":r}),Ve=r=>["/admin/asociaciones",r,"emprendedores"],Ie=(r,n)=>n.id;function ze(r,n){r&1&&(i(0,"p",16),a(1," Gestione las asociaciones vinculadas a esta municipalidad. "),t())}function Ne(r,n){r&1&&(i(0,"p",26),a(1,"El nombre es requerido"),t())}function Le(r,n){r&1&&(i(0,"p",26),a(1,"La descripci\xF3n es requerida"),t())}function Ge(r,n){if(r&1&&(i(0,"div",39)(1,"div",43)(2,"div",44)(3,"h3",45),a(4),t()()()()),r&2){let e=c(2);d(4),y(e.error)}}function Pe(r,n){r&1&&(m(),i(0,"svg",46),l(1,"circle",47)(2,"path",48),t(),a(3," Guardando... "))}function He(r,n){if(r&1&&a(0),r&2){let e=c(2);M(" ",e.editingAsociacion?"Actualizar":"Guardar"," ")}}function De(r,n){if(r&1){let e=C();i(0,"div",11)(1,"div",17)(2,"h2",18),a(3),t(),i(4,"button",19),b("click",function(){x(e);let s=c();return f(s.cancelForm())}),m(),i(5,"svg",20),l(6,"path",21),t()()(),v(),i(7,"form",22),b("ngSubmit",function(){x(e);let s=c();return f(s.saveAsociacion())}),i(8,"div")(9,"label",23),a(10,"Nombre"),t(),i(11,"div",24),l(12,"input",25),g(13,Ne,2,0,"p",26),t()(),i(14,"div")(15,"label",27),a(16,"Descripci\xF3n"),t(),i(17,"div",24),l(18,"textarea",28),g(19,Le,2,0,"p",26),t()(),i(20,"div")(21,"label",29),a(22,"Ubicaci\xF3n"),t(),i(23,"div",24),l(24,"input",30),t()(),i(25,"div",31)(26,"div")(27,"label",32),a(28,"Tel\xE9fono"),t(),i(29,"div",24),l(30,"input",33),t()(),i(31,"div")(32,"label",34),a(33,"Email"),t(),i(34,"div",24),l(35,"input",35),t()()(),i(36,"div")(37,"div",36),l(38,"input",37),i(39,"label",38),a(40,"Activo"),t()()(),g(41,Ge,5,1,"div",39),i(42,"div",40)(43,"button",41),b("click",function(){x(e);let s=c();return f(s.cancelForm())}),a(44," Cancelar "),t(),i(45,"button",42),g(46,Pe,4,0)(47,He,1,1),t()()()()}if(r&2){let e=c();d(3),M("",e.editingAsociacion?"Editar":"A\xF1adir"," Asociaci\xF3n"),d(4),p("formGroup",e.asociacionForm),d(5),p("ngClass",k(9,oe,e.isFieldInvalid("nombre"))),d(),u(e.isFieldInvalid("nombre")?13:-1),d(5),p("ngClass",k(11,oe,e.isFieldInvalid("descripcion"))),d(),u(e.isFieldInvalid("descripcion")?19:-1),d(22),u(e.error?41:-1),d(4),p("disabled",e.saving||e.asociacionForm.invalid),d(),u(e.saving?46:47)}}function je(r,n){r&1&&(i(0,"div",13),l(1,"div",49),i(2,"span",50),a(3,"Cargando asociaciones..."),t()())}function Be(r,n){if(r&1){let e=C();i(0,"div",14),m(),i(1,"svg",51),l(2,"path",52),t(),v(),i(3,"h3",53),a(4,"No hay asociaciones"),t(),i(5,"p",16),a(6,"Comience creando una nueva asociaci\xF3n para esta municipalidad."),t(),i(7,"div",54)(8,"button",8),b("click",function(){x(e);let s=c();return f(s.showAddForm=!0)}),m(),i(9,"svg",9),l(10,"path",10),t(),a(11," Nueva Asociaci\xF3n "),t()()()}}function Oe(r,n){if(r&1&&(i(0,"div"),a(1),t()),r&2){let e=c().$implicit;d(),y(e.telefono)}}function $e(r,n){if(r&1&&(i(0,"div"),a(1),t()),r&2){let e=c().$implicit;d(),y(e.email)}}function Re(r,n){r&1&&(i(0,"div"),a(1,"Sin informaci\xF3n"),t())}function Ue(r,n){r&1&&(i(0,"span",65),a(1," Activo "),t())}function qe(r,n){r&1&&(i(0,"span",66),a(1," Inactivo "),t())}function Ye(r,n){if(r&1){let e=C();i(0,"tr")(1,"td",60)(2,"div",61),a(3),t()(),i(4,"td",62)(5,"div",63),a(6),t()(),i(7,"td",60)(8,"div",64),a(9),t()(),i(10,"td",60)(11,"div",64),g(12,Oe,2,1,"div")(13,$e,2,1,"div")(14,Re,2,0,"div"),t()(),i(15,"td",60),g(16,Ue,2,0,"span",65)(17,qe,2,0,"span",66),t(),i(18,"td",67)(19,"div",68)(20,"button",69),b("click",function(){let s=x(e).$implicit,h=c(2);return f(h.editAsociacion(s))}),m(),i(21,"svg",20),l(22,"path",70),t()(),v(),i(23,"a",71),m(),i(24,"svg",20),l(25,"path",72),t()(),v(),i(26,"button",73),b("click",function(){let s=x(e).$implicit,h=c(2);return f(h.deleteAsociacion(s))}),m(),i(27,"svg",20),l(28,"path",74),t()()()()()}if(r&2){let e=n.$implicit;d(3),y(e.nombre),d(3),y(e.descripcion),d(3),y(e.ubicacion||"No disponible"),d(3),u(e.telefono?12:-1),d(),u(e.email?13:-1),d(),u(!e.telefono&&!e.email?14:-1),d(2),u(e.estado?16:17),d(7),p("routerLink",k(8,Ve,e.id))}}function Je(r,n){if(r&1&&(i(0,"div",15)(1,"table",55)(2,"thead",56)(3,"tr")(4,"th",57),a(5,"Nombre"),t(),i(6,"th",57),a(7,"Descripci\xF3n"),t(),i(8,"th",57),a(9,"Ubicaci\xF3n"),t(),i(10,"th",57),a(11,"Contacto"),t(),i(12,"th",57),a(13,"Estado"),t(),i(14,"th",58),a(15,"Acciones"),t()()(),i(16,"tbody",59),G(17,Ye,29,10,"tr",null,Ie),t()()()),r&2){let e=c();d(17),P(e.asociaciones)}}var W=class r{fb=_(Y);turismoService=_(I);route=_(D);router=_(j);municipalidadId=null;municipalidad=null;asociaciones=[];asociacionForm;editingAsociacion=null;loading=!0;saving=!1;submitted=!1;error="";showAddForm=!1;ngOnInit(){this.initForm();let n=this.route.snapshot.paramMap.get("id");n?(this.municipalidadId=+n,this.loadMunicipalidad(),this.loadAsociaciones()):(this.error="ID de municipalidad no v\xE1lido",this.loading=!1)}initForm(){this.asociacionForm=this.fb.group({nombre:["",V.required],descripcion:["",V.required],ubicacion:[""],telefono:[""],email:[""],estado:[!0]})}loadMunicipalidad(){this.municipalidadId&&this.turismoService.getMunicipalidad(this.municipalidadId).subscribe({next:n=>{this.municipalidad=n},error:n=>{console.error("Error al cargar municipalidad:",n),this.error="Error al cargar los datos de la municipalidad."}})}loadAsociaciones(){this.municipalidadId&&(this.loading=!0,this.turismoService.getAsociacionesByMunicipalidad(this.municipalidadId).subscribe({next:n=>{this.asociaciones=n,this.loading=!1},error:n=>{console.error("Error al cargar asociaciones:",n),this.error="Error al cargar las asociaciones.",this.loading=!1}}))}editAsociacion(n){this.editingAsociacion=n,this.asociacionForm.patchValue({nombre:n.nombre,descripcion:n.descripcion,ubicacion:n.ubicacion||"",telefono:n.telefono||"",email:n.email||"",estado:n.estado!==void 0?n.estado:!0}),this.showAddForm=!0}saveAsociacion(){if(this.submitted=!0,this.error="",this.asociacionForm.invalid)return;let n=w(S({},this.asociacionForm.value),{municipalidad_id:this.municipalidadId});this.saving=!0,this.editingAsociacion&&this.editingAsociacion.id?this.turismoService.updateAsociacion(this.editingAsociacion.id,n).subscribe({next:e=>{let o=this.asociaciones.findIndex(s=>s.id===this.editingAsociacion.id);o!==-1&&(this.asociaciones[o]=e),this.saving=!1,this.resetForm(),alert("Asociaci\xF3n actualizada correctamente")},error:e=>{console.error("Error al actualizar asociaci\xF3n:",e),this.error=e.error?.message||"Error al actualizar la asociaci\xF3n. Por favor, intente nuevamente.",this.saving=!1}}):this.turismoService.createAsociacion(n).subscribe({next:e=>{this.asociaciones.push(e),this.saving=!1,this.resetForm(),alert("Asociaci\xF3n creada correctamente")},error:e=>{console.error("Error al crear asociaci\xF3n:",e),this.error=e.error?.message||"Error al crear la asociaci\xF3n. Por favor, intente nuevamente.",this.saving=!1}})}deleteAsociacion(n){n.id&&confirm(`\xBFEst\xE1 seguro de eliminar la asociaci\xF3n "${n.nombre}"? Esta acci\xF3n eliminar\xE1 tambi\xE9n todos los emprendedores relacionados y no se puede deshacer.`)&&this.turismoService.deleteAsociacion(n.id).subscribe({next:()=>{this.asociaciones=this.asociaciones.filter(e=>e.id!==n.id),alert("Asociaci\xF3n eliminada correctamente")},error:e=>{console.error("Error al eliminar asociaci\xF3n:",e),alert("Error al eliminar la asociaci\xF3n. Por favor, intente nuevamente.")}})}cancelForm(){this.resetForm()}resetForm(){this.asociacionForm.reset({estado:!0}),this.editingAsociacion=null,this.showAddForm=!1,this.submitted=!1,this.error=""}isFieldInvalid(n){let e=this.asociacionForm.get(n);return e?.invalid&&(e?.dirty||e?.touched||this.submitted)||!1}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=E({type:r,selectors:[["app-municipalidad-asociaciones"]],decls:20,vars:4,consts:[[1,"space-y-6"],[1,"sm:flex","sm:items-center","sm:justify-between"],[1,"text-2xl","font-bold","text-gray-900"],["class","mt-1 text-sm text-gray-500",4,"ngIf"],[1,"mt-4","sm:mt-0","flex","space-x-3"],["routerLink","/admin/municipalidad",1,"inline-flex","items-center","rounded-md","border","border-gray-300","bg-white","px-4","py-2","text-sm","font-medium","text-gray-700","shadow-sm","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5","text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],["type","button",1,"inline-flex","items-center","rounded-md","bg-primary-600","px-4","py-2","text-sm","font-medium","text-white","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"bg-white","shadow-sm","rounded-lg","p-6"],[1,"rounded-lg","bg-white","shadow-sm","overflow-hidden"],[1,"flex","justify-center","items-center","p-8"],[1,"p-8","text-center"],[1,"overflow-x-auto"],[1,"mt-1","text-sm","text-gray-500"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-lg","font-medium","text-gray-900"],["type","button",1,"text-gray-500","hover:text-gray-700",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","nombre",1,"block","text-sm","font-medium","text-gray-700"],[1,"mt-1"],["type","text","id","nombre","formControlName","nombre",1,"block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm",3,"ngClass"],[1,"mt-2","text-sm","text-red-600"],["for","descripcion",1,"block","text-sm","font-medium","text-gray-700"],["id","descripcion","formControlName","descripcion","rows","3",1,"block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm",3,"ngClass"],["for","ubicacion",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","ubicacion","formControlName","ubicacion",1,"block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm"],[1,"grid","grid-cols-1","gap-4","sm:grid-cols-2"],["for","telefono",1,"block","text-sm","font-medium","text-gray-700"],["type","tel","id","telefono","formControlName","telefono",1,"block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm"],["for","email",1,"block","text-sm","font-medium","text-gray-700"],["type","email","id","email","formControlName","email",1,"block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm"],[1,"flex","items-center"],["type","checkbox","id","estado","formControlName","estado",1,"h-4","w-4","rounded","border-gray-300","text-primary-600","focus:ring-primary-500"],["for","estado",1,"ml-2","block","text-sm","text-gray-700"],[1,"rounded-md","bg-red-50","p-4"],[1,"flex","justify-end","space-x-3"],["type","button",1,"inline-flex","justify-center","rounded-md","border","border-gray-300","bg-white","px-4","py-2","text-sm","font-medium","text-gray-700","shadow-sm","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2",3,"click"],["type","submit",1,"inline-flex","justify-center","rounded-md","border","border-transparent","bg-primary-600","px-4","py-2","text-sm","font-medium","text-white","shadow-sm","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2",3,"disabled"],[1,"flex"],[1,"ml-3"],[1,"text-sm","font-medium","text-red-800"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-2","h-4","w-4","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"inline-block","h-8","w-8","animate-spin","rounded-full","border-4","border-solid","border-primary-400","border-r-transparent"],[1,"ml-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-6"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],["scope","col",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],["scope","col",1,"px-6","py-3","text-right","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","font-medium","text-gray-900"],[1,"px-6","py-4"],[1,"text-sm","text-gray-500","truncate","max-w-xs"],[1,"text-sm","text-gray-500"],[1,"inline-flex","rounded-full","bg-green-100","px-2.5","py-0.5","text-xs","font-medium","text-green-800"],[1,"inline-flex","rounded-full","bg-red-100","px-2.5","py-0.5","text-xs","font-medium","text-red-800"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"flex","items-center","justify-end","space-x-2"],["title","Editar",1,"text-primary-600","hover:text-primary-900",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["title","Ver emprendedores",1,"text-green-600","hover:text-green-900",3,"routerLink"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],["title","Eliminar",1,"text-red-600","hover:text-red-900",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),a(4),t(),g(5,ze,2,0,"p",3),t(),i(6,"div",4)(7,"a",5),m(),i(8,"svg",6),l(9,"path",7),t(),a(10," Volver "),t(),v(),i(11,"button",8),b("click",function(){return o.showAddForm=!0}),m(),i(12,"svg",9),l(13,"path",10),t(),a(14," Nueva Asociaci\xF3n "),t()()(),g(15,De,48,13,"div",11),v(),i(16,"div",12),g(17,je,4,0,"div",13)(18,Be,12,0,"div",14)(19,Je,19,0,"div",15),t()()),e&2&&(d(4),M("Asociaciones de ",o.municipalidad==null?null:o.municipalidad.nombre,""),d(),p("ngIf",o.municipalidad),d(10),u(o.showAddForm?15:-1),d(2),u(o.loading?17:o.asociaciones.length===0?18:19))},dependencies:[A,H,X,T,J,R,B,ee,O,$,U,q],encapsulation:2})};var Pi=[{path:"",component:Q},{path:"create",component:N},{path:"edit/:id",component:N},{path:":id/asociaciones",component:W}];export{Pi as MUNICIPALIDAD_ROUTES};
