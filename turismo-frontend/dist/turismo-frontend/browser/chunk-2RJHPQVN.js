import{a as Ye}from"./chunk-QV354RAL.js";import{a as z}from"./chunk-G5KRKBM3.js";import{a as We}from"./chunk-Y34SCQEG.js";import{a as $}from"./chunk-PYGBUVLC.js";import{a as Be}from"./chunk-TFAAEB5J.js";import{a as qe}from"./chunk-RRUC2C5S.js";import{b as q,c as A,d as W,e as Oe,h as Y,i as Ge,j as fe,k as be,l as Ne,o as $e,p as J,q as K,r as Q,t as he,x as ze,y as B,z as Ue}from"./chunk-KTW5JVGU.js";import{d as ie,f as re,g as N}from"./chunk-XR3SD2KY.js";import{Ga as ae,Gb as a,Gc as Ae,Hb as k,Hc as j,Ib as x,Jb as D,La as d,Lb as M,Mb as I,Nb as R,Nc as _e,Oc as te,Pb as ge,Pc as xe,Qb as L,Sc as oe,Tb as De,U as ve,Va as H,Xb as Le,_ as w,_a as f,_b as He,c as ue,fb as m,ga as v,ha as g,hb as V,hc as U,ia as b,ib as F,ja as y,jb as ee,mb as Te,nb as Ve,ob as i,p as T,pb as r,qb as p,rb as Fe,sb as Pe,tb as C,ua as S,ub as _,uc as je,vb as c,vc as O,wc as G}from"./chunk-ETYZCZA5.js";import{a as Z,b as ce,d as Re}from"./chunk-4CLCTAJ7.js";var X=class s{http=w(xe);API_URL=oe.apiUrl;getHeaders(){let t=localStorage.getItem("auth_token");return new _e({Authorization:`Bearer ${t}`,Accept:"application/json","Content-Type":"application/json"})}getReservas(t=1,e=10,n={}){let o=new te().set("page",t.toString()).set("per_page",e.toString());return n.codigo&&(o=o.set("codigo",n.codigo)),n.estado&&(o=o.set("estado",n.estado)),n.fecha_inicio&&(o=o.set("fecha_inicio",n.fecha_inicio)),n.usuario_id&&(o=o.set("usuario_id",n.usuario_id.toString())),n.emprendedor_id&&(o=o.set("emprendedor_id",n.emprendedor_id.toString())),n.servicio_id&&(o=o.set("servicio_id",n.servicio_id.toString())),this.http.get(`${this.API_URL}/reservas`,{params:o,headers:this.getHeaders()}).pipe(T(l=>l.data))}getReserva(t){return this.http.get(`${this.API_URL}/reservas/${t}`,{headers:this.getHeaders()}).pipe(T(e=>Array.isArray(e.data)?e.data[0]:e.data))}createReserva(t){return this.http.post(`${this.API_URL}/reservas`,t,{headers:this.getHeaders()}).pipe(T(e=>Array.isArray(e.data)?e.data[0]:e.data))}updateReserva(t,e){return this.http.put(`${this.API_URL}/reservas/${t}`,e,{headers:this.getHeaders()}).pipe(T(n=>Array.isArray(n.data)?n.data[0]:n.data))}deleteReserva(t){return this.http.delete(`${this.API_URL}/reservas/${t}`,{headers:this.getHeaders()})}cambiarEstadoReserva(t,e){return this.http.put(`${this.API_URL}/reservas/${t}/estado`,{estado:e},{headers:this.getHeaders()}).pipe(T(n=>Array.isArray(n.data)?n.data[0]:n.data))}cambiarEstadoServicioReserva(t,e){return this.http.put(`${this.API_URL}/reserva-servicios/${t}/estado`,{estado:e},{headers:this.getHeaders()}).pipe(T(n=>n.data))}getReservasByEmprendedor(t){return this.http.get(`${this.API_URL}/reservas/emprendedor/${t}`,{headers:this.getHeaders()}).pipe(T(e=>Array.isArray(e.data)?e.data:[e.data]))}getReservasByServicio(t){return this.http.get(`${this.API_URL}/reservas/servicio/${t}`,{headers:this.getHeaders()}).pipe(T(e=>Array.isArray(e.data)?e.data:[e.data]))}getServiciosReserva(t){return this.http.get(`${this.API_URL}/reserva-servicios/reserva/${t}`,{headers:this.getHeaders()}).pipe(T(e=>e.data))}getCalendarioReservas(t,e){let n=new te().set("fecha_inicio",t).set("fecha_fin",e);return this.http.get(`${this.API_URL}/reserva-servicios/calendario`,{params:n,headers:this.getHeaders()}).pipe(T(o=>o.data))}verificarDisponibilidadServicio(t,e,n,o,l,u){let h=new te().set("servicio_id",t.toString()).set("fecha_inicio",e).set("hora_inicio",o).set("hora_fin",l);return n&&(h=h.set("fecha_fin",n)),u&&(h=h.set("reserva_servicio_id",u.toString())),this.http.get(`${this.API_URL}/reserva-servicios/verificar-disponibilidad`,{params:h,headers:this.getHeaders()})}getServicios(t=1,e=1e3){let n=new te().set("page",t.toString()).set("per_page",e.toString());return this.http.get(`${this.API_URL}/servicios`,{params:n,headers:this.getHeaders()}).pipe(T(o=>o.data))}getServicio(t){return this.http.get(`${this.API_URL}/servicios/${t}`,{headers:this.getHeaders()}).pipe(T(e=>e.data))}getEmprendedores(t=1,e=1e3){let n=new te().set("page",t.toString()).set("per_page",e.toString());return this.http.get(`${this.API_URL}/emprendedores`,{params:n,headers:this.getHeaders()}).pipe(T(o=>o.data))}getEstadisticasReservas(){return this.getReservas(1,1e3).pipe(T(t=>{let e=t.data,n={total:t.total,pendientes:0,confirmadas:0,completadas:0,canceladas:0};return e.forEach(o=>{switch(o.estado){case"pendiente":n.pendientes++;break;case"confirmada":n.confirmadas++;break;case"completada":n.completadas++;break;case"cancelada":n.canceladas++;break}}),n}))}getUsuarios(){return this.http.get(`${this.API_URL}/usuarios`,{headers:this.getHeaders()}).pipe(T(t=>t.data))}buscarUsuarios(t){let e=new te().set("q",t);return this.http.get(`${this.API_URL}/usuarios/search`,{params:e,headers:this.getHeaders()}).pipe(T(n=>n.data))}static \u0275fac=function(e){return new(e||s)};static \u0275prov=ve({token:s,factory:s.\u0275fac,providedIn:"root"})};var et=s=>["/admin/reservas/detail",s],tt=s=>["/admin/reservas/edit",s];function it(s,t){if(s&1&&(i(0,"p",51),a(1),r()),s&2){let e=c();d(),x(" Reservas para el emprendedor #",e.emprendedorId," ")}}function rt(s,t){s&1&&(i(0,"div",52),p(1,"div",53),i(2,"p",54),a(3,"Cargando reservas..."),r()())}function nt(s,t){s&1&&(i(0,"div",59),b(),i(1,"svg",60),p(2,"path",30),r(),y(),i(3,"h3",61),a(4,"No se encontraron reservas"),r(),i(5,"p",51),a(6,"Comience creando una nueva reserva."),r(),i(7,"div",62)(8,"a",63),b(),i(9,"svg",29),p(10,"path",32),r(),a(11," Nueva Reserva "),r()()())}function at(s,t){if(s&1&&(i(0,"div",75),a(1),r()),s&2){let e=c().$implicit,n=c(3);d(),x(" ",n.obtenerPrimerServicio(e)," ")}}function ot(s,t){if(s&1){let e=C();i(0,"div",92)(1,"div",93)(2,"button",94),_("click",function(){v(e);let o=c().$implicit,l=c(3);return g(l.cambiarEstado(o,"pendiente"))}),a(3," Pendiente "),r(),i(4,"button",94),_("click",function(){v(e);let o=c().$implicit,l=c(3);return g(l.cambiarEstado(o,"confirmada"))}),a(5," Confirmada "),r(),i(6,"button",94),_("click",function(){v(e);let o=c().$implicit,l=c(3);return g(l.cambiarEstado(o,"cancelada"))}),a(7," Cancelada "),r(),i(8,"button",94),_("click",function(){v(e);let o=c().$implicit,l=c(3);return g(l.cambiarEstado(o,"completada"))}),a(9," Completada "),r()()()}if(s&2){let e=c().$implicit;d(2),V("opacity-50",e.estado==="pendiente")("cursor-not-allowed",e.estado==="pendiente"),m("disabled",e.estado==="pendiente"),d(2),V("opacity-50",e.estado==="confirmada")("cursor-not-allowed",e.estado==="confirmada"),m("disabled",e.estado==="confirmada"),d(2),V("opacity-50",e.estado==="cancelada")("cursor-not-allowed",e.estado==="cancelada"),m("disabled",e.estado==="cancelada"),d(2),V("opacity-50",e.estado==="completada")("cursor-not-allowed",e.estado==="completada"),m("disabled",e.estado==="completada")}}function st(s,t){if(s&1){let e=C();i(0,"tr",71)(1,"td",72)(2,"div",73),a(3),r()(),i(4,"td",72)(5,"div",74),a(6),r(),i(7,"div",75),a(8),r()(),i(9,"td",72)(10,"div",74),a(11),r()(),i(12,"td",72)(13,"div",74),a(14),r(),f(15,at,2,1,"div",76),r(),i(16,"td",72)(17,"span",77),a(18),r()(),i(19,"td",78)(20,"div",79)(21,"a",80),b(),i(22,"svg",81),p(23,"path",82)(24,"path",83),r()(),y(),i(25,"a",84),b(),i(26,"svg",81),p(27,"path",85),r()(),y(),i(28,"div",86)(29,"button",87),_("click",function(o){let l=v(e).$implicit,u=c(3);return g(u.toggleEstadoMenu(l,o))}),b(),i(30,"svg",81),p(31,"path",88),r()(),f(32,ot,10,20,"div",89),r(),y(),i(33,"button",90),_("click",function(){let o=v(e).$implicit,l=c(3);return g(l.eliminarReserva(o))}),b(),i(34,"svg",81),p(35,"path",91),r()()()()()}if(s&2){let e,n=t.$implicit,o=c(3);d(3),k(n.codigo_reserva),d(3),x(" ",(n.usuario==null?null:n.usuario.name)||"Desconocido"," "),d(2),x(" ",(n.usuario==null?null:n.usuario.email)||""," "),d(3),k(o.formatearFecha(n.created_at)),d(3),x("",(n.servicios==null?null:n.servicios.length)||0," servicios"),d(),m("ngIf",n.servicios&&n.servicios.length>0),d(2),F(o.getEstadoClasse(n.estado)),d(),x(" ",o.getEstadoTexto(n.estado)," "),d(3),m("routerLink",L(12,et,n.id)),d(4),m("routerLink",L(14,tt,n.id)),d(7),m("ngIf",o.estadoMenuOpen()&&((e=o.reservaSeleccionada())==null?null:e.id)===n.id)}}function dt(s,t){if(s&1&&(i(0,"div",64)(1,"table",65)(2,"thead",66)(3,"tr")(4,"th",67),a(5,"C\xF3digo"),r(),i(6,"th",67),a(7,"Cliente"),r(),i(8,"th",67),a(9,"Fecha Creaci\xF3n"),r(),i(10,"th",67),a(11,"Servicios"),r(),i(12,"th",67),a(13,"Estado"),r(),i(14,"th",68),a(15,"Acciones"),r()()(),i(16,"tbody",69),f(17,st,36,16,"tr",70),r()()()),s&2){let e=c(2);d(17),m("ngForOf",e.reservasPaginadas().data)("ngForTrackBy",e.trackByReserva)}}function lt(s,t){if(s&1){let e=C();i(0,"div",95)(1,"div",96)(2,"div")(3,"p",97),a(4," Mostrando "),i(5,"span",98),a(6),r(),a(7," a "),i(8,"span",98),a(9),r(),a(10," de "),i(11,"span",98),a(12),r(),a(13," resultados "),r()(),i(14,"div")(15,"nav",99)(16,"button",100),_("click",function(){v(e);let o=c(2);return g(o.cambiarPagina(o.paginaActual-1))}),i(17,"span",101),a(18,"Anterior"),r(),b(),i(19,"svg",81),p(20,"path",102),r()(),y(),i(21,"span",103),a(22),r(),i(23,"button",104),_("click",function(){v(e);let o=c(2);return g(o.cambiarPagina(o.paginaActual+1))}),i(24,"span",101),a(25,"Siguiente"),r(),b(),i(26,"svg",81),p(27,"path",105),r()()()()()()}if(s&2){let e=c(2);d(6),k(e.reservasPaginadas().from||0),d(3),k(e.reservasPaginadas().to||0),d(3),k(e.reservasPaginadas().total),d(4),m("disabled",!e.reservasPaginadas().prev_page_url),d(6),D(" P\xE1gina ",e.paginaActual," de ",e.reservasPaginadas().last_page," "),d(),m("disabled",!e.reservasPaginadas().next_page_url)}}function ct(s,t){if(s&1&&(i(0,"div",55),f(1,nt,12,0,"div",56)(2,dt,18,2,"div",57)(3,lt,28,7,"div",58),r()),s&2){let e=c();d(),m("ngIf",!e.reservasPaginadas()||e.reservasPaginadas().data.length===0),d(),m("ngIf",e.reservasPaginadas()&&e.reservasPaginadas().data.length>0),d(),m("ngIf",e.reservasPaginadas()&&e.reservasPaginadas().last_page>1)}}var me=class s{reservasService=w(X);route=w(ie);themeService=w($);loading=S(!1);reservasPaginadas=S(null);estadisticas=S(null);estadoMenuOpen=S(!1);reservaSeleccionada=S(null);filtros={codigo:"",estado:"",fecha_inicio:""};paginaActual=1;elementosPorPagina=10;emprendedorId=null;ngOnInit(){let t=this.route.snapshot.paramMap.get("id");t&&(this.emprendedorId=+t,this.filtros.emprendedor_id=this.emprendedorId),this.cargarReservas(),this.cargarEstadisticas(),document.addEventListener("click",this.cerrarMenus.bind(this))}ngOnDestroy(){document.removeEventListener("click",this.cerrarMenus.bind(this))}cerrarMenus(){this.estadoMenuOpen.set(!1),this.reservaSeleccionada.set(null)}cargarReservas(){this.loading.set(!0),this.emprendedorId?this.reservasService.getReservasByEmprendedor(this.emprendedorId).subscribe({next:t=>{let e={current_page:1,data:t,from:1,to:t.length,total:t.length,per_page:t.length,last_page:1,path:"",first_page_url:"",last_page_url:"",next_page_url:null,prev_page_url:null,links:[]};this.reservasPaginadas.set(e),this.loading.set(!1)},error:t=>{console.error("Error al cargar reservas por emprendedor:",t),this.loading.set(!1)}}):this.reservasService.getReservas(this.paginaActual,this.elementosPorPagina,this.filtros).subscribe({next:t=>{this.reservasPaginadas.set(t),this.loading.set(!1)},error:t=>{console.error("Error al cargar reservas:",t),this.loading.set(!1)}})}cargarEstadisticas(){this.reservasService.getEstadisticasReservas().subscribe({next:t=>{this.estadisticas.set(t)},error:t=>{console.error("Error al cargar estad\xEDsticas:",t)}})}aplicarFiltros(){this.paginaActual=1,this.cargarReservas()}limpiarFiltros(){this.filtros={codigo:"",estado:"",fecha_inicio:""},this.emprendedorId&&(this.filtros.emprendedor_id=this.emprendedorId),this.aplicarFiltros()}cambiarPagina(t){let e=this.reservasPaginadas();!e||t<1||t>e.last_page||(this.paginaActual=t,this.cargarReservas())}toggleEstadoMenu(t,e){e.stopPropagation(),this.estadoMenuOpen()&&this.reservaSeleccionada()?.id===t.id?(this.estadoMenuOpen.set(!1),this.reservaSeleccionada.set(null)):(this.estadoMenuOpen.set(!0),this.reservaSeleccionada.set(t))}cambiarEstado(t,e){!t.id||t.estado===e||(this.estadoMenuOpen.set(!1),this.reservaSeleccionada.set(null),this.reservasService.cambiarEstadoReserva(t.id,e).subscribe({next:n=>{let o=this.reservasPaginadas();if(o){let l=o.data.findIndex(u=>u.id===t.id);l!==-1&&(o.data[l]=n,this.reservasPaginadas.set(Z({},o)))}this.cargarEstadisticas()},error:n=>{console.error("Error al cambiar estado:",n),alert("Error al cambiar el estado de la reserva")}}))}eliminarReserva(t){t.id&&confirm(`\xBFEst\xE1 seguro de eliminar la reserva "${t.codigo_reserva}"? Esta acci\xF3n no se puede deshacer.`)&&this.reservasService.deleteReserva(t.id).subscribe({next:()=>{this.cargarReservas(),this.cargarEstadisticas()},error:e=>{console.error("Error al eliminar reserva:",e),alert("Error al eliminar la reserva")}})}trackByReserva(t,e){return e.id||t}formatearFecha(t){return new Date(t).toLocaleDateString("es-PE",{year:"numeric",month:"short",day:"numeric"})}obtenerPrimerServicio(t){return!t.servicios||t.servicios.length===0?"":t.servicios[0].servicio?.nombre||"Servicio no disponible"}getEstadoClasse(t){return{pendiente:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",confirmada:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",completada:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",cancelada:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"}[t]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"}getEstadoTexto(t){return{pendiente:"Pendiente",confirmada:"Confirmada",completada:"Completada",cancelada:"Cancelada"}[t]||t}isDarkMode(){return this.themeService.isDarkMode()}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=H({type:s,selectors:[["app-reserva-list"]],decls:106,vars:11,consts:[["title","Gestionar Reservas","subtitle","Panel general de administraci\xF3n de reservas"],[1,"container","mx-auto","px-2","sm:px-4","py-6","bg-gray-50","dark:bg-gray-900","min-h-screen","transition-colors","duration-200"],[1,"grid","grid-cols-1","md:grid-cols-5","gap-4","mb-6"],[1,"bg-white","dark:bg-gray-800","p-4","rounded-lg","shadow","transition-colors","duration-200"],[1,"flex","items-center"],[1,"flex-shrink-0"],[1,"w-8","h-8","bg-blue-100","dark:bg-blue-900","rounded-full","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-blue-600","dark:text-blue-400"],["d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","font-medium","text-gray-500","dark:text-gray-400"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white"],[1,"w-8","h-8","bg-yellow-100","dark:bg-yellow-900","rounded-full","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-yellow-600","dark:text-yellow-400"],["d","M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z"],[1,"w-8","h-8","bg-green-100","dark:bg-green-900","rounded-full","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-green-600","dark:text-green-400"],["d","M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"],[1,"w-8","h-8","bg-purple-100","dark:bg-purple-900","rounded-full","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-purple-600","dark:text-purple-400"],[1,"w-8","h-8","bg-red-100","dark:bg-red-900","rounded-full","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-red-600","dark:text-red-400"],["d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"],[1,"bg-white","dark:bg-gray-800","p-6","rounded-lg","shadow-sm","dark:shadow-gray-900","transition-colors","duration-200","mb-6"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","mb-4"],[1,"text-2xl","font-bold","text-gray-900","dark:text-white","transition-colors","duration-200"],["class","mt-1 text-sm text-gray-500 dark:text-gray-400 transition-colors duration-200",4,"ngIf"],[1,"mt-4","sm:mt-0","flex","gap-3"],["routerLink","/admin/reservas/calendario",1,"inline-flex","items-center","rounded-md","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","px-4","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-200","shadow-sm","hover:bg-gray-50","dark:hover:bg-gray-600","transition-colors","duration-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],["routerLink","/admin/reservas/create",1,"inline-flex","items-center","rounded-md","bg-primary-600","px-4","py-2","text-sm","font-medium","text-white","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2","transition-colors","duration-200"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"grid","grid-cols-1","gap-4","md:grid-cols-4"],["for","codigo",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],[1,"mt-1"],["type","text","id","codigo","placeholder","C\xF3digo de reserva",1,"input-estilo","block","w-full","rounded-md","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","dark:bg-gray-700","dark:text-white","dark:placeholder-gray-400","transition-colors","duration-200",3,"ngModelChange","ngModel"],["for","estado",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],["id","estado",1,"select-estilo","block","w-full","rounded-md","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","dark:bg-gray-700","dark:text-white","transition-colors","duration-200",3,"ngModelChange","ngModel"],["value",""],["value","pendiente"],["value","confirmada"],["value","cancelada"],["value","completada"],["for","fecha",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],["type","date","id","fecha",1,"input-estilo","block","w-full","rounded-md","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","dark:bg-gray-700","dark:text-white","transition-colors","duration-200",3,"ngModelChange","ngModel"],[1,"flex","items-end"],["type","button",1,"inline-flex","items-center","rounded-md","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","px-4","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-200","shadow-sm","hover:bg-gray-50","dark:hover:bg-gray-600","transition-colors","duration-200",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],["class","text-center py-8",4,"ngIf"],["class","rounded-lg bg-white dark:bg-gray-800 shadow-sm overflow-hidden transition-colors duration-200",4,"ngIf"],[1,"mt-1","text-sm","text-gray-500","dark:text-gray-400","transition-colors","duration-200"],[1,"text-center","py-8"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-primary-600","mx-auto"],[1,"mt-2","text-gray-600","dark:text-gray-400"],[1,"rounded-lg","bg-white","dark:bg-gray-800","shadow-sm","overflow-hidden","transition-colors","duration-200"],["class","p-8 text-center",4,"ngIf"],["class","overflow-x-auto",4,"ngIf"],["class","bg-white dark:bg-gray-800 px-4 py-3 flex items-center justify-between border-t border-gray-200 dark:border-gray-700 sm:px-6 transition-colors duration-200",4,"ngIf"],[1,"p-8","text-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],[1,"mt-2","text-sm","font-medium","text-gray-900","dark:text-white","transition-colors","duration-200"],[1,"mt-6"],["routerLink","/admin/reservas/create",1,"inline-flex","items-center","rounded-md","bg-primary-600","px-4","py-2","text-sm","font-medium","text-white","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200","dark:divide-gray-700","transition-colors","duration-200"],[1,"bg-gray-50","dark:bg-gray-900","transition-colors","duration-200"],["scope","col",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","dark:text-gray-400","uppercase","tracking-wider","transition-colors","duration-200"],["scope","col",1,"px-6","py-3","text-right","text-xs","font-medium","text-gray-500","dark:text-gray-400","uppercase","tracking-wider","transition-colors","duration-200"],[1,"bg-white","dark:bg-gray-800","divide-y","divide-gray-200","dark:divide-gray-700","transition-colors","duration-200"],["class","hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200",4,"ngFor","ngForOf","ngForTrackBy"],[1,"hover:bg-gray-50","dark:hover:bg-gray-700","transition-colors","duration-200"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","font-medium","text-gray-900","dark:text-white","transition-colors","duration-200"],[1,"text-sm","text-gray-900","dark:text-white","transition-colors","duration-200"],[1,"text-xs","text-gray-500","dark:text-gray-400","transition-colors","duration-200"],["class","text-xs text-gray-500 dark:text-gray-400 transition-colors duration-200",4,"ngIf"],[1,"inline-flex","rounded-full","px-2.5","py-1","text-xs","font-medium"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"flex","items-center","justify-end","space-x-2"],["title","Ver detalles",1,"text-primary-600","dark:text-primary-400","hover:text-primary-900","dark:hover:text-primary-300","transition-colors","duration-200",3,"routerLink"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["title","Editar",1,"text-primary-600","dark:text-primary-400","hover:text-primary-900","dark:hover:text-primary-300","transition-colors","duration-200",3,"routerLink"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"relative","inline-block","text-left"],["title","Cambiar estado",1,"text-blue-600","dark:text-blue-400","hover:text-blue-900","dark:hover:text-blue-300","transition-colors","duration-200",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"],["class","origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white dark:bg-gray-800 ring-1 ring-black ring-opacity-5 dark:ring-gray-700 focus:outline-none z-10 transition-colors duration-200",4,"ngIf"],["title","Eliminar",1,"text-red-600","dark:text-red-400","hover:text-red-900","dark:hover:text-red-300","transition-colors","duration-200",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"origin-top-right","absolute","right-0","mt-2","w-48","rounded-md","shadow-lg","bg-white","dark:bg-gray-800","ring-1","ring-black","ring-opacity-5","dark:ring-gray-700","focus:outline-none","z-10","transition-colors","duration-200"],["role","menu","aria-orientation","vertical",1,"py-1"],[1,"text-gray-700","dark:text-gray-300","block","px-4","py-2","text-sm","hover:bg-gray-100","dark:hover:bg-gray-700","w-full","text-left","transition-colors","duration-200",3,"click","disabled"],[1,"bg-white","dark:bg-gray-800","px-4","py-3","flex","items-center","justify-between","border-t","border-gray-200","dark:border-gray-700","sm:px-6","transition-colors","duration-200"],[1,"hidden","sm:flex-1","sm:flex","sm:items-center","sm:justify-between"],[1,"text-sm","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],[1,"font-medium"],[1,"relative","z-0","inline-flex","rounded-md","shadow-sm","-space-x-px"],[1,"relative","inline-flex","items-center","px-2","py-2","rounded-l-md","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","text-sm","font-medium","text-gray-500","dark:text-gray-400","hover:bg-gray-50","dark:hover:bg-gray-600","transition-colors","duration-200","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"sr-only"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"relative","inline-flex","items-center","px-4","py-2","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","text-sm","font-medium","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],[1,"relative","inline-flex","items-center","px-2","py-2","rounded-r-md","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","text-sm","font-medium","text-gray-500","dark:text-gray-400","hover:bg-gray-50","dark:hover:bg-gray-600","transition-colors","duration-200","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"]],template:function(e,n){if(e&1&&(p(0,"app-admin-header",0),i(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),b(),i(7,"svg",7),p(8,"path",8),r()()(),y(),i(9,"div",9)(10,"p",10),a(11,"Total"),r(),i(12,"p",11),a(13),r()()()(),i(14,"div",3)(15,"div",4)(16,"div",5)(17,"div",12),b(),i(18,"svg",13),p(19,"path",14),r()()(),y(),i(20,"div",9)(21,"p",10),a(22,"Pendientes"),r(),i(23,"p",11),a(24),r()()()(),i(25,"div",3)(26,"div",4)(27,"div",5)(28,"div",15),b(),i(29,"svg",16),p(30,"path",17),r()()(),y(),i(31,"div",9)(32,"p",10),a(33,"Confirmadas"),r(),i(34,"p",11),a(35),r()()()(),i(36,"div",3)(37,"div",4)(38,"div",5)(39,"div",18),b(),i(40,"svg",19),p(41,"path",8),r()()(),y(),i(42,"div",9)(43,"p",10),a(44,"Completadas"),r(),i(45,"p",11),a(46),r()()()(),i(47,"div",3)(48,"div",4)(49,"div",5)(50,"div",20),b(),i(51,"svg",21),p(52,"path",22),r()()(),y(),i(53,"div",9)(54,"p",10),a(55,"Canceladas"),r(),i(56,"p",11),a(57),r()()()()(),i(58,"div",23)(59,"div",24)(60,"div")(61,"h1",25),a(62,"Gesti\xF3n de Reservas"),r(),f(63,it,2,1,"p",26),r(),i(64,"div",27)(65,"a",28),b(),i(66,"svg",29),p(67,"path",30),r(),a(68," Ver Calendario "),r(),y(),i(69,"a",31),b(),i(70,"svg",29),p(71,"path",32),r(),a(72," Nueva Reserva "),r()()(),y(),i(73,"div",33)(74,"div")(75,"label",34),a(76,"C\xF3digo de Reserva"),r(),i(77,"div",35)(78,"input",36),R("ngModelChange",function(l){return I(n.filtros.codigo,l)||(n.filtros.codigo=l),l}),_("ngModelChange",function(){return n.aplicarFiltros()}),r()()(),i(79,"div")(80,"label",37),a(81,"Estado"),r(),i(82,"div",35)(83,"select",38),R("ngModelChange",function(l){return I(n.filtros.estado,l)||(n.filtros.estado=l),l}),_("ngModelChange",function(){return n.aplicarFiltros()}),i(84,"option",39),a(85,"Todos"),r(),i(86,"option",40),a(87,"Pendiente"),r(),i(88,"option",41),a(89,"Confirmada"),r(),i(90,"option",42),a(91,"Cancelada"),r(),i(92,"option",43),a(93,"Completada"),r()()()(),i(94,"div")(95,"label",44),a(96,"Fecha de Inicio"),r(),i(97,"div",35)(98,"input",45),R("ngModelChange",function(l){return I(n.filtros.fecha_inicio,l)||(n.filtros.fecha_inicio=l),l}),_("ngModelChange",function(){return n.aplicarFiltros()}),r()()(),i(99,"div",46)(100,"button",47),_("click",function(){return n.limpiarFiltros()}),b(),i(101,"svg",29),p(102,"path",48),r(),a(103," Limpiar Filtros "),r()()()(),f(104,rt,4,0,"div",49)(105,ct,4,3,"div",50),r()),e&2){let o,l,u,h,E;d(13),k(((o=n.estadisticas())==null?null:o.total)||0),d(11),k(((l=n.estadisticas())==null?null:l.pendientes)||0),d(11),k(((u=n.estadisticas())==null?null:u.confirmadas)||0),d(11),k(((h=n.estadisticas())==null?null:h.completadas)||0),d(11),k(((E=n.estadisticas())==null?null:E.canceladas)||0),d(6),m("ngIf",n.emprendedorId),d(15),M("ngModel",n.filtros.codigo),d(5),M("ngModel",n.filtros.estado),d(15),M("ngModel",n.filtros.fecha_inicio),d(6),m("ngIf",n.loading()),d(),m("ngIf",!n.loading())}},dependencies:[j,O,G,N,B,K,Q,q,J,W,Y,z],encapsulation:2})};function mt(s,t){if(s&1&&(i(0,"div",4),p(1,"div",5),i(2,"p",6),a(3),r()()),s&2){let e=c();d(3),k(e.isEditMode()?"Cargando informaci\xF3n de la reserva...":"Cargando datos necesarios...")}}function pt(s,t){s&1&&(i(0,"div",48),a(1," El cliente es obligatorio "),r())}function ut(s,t){s&1&&(i(0,"div",48),a(1," El c\xF3digo de reserva es obligatorio "),r())}function vt(s,t){if(s&1){let e=C();i(0,"div",49)(1,"button",50),_("click",function(){v(e);let o=c(2);return g(o.generarNuevoCodigo())}),b(),i(2,"svg",19),p(3,"path",51),r()()()}}function gt(s,t){if(s&1){let e=C();i(0,"div",52),b(),i(1,"svg",53),p(2,"path",54),r(),y(),i(3,"h3",55),a(4,"A\xF1ada al menos un servicio"),r(),i(5,"p",56),a(6," Debe a\xF1adir al menos un servicio a la reserva para poder continuar. "),r(),i(7,"div",57)(8,"button",58),_("click",function(){v(e);let o=c(2);return g(o.addServicio())}),b(),i(9,"svg",59),p(10,"path",39),r(),a(11," A\xF1adir Primer Servicio "),r()()()}}function _t(s,t){if(s&1&&(i(0,"option",87),a(1),r()),s&2){let e=t.$implicit;m("value",e.id),d(),D(" ",e.nombre," - ",e.emprendedor==null?null:e.emprendedor.nombre," ")}}function xt(s,t){s&1&&(i(0,"div",48),a(1," El servicio es obligatorio "),r())}function ft(s,t){s&1&&(i(0,"div",48),a(1," La fecha de inicio es obligatoria "),r())}function bt(s,t){s&1&&(i(0,"div",48),a(1," La hora de inicio es obligatoria "),r())}function ht(s,t){s&1&&(i(0,"div",48),a(1," La hora de fin es obligatoria "),r())}function yt(s,t){s&1&&(i(0,"div",48),a(1," La hora de fin debe ser posterior a la hora de inicio "),r())}function kt(s,t){s&1&&(i(0,"div",88),b(),i(1,"svg",89),p(2,"circle",90)(3,"path",91),r(),a(4," Verificando disponibilidad... "),r())}function St(s,t){s&1&&(i(0,"div",94),b(),i(1,"svg",95),p(2,"path",96),r(),a(3," Servicio disponible en la fecha y horario seleccionados "),r())}function Ct(s,t){s&1&&(i(0,"div",97),b(),i(1,"svg",95),p(2,"path",98),r(),a(3," El servicio no est\xE1 disponible en la fecha y horario seleccionados "),r())}function wt(s,t){if(s&1&&(i(0,"div"),f(1,St,4,0,"div",92)(2,Ct,4,0,"div",93),r()),s&2){let e=c().index,n=c(3);d(),m("ngIf",n.servicioDisponible[e]),d(),m("ngIf",!n.servicioDisponible[e])}}function Et(s,t){if(s&1){let e=C();i(0,"div",62)(1,"div",63)(2,"h3",64),a(3),r(),i(4,"button",65),_("click",function(){let o=v(e).index,l=c(3);return g(l.removeServicio(o))}),b(),i(5,"svg",66),p(6,"path",67),r()()(),y(),i(7,"div",13)(8,"div",14)(9,"label",68),a(10,"Servicio *"),r(),i(11,"div",23)(12,"select",69),_("change",function(){let o=v(e).index,l=c(3);return g(l.onServicioChange(o))}),i(13,"option",70),a(14,"Seleccionar servicio"),r(),f(15,_t,2,3,"option",71),r()(),f(16,xt,2,0,"div",21),r(),i(17,"div",14)(18,"label",68),a(19,"Emprendedor"),r(),i(20,"div",23),p(21,"input",72),r()(),i(22,"div",25)(23,"label",68),a(24,"Fecha de inicio *"),r(),i(25,"div",23)(26,"input",73),_("change",function(){let o=v(e).index,l=c(3);return g(l.onFechaHoraChange(o))}),r()(),f(27,ft,2,0,"div",21),r(),i(28,"div",25)(29,"label",68),a(30,"Fecha de fin (opcional)"),r(),i(31,"div",23)(32,"input",74),_("change",function(){let o=v(e).index,l=c(3);return g(l.onFechaHoraChange(o))}),r()()(),i(33,"div",25)(34,"label",68),a(35,"Estado"),r(),i(36,"div",23)(37,"select",75)(38,"option",28),a(39,"Pendiente"),r(),i(40,"option",76),a(41,"Confirmado"),r(),i(42,"option",77),a(43,"Cancelado"),r(),i(44,"option",78),a(45,"Completado"),r()()()(),i(46,"div",25)(47,"label",68),a(48,"Hora de inicio *"),r(),i(49,"div",23)(50,"input",79),_("change",function(){let o=v(e).index,l=c(3);return g(l.onFechaHoraChange(o))}),r()(),f(51,bt,2,0,"div",21),r(),i(52,"div",25)(53,"label",68),a(54,"Hora de fin *"),r(),i(55,"div",23)(56,"input",80),_("change",function(){let o=v(e).index,l=c(3);return g(l.onFechaHoraChange(o))}),r()(),f(57,ht,2,0,"div",21)(58,yt,2,0,"div",21),r(),i(59,"div",25)(60,"label",68),a(61,"Duraci\xF3n (minutos)"),r(),i(62,"div",23),p(63,"input",81),r()(),i(64,"div",25)(65,"label",68),a(66,"Cantidad"),r(),i(67,"div",23),p(68,"input",82),r()(),i(69,"div",25)(70,"label",68),a(71,"Precio (S/)"),r(),i(72,"div",23),p(73,"input",83),r()(),i(74,"div",14)(75,"label",68),a(76,"Notas del cliente"),r(),i(77,"div",23),p(78,"textarea",84),r()(),i(79,"div",14)(80,"label",68),a(81,"Notas del emprendedor"),r(),i(82,"div",23),p(83,"textarea",85),r()(),i(84,"div",33),f(85,kt,5,0,"div",86)(86,wt,3,2,"div",3),r()()()}if(s&2){let e,n,o,l,u,h=t.index,E=c(3);m("formGroup",E.getServicioFormGroup(h)),d(3),x("Servicio #",h+1,""),d(6),m("for","servicio_id-"+h),d(3),m("id","servicio_id-"+h),d(3),m("ngForOf",E.serviciosDisponibles())("ngForTrackBy",E.trackByServicioDisponible),d(),m("ngIf",((e=E.getServicioFormGroup(h).get("servicio_id"))==null||e.errors==null?null:e.errors.required)&&((e=E.getServicioFormGroup(h).get("servicio_id"))==null?null:e.touched)),d(2),m("for","emprendedor_id-"+h),d(3),m("id","emprendedor_id-"+h)("value",E.getEmprendedorNombre(h)),d(2),m("for","fecha_inicio-"+h),d(3),m("id","fecha_inicio-"+h),d(),m("ngIf",((n=E.getServicioFormGroup(h).get("fecha_inicio"))==null||n.errors==null?null:n.errors.required)&&((n=E.getServicioFormGroup(h).get("fecha_inicio"))==null?null:n.touched)),d(2),m("for","fecha_fin-"+h),d(3),m("id","fecha_fin-"+h)("min",(o=E.getServicioFormGroup(h).get("fecha_inicio"))==null?null:o.value),d(2),m("for","estado-servicio-"+h),d(3),m("id","estado-servicio-"+h),d(10),m("for","hora_inicio-"+h),d(3),m("id","hora_inicio-"+h),d(),m("ngIf",((l=E.getServicioFormGroup(h).get("hora_inicio"))==null||l.errors==null?null:l.errors.required)&&((l=E.getServicioFormGroup(h).get("hora_inicio"))==null?null:l.touched)),d(2),m("for","hora_fin-"+h),d(3),m("id","hora_fin-"+h),d(),m("ngIf",((u=E.getServicioFormGroup(h).get("hora_fin"))==null||u.errors==null?null:u.errors.required)&&((u=E.getServicioFormGroup(h).get("hora_fin"))==null?null:u.touched)),d(),m("ngIf",E.horaFinInvalida(h)),d(2),m("for","duracion_minutos-"+h),d(3),m("id","duracion_minutos-"+h),d(2),m("for","cantidad-"+h),d(3),m("id","cantidad-"+h),d(2),m("for","precio-"+h),d(3),m("id","precio-"+h),d(2),m("for","notas_cliente-"+h),d(3),m("id","notas_cliente-"+h),d(2),m("for","notas_emprendedor-"+h),d(3),m("id","notas_emprendedor-"+h),d(2),m("ngIf",E.verificandoDisponibilidad[h]),d(),m("ngIf",E.disponibilidadVerificada[h]&&!E.verificandoDisponibilidad[h])}}function Mt(s,t){if(s&1&&(i(0,"div",60),f(1,Et,87,37,"div",61),r()),s&2){let e=c(2);d(),m("ngForOf",e.serviciosArray.controls)("ngForTrackBy",e.trackByServicio)}}function It(s,t){if(s&1&&(i(0,"div",99)(1,"div",63)(2,"span",100),a(3,"Total estimado:"),r(),i(4,"span",101),a(5),r()()()),s&2){let e=c(2);d(5),x("S/ ",e.calcularTotal().toFixed(2),"")}}function Rt(s,t){s&1&&(b(),i(0,"svg",102),p(1,"circle",90)(2,"path",91),r())}function Tt(s,t){s&1&&(i(0,"div",52),p(1,"div",113),i(2,"p",6),a(3,"Buscando usuarios..."),r()())}function Vt(s,t){if(s&1&&(i(0,"div",52),b(),i(1,"svg",53),p(2,"path",114),r(),y(),i(3,"h3",55),a(4,"No se encontraron usuarios"),r(),i(5,"p",56),a(6),r()()),s&2){let e=c(3);d(6),x(" ",e.busquedaUsuario?"Intenta con otros t\xE9rminos de b\xFAsqueda":"Escribe para buscar usuarios"," ")}}function Ft(s,t){if(s&1&&p(0,"img",127),s&2){let e=c().$implicit;m("src",e.foto_perfil||e.foto_perfil_url||e.avatar,ae)("alt",e.name)}}function Pt(s,t){s&1&&(i(0,"div",128),b(),i(1,"svg",129),p(2,"path",114),r()())}function Dt(s,t){if(s&1&&(i(0,"span"),a(1),r()),s&2){let e=c().$implicit;d(),x("\u{1F4DE} ",e.phone,"")}}function Lt(s,t){if(s&1&&(i(0,"span"),a(1),r()),s&2){let e=c().$implicit;d(),x("\u{1F30D} ",e.country,"")}}function Ht(s,t){if(s&1&&(i(0,"span",130),a(1),r()),s&2){let e=t.$implicit,n=c(5);F(n.getRoleClass(e.name)),d(),x(" ",n.getRoleLabel(e.name)," ")}}function jt(s,t){if(s&1){let e=C();i(0,"div",116),_("click",function(){let o=v(e).$implicit,l=c(4);return g(l.seleccionarUsuario(o))}),i(1,"div",117)(2,"div",118),f(3,Ft,1,2,"img",119)(4,Pt,3,0,"div",120),r(),i(5,"div",121)(6,"p",122),a(7),r(),i(8,"p",123),a(9),r(),i(10,"div",124),f(11,Dt,2,1,"span",3)(12,Lt,2,1,"span",3),i(13,"span"),a(14),r()()(),i(15,"div",118)(16,"div",125),f(17,Ht,2,3,"span",126),r()()()()}if(s&2){let e=t.$implicit;d(3),m("ngIf",e.foto_perfil||e.foto_perfil_url||e.avatar),d(),m("ngIf",!e.foto_perfil&&!e.foto_perfil_url&&!e.avatar),d(3),k(e.name),d(2),k(e.email),d(2),m("ngIf",e.phone),d(),m("ngIf",e.country),d(),F(e.active?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),d(),x(" ",e.active?"\u2713 Activo":"\u2717 Inactivo"," "),d(3),m("ngForOf",e.roles)}}function At(s,t){if(s&1&&(i(0,"div",60),f(1,jt,18,10,"div",115),r()),s&2){let e=c(3);d(),m("ngForOf",e.usuariosBusqueda())("ngForTrackBy",e.trackByUsuario)}}function Bt(s,t){if(s&1){let e=C();i(0,"div",103)(1,"div",104)(2,"div",36)(3,"h3",101),a(4,"Seleccionar Cliente"),r(),i(5,"button",105),_("click",function(){v(e);let o=c(2);return g(o.cerrarModalUsuarios())}),b(),i(6,"svg",106),p(7,"path",107),r()()(),y(),i(8,"div",108)(9,"div",109)(10,"input",110),R("ngModelChange",function(o){v(e);let l=c(2);return I(l.busquedaUsuario,o)||(l.busquedaUsuario=o),g(o)}),_("ngModelChange",function(){v(e);let o=c(2);return g(o.buscarUsuarios())}),r(),b(),i(11,"svg",111),p(12,"path",20),r()()(),y(),i(13,"div",112),f(14,Tt,4,0,"div",40)(15,Vt,7,1,"div",40)(16,At,2,2,"div",41),r()()()}if(s&2){let e=c(2);d(10),M("ngModel",e.busquedaUsuario),d(4),m("ngIf",e.cargandoUsuarios()),d(),m("ngIf",!e.cargandoUsuarios()&&e.usuariosBusqueda().length===0),d(),m("ngIf",!e.cargandoUsuarios()&&e.usuariosBusqueda().length>0)}}function Ot(s,t){if(s&1){let e=C();i(0,"div")(1,"form",7),_("ngSubmit",function(){v(e);let o=c();return g(o.submitForm())}),i(2,"div",8)(3,"div",9)(4,"h2",10),a(5,"Informaci\xF3n de la Reserva"),r(),i(6,"p",11),a(7,"Complete los datos b\xE1sicos de la reserva"),r()(),i(8,"div",12)(9,"div",13)(10,"div",14)(11,"label",15),a(12,"Cliente *"),r(),i(13,"div",16),p(14,"input",17),i(15,"button",18),_("click",function(){v(e);let o=c();return g(o.abrirModalUsuarios())}),b(),i(16,"svg",19),p(17,"path",20),r()()(),f(18,pt,2,0,"div",21),r(),y(),i(19,"div",14)(20,"label",22),a(21,"C\xF3digo de Reserva *"),r(),i(22,"div",23),p(23,"input",24),r(),f(24,ut,2,0,"div",21),r(),i(25,"div",25)(26,"label",26),a(27,"Estado *"),r(),i(28,"div",23)(29,"select",27)(30,"option",28),a(31,"Pendiente"),r(),i(32,"option",29),a(33,"Confirmada"),r(),i(34,"option",30),a(35,"Cancelada"),r(),i(36,"option",31),a(37,"Completada"),r()()()(),f(38,vt,4,0,"div",32),i(39,"div",33)(40,"label",34),a(41,"Notas Generales"),r(),i(42,"div",23),p(43,"textarea",35),r()()()()(),i(44,"div",8)(45,"div",36)(46,"div")(47,"h2",10),a(48,"Servicios Reservados"),r(),i(49,"p",11),a(50,"A\xF1ada los servicios que se incluyen en esta reserva"),r()(),i(51,"button",37),_("click",function(){v(e);let o=c();return g(o.addServicio())}),b(),i(52,"svg",38),p(53,"path",39),r(),a(54," A\xF1adir Servicio "),r()(),f(55,gt,12,0,"div",40)(56,Mt,2,2,"div",41)(57,It,6,1,"div",42),r(),y(),i(58,"div",8)(59,"div",43)(60,"button",44),_("click",function(){v(e);let o=c();return g(o.cancelar())}),a(61," Cancelar "),r(),i(62,"button",45),f(63,Rt,3,0,"svg",46),a(64),r()()()(),f(65,Bt,17,4,"div",47),r()}if(s&2){let e,n,o=c();d(),m("formGroup",o.reservaForm),d(13),m("value",o.usuarioSeleccionado()?o.usuarioSeleccionado().name+" ("+o.usuarioSeleccionado().email+")":""),d(4),m("ngIf",((e=o.reservaForm.get("usuario_id"))==null||e.errors==null?null:e.errors.required)&&((e=o.reservaForm.get("usuario_id"))==null?null:e.touched)),d(5),V("bg-gray-100",o.isEditMode())("dark:bg-gray-600",o.isEditMode()),m("readonly",o.isEditMode()),d(),m("ngIf",((n=o.reservaForm.get("codigo_reserva"))==null||n.errors==null?null:n.errors.required)&&((n=o.reservaForm.get("codigo_reserva"))==null?null:n.touched)),d(14),m("ngIf",!o.isEditMode()),d(17),m("ngIf",o.serviciosArray.controls.length===0),d(),m("ngIf",o.serviciosArray.controls.length>0),d(),m("ngIf",o.serviciosArray.controls.length>0),d(5),m("disabled",!o.formularioValido()||o.isSubmitting()),d(),m("ngIf",o.isSubmitting()),d(),x(" ",o.isSubmitting()?"Guardando...":(o.isEditMode()?"Actualizar":"Crear")+" Reserva"," "),d(),m("ngIf",o.mostrarModalUsuarios())}}var pe=class s{fb=w(ze);reservasService=w(X);usersService=w(Ye);route=w(ie);router=w(re);themeService=w($);loading=S(!1);isSubmitting=S(!1);isEditMode=S(!1);reserva=S(null);serviciosDisponibles=S([]);emprendedores=S([]);usuarios=S([]);mostrarModalUsuarios=S(!1);usuariosBusqueda=S([]);cargandoUsuarios=S(!1);usuarioSeleccionado=S(null);busquedaUsuario="";reservaForm;reservaId=null;servicioPreseleccionadoId=null;verificandoDisponibilidad={};disponibilidadVerificada={};servicioDisponible={};formularioValido=U(()=>{if(!this.reservaForm)return!1;let t=this.reservaForm.valid,e=this.serviciosArray.length>0,n=this.numServiciosVerificados()===this.serviciosArray.length,o=!this.hayServiciosNoDisponibles();return t&&e&&n&&o});get serviciosArray(){return this.reservaForm.get("servicios")}ngOnInit(){this.initForm(),this.cargarDatosIniciales();let t=this.route.snapshot.paramMap.get("id");if(t)this.isEditMode.set(!0),this.reservaId=+t,this.cargarReserva(this.reservaId);else{let e=this.route.snapshot.queryParams.servicio_id;e!=null&&(this.servicioPreseleccionadoId=+e),this.reservaForm.patchValue({codigo_reserva:this.generarCodigoReserva()}),this.loading.set(!1),this.servicioPreseleccionadoId!==void 0&&setTimeout(()=>this.addServicio(this.servicioPreseleccionadoId),100)}}initForm(){this.reservaForm=this.fb.group({usuario_id:["",[A.required]],codigo_reserva:["",[A.required]],estado:["pendiente",[A.required]],notas:[""],servicios:this.fb.array([])})}cargarDatosIniciales(){return Re(this,null,function*(){this.loading.set(!0);try{let[t,e]=yield Promise.all([this.reservasService.getServicios(1,1e3).toPromise(),this.reservasService.getEmprendedores(1,1e3).toPromise()]);this.serviciosDisponibles.set(t?.data||[]),this.emprendedores.set(e?.data||[]),this.cargarUsuariosIniciales()}catch(t){console.error("Error al cargar datos iniciales:",t),alert("Error al cargar los datos necesarios")}this.isEditMode()||this.loading.set(!1)})}cargarUsuariosIniciales(){return Re(this,null,function*(){try{let t=yield this.usersService.getUsersByRole("user").toPromise();this.usuarios.set(t||[]),this.usuariosBusqueda.set(t||[])}catch(t){console.error("Error al cargar usuarios:",t)}})}cargarReserva(t){this.reservasService.getReserva(t).subscribe({next:e=>{if(this.reserva.set(e),this.reservaForm.patchValue({usuario_id:e.usuario_id,codigo_reserva:e.codigo_reserva,estado:e.estado,notas:e.notas||""}),e.usuario){let n={id:e.usuario.id,name:e.usuario.name,email:e.usuario.email,phone:e.usuario.phone??"",country:e.usuario.country,active:e.usuario.active,foto_perfil:e.usuario.foto_perfil,foto_perfil_url:e.usuario.foto_perfil_url,avatar:e.usuario.avatar,roles:[]};this.usuarioSeleccionado.set(n)}e.servicios&&e.servicios.length>0&&e.servicios.forEach((n,o)=>{this.addServicio(void 0,n),this.disponibilidadVerificada[o]=!0,this.servicioDisponible[o]=!0,this.verificandoDisponibilidad[o]=!1}),this.loading.set(!1)},error:e=>{console.error("Error al cargar reserva:",e),this.loading.set(!1),alert("Error al cargar la reserva")}})}getServicioFormGroup(t){return this.serviciosArray.at(t)}createServicioFormGroup(t){let e=new Date().toISOString().split("T")[0],n=new Date().toTimeString().slice(0,5);return this.fb.group({id:[t?.id||null],servicio_id:[t?.servicio_id||this.servicioPreseleccionadoId||"",[A.required]],emprendedor_id:[t?.emprendedor_id||"",[A.required]],fecha_inicio:[t?.fecha_inicio?t.fecha_inicio.split("T")[0]:e,[A.required]],fecha_fin:[t?.fecha_fin?t.fecha_fin.split("T")[0]:null],hora_inicio:[t?.hora_inicio||n,[A.required]],hora_fin:[t?.hora_fin||this.sumarHoras(n,1),[A.required]],duracion_minutos:[t?.duracion_minutos||60,[A.required,A.min(1)]],cantidad:[t?.cantidad||1,[A.min(1)]],precio:[t?.precio||0,[A.min(0)]],estado:[t?.estado||"pendiente",[A.required]],notas_cliente:[t?.notas_cliente||""],notas_emprendedor:[t?.notas_emprendedor||""]})}addServicio(t,e){let n=this.serviciosArray.length;this.serviciosArray.push(this.createServicioFormGroup(e)),this.verificandoDisponibilidad[n]=!1,this.disponibilidadVerificada[n]=!1,this.servicioDisponible[n]=!1,t&&!e&&(this.getServicioFormGroup(n).patchValue({servicio_id:t}),this.onServicioChange(n))}removeServicio(t){this.serviciosArray.removeAt(t),this.reindexarDisponibilidad(t)}onServicioChange(t){let e=this.getServicioFormGroup(t).get("servicio_id")?.value;if(!e)return;let n=this.serviciosDisponibles().find(o=>o.id==e);n&&(this.getServicioFormGroup(t).patchValue({emprendedor_id:n.emprendedor_id,precio:n.precio_referencial||0}),this.verificarDisponibilidad(t))}onFechaHoraChange(t){this.calcularDuracion(t),this.verificarDisponibilidad(t)}calcularDuracion(t){let e=this.getServicioFormGroup(t),n=e.get("hora_inicio")?.value,o=e.get("hora_fin")?.value;if(n&&o){let l=this.horaAMinutos(n),h=this.horaAMinutos(o)-l;h<=0&&(h+=24*60),e.patchValue({duracion_minutos:h})}}verificarDisponibilidad(t){let e=this.getServicioFormGroup(t),n=e.get("servicio_id")?.value,o=e.get("fecha_inicio")?.value,l=e.get("fecha_fin")?.value,u=e.get("hora_inicio")?.value,h=e.get("hora_fin")?.value,E=e.get("id")?.value;if(!n||!o||!u||!h){this.disponibilidadVerificada[t]=!1;return}this.verificandoDisponibilidad[t]=!0,this.disponibilidadVerificada[t]=!1,this.reservasService.verificarDisponibilidadServicio(n,o,l,this.formatearHora(u),this.formatearHora(h),E).subscribe({next:P=>{this.verificandoDisponibilidad[t]=!1,this.disponibilidadVerificada[t]=!0,this.servicioDisponible[t]=P.disponible},error:P=>{console.error("Error al verificar disponibilidad:",P),this.verificandoDisponibilidad[t]=!1,this.disponibilidadVerificada[t]=!0,this.servicioDisponible[t]=!1}})}submitForm(){if(!this.formularioValido()||this.isSubmitting())return;this.isSubmitting.set(!0);let t=this.prepararDatos();(this.isEditMode()&&this.reservaId?this.reservasService.updateReserva(this.reservaId,t):this.reservasService.createReserva(t)).subscribe({next:()=>{this.isSubmitting.set(!1);let n=this.isEditMode()?"Reserva actualizada correctamente":"Reserva creada correctamente";alert(n),this.router.navigate(["/admin/reservas"])},error:n=>{console.error("Error al guardar reserva:",n),this.isSubmitting.set(!1),alert("Error al guardar la reserva. Por favor, intente nuevamente.")}})}prepararDatos(){let t=this.reservaForm.value;return{usuario_id:t.usuario_id,codigo_reserva:t.codigo_reserva,estado:t.estado,notas:t.notas||"",servicios:t.servicios.map(e=>ce(Z({},e),{hora_inicio:this.formatearHora(e.hora_inicio),hora_fin:this.formatearHora(e.hora_fin)}))}}cancelar(){this.router.navigate(["/admin/reservas"])}generarNuevoCodigo(){this.reservaForm.patchValue({codigo_reserva:this.generarCodigoReserva()})}calcularTotal(){return this.reservaForm?this.serviciosArray.controls.reduce((t,e)=>{let n=e.get("precio")?.value||0,o=e.get("cantidad")?.value||1;return t+n*o},0):0}abrirModalUsuarios(){this.mostrarModalUsuarios.set(!0),this.busquedaUsuario="";let t=this.usuarios();this.usuariosBusqueda.set(t)}cerrarModalUsuarios(){this.mostrarModalUsuarios.set(!1),this.busquedaUsuario="",this.usuariosBusqueda.set([])}seleccionarUsuario(t){this.usuarioSeleccionado.set(t),this.reservaForm.patchValue({usuario_id:t.id}),this.cerrarModalUsuarios()}buscarUsuarios(){if(!this.busquedaUsuario.trim()){this.usuariosBusqueda.set(this.usuarios());return}this.cargandoUsuarios.set(!0),this.usersService.searchUsers(this.busquedaUsuario).subscribe({next:t=>{this.usuariosBusqueda.set(t),this.cargandoUsuarios.set(!1)},error:t=>{console.error("Error al buscar usuarios:",t),this.cargandoUsuarios.set(!1);let n=this.usuarios().filter(o=>o.name.toLowerCase().includes(this.busquedaUsuario.toLowerCase())||o.email.toLowerCase().includes(this.busquedaUsuario.toLowerCase()));this.usuariosBusqueda.set(n)}})}getRoleClass(t){return{admin:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",emprendedor:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",user:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",moderador:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300"}[t]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"}getRoleLabel(t){return{admin:"Admin",emprendedor:"Emprendedor",user:"Usuario",moderador:"Moderador"}[t]||t}trackByUsuario(t,e){return e.id??0}trackByServicioDisponible(t,e){return e.id}trackByServicio(t){return t}getEmprendedorNombre(t){let e=this.getServicioFormGroup(t).get("emprendedor_id")?.value;return e&&this.emprendedores().find(o=>o.id===e)?.nombre||""}horaFinInvalida(t){let e=this.getServicioFormGroup(t),n=e.get("hora_inicio")?.value,o=e.get("hora_fin")?.value;return!n||!o?!1:o<=n}hayServiciosNoDisponibles(){return Object.keys(this.disponibilidadVerificada).some(t=>{let e=parseInt(t);return this.disponibilidadVerificada[e]&&!this.servicioDisponible[e]})}numServiciosVerificados(){return Object.values(this.disponibilidadVerificada).filter(t=>t).length}reindexarDisponibilidad(t){let e={},n={},o={};Object.keys(this.verificandoDisponibilidad).forEach(l=>{let u=parseInt(l);u>t?(e[u-1]=this.verificandoDisponibilidad[u],n[u-1]=this.disponibilidadVerificada[u],o[u-1]=this.servicioDisponible[u]):u<t&&(e[u]=this.verificandoDisponibilidad[u],n[u]=this.disponibilidadVerificada[u],o[u]=this.servicioDisponible[u])}),this.verificandoDisponibilidad=e,this.disponibilidadVerificada=n,this.servicioDisponible=o}generarCodigoReserva(){let t=new Date,e=t.getFullYear().toString().substr(-2),n=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",u="";for(let h=0;h<6;h++)u+=l.charAt(Math.floor(Math.random()*l.length));return`RES-${e}${n}${o}-${u}`}sumarHoras(t,e){let[n,o]=t.split(":").map(Number),l=new Date;return l.setHours(n,o,0),l.setTime(l.getTime()+e*60*60*1e3),`${String(l.getHours()).padStart(2,"0")}:${String(l.getMinutes()).padStart(2,"0")}`}horaAMinutos(t){let[e,n]=t.split(":").map(Number);return e*60+n}formatearHora(t){if(!t)return"00:00:00";let e=t.split(":");for(;e.length<3;)e.push("00");return e.map(n=>n.padStart(2,"0")).join(":")}isDarkMode(){return this.themeService.isDarkMode()}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=H({type:s,selectors:[["app-reserva-form"]],decls:4,vars:4,consts:[[3,"title","subtitle"],[1,"container","mx-auto","px-2","sm:px-4","py-6","bg-gray-50","dark:bg-gray-900","min-h-screen","transition-colors","duration-200"],["class","text-center py-8",4,"ngIf"],[4,"ngIf"],[1,"text-center","py-8"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-primary-600","mx-auto"],[1,"mt-2","text-gray-600","dark:text-gray-400"],[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"bg-white","dark:bg-gray-800","rounded-lg","shadow-sm","overflow-hidden","transition-colors","duration-200"],[1,"px-6","py-4","border-b","border-gray-200","dark:border-gray-700"],[1,"text-lg","font-medium","text-gray-900","dark:text-white"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"p-6","space-y-6"],[1,"grid","grid-cols-1","gap-y-6","gap-x-4","sm:grid-cols-6"],[1,"sm:col-span-3"],["for","usuario_seleccionado",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],[1,"mt-1","flex"],["type","text","id","usuario_seleccionado","readonly","","placeholder","Seleccionar cliente...",1,"block","w-full","rounded-l-md","border-gray-300","dark:border-gray-600","dark:bg-gray-700","dark:text-gray-200","bg-gray-50","dark:bg-gray-600","text-gray-500","dark:text-gray-400","shadow-sm","sm:text-sm",3,"value"],["type","button",1,"inline-flex","items-center","rounded-r-md","border","border-l-0","border-gray-300","dark:border-gray-600","bg-gray-50","dark:bg-gray-700","px-3","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-200","hover:bg-gray-100","dark:hover:bg-gray-600","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["class","mt-2 text-sm text-red-600 dark:text-red-400",4,"ngIf"],["for","codigo_reserva",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],[1,"mt-1"],["type","text","id","codigo_reserva","formControlName","codigo_reserva",1,"block","w-full","rounded-md","border-gray-300","dark:border-gray-600","dark:bg-gray-700","dark:text-gray-200","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200",3,"readonly"],[1,"sm:col-span-2"],["for","estado",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","estado","formControlName","estado",1,"block","w-full","rounded-md","border-gray-300","dark:border-gray-600","dark:bg-gray-700","dark:text-gray-200","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],["value","pendiente"],["value","confirmada"],["value","cancelada"],["value","completada"],["class","sm:col-span-1 flex items-end",4,"ngIf"],[1,"sm:col-span-6"],["for","notas",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","notas","formControlName","notas","rows","3","placeholder","Notas adicionales sobre la reserva...",1,"block","w-full","rounded-md","border-gray-300","dark:border-gray-600","dark:bg-gray-700","dark:text-gray-200","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200"],[1,"px-6","py-4","border-b","border-gray-200","dark:border-gray-700","flex","justify-between","items-center"],["type","button",1,"inline-flex","items-center","rounded-md","bg-primary-600","px-3","py-1.5","text-sm","font-medium","text-white","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-0.5","mr-1.5","h-4","w-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],["class","p-8 text-center",4,"ngIf"],["class","divide-y divide-gray-200 dark:divide-gray-700",4,"ngIf"],["class","bg-gray-50 dark:bg-gray-900 px-6 py-4 border-t border-gray-200 dark:border-gray-700",4,"ngIf"],[1,"px-6","py-4","flex","justify-end","space-x-3"],["type","button",1,"inline-flex","items-center","rounded-md","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","px-4","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-200","shadow-sm","hover:bg-gray-50","dark:hover:bg-gray-600","transition-colors","duration-200",3,"click"],["type","submit",1,"inline-flex","items-center","rounded-md","bg-primary-600","px-4","py-2","text-sm","font-medium","text-white","shadow-sm","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors","duration-200",3,"disabled"],["class","animate-spin -ml-1 mr-2 h-4 w-4 text-white","fill","none","viewBox","0 0 24 24",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",4,"ngIf"],[1,"mt-2","text-sm","text-red-600","dark:text-red-400"],[1,"sm:col-span-1","flex","items-end"],["type","button","title","Generar nuevo c\xF3digo",1,"inline-flex","items-center","rounded-md","bg-gray-100","dark:bg-gray-700","px-3","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-200","hover:bg-gray-200","dark:hover:bg-gray-600","transition-colors","duration-200",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"p-8","text-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"],[1,"mt-2","text-sm","font-medium","text-gray-900","dark:text-white"],[1,"mt-1","text-sm","text-gray-500","dark:text-gray-400"],[1,"mt-6"],["type","button",1,"inline-flex","items-center","rounded-md","bg-primary-600","px-4","py-2","text-sm","font-medium","text-white","hover:bg-primary-700",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],[1,"divide-y","divide-gray-200","dark:divide-gray-700"],["class","p-6 space-y-6",3,"formGroup",4,"ngFor","ngForOf","ngForTrackBy"],[1,"p-6","space-y-6",3,"formGroup"],[1,"flex","justify-between","items-center"],[1,"text-md","font-medium","text-gray-900","dark:text-white"],["type","button","title","Eliminar servicio",1,"text-red-600","dark:text-red-400","hover:text-red-800","dark:hover:text-red-300","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300",3,"for"],["formControlName","servicio_id",1,"block","w-full","rounded-md","border-gray-300","dark:border-gray-600","dark:bg-gray-700","dark:text-gray-200","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200",3,"change","id"],["value",""],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],["type","text","readonly","","placeholder","Se asigna autom\xE1ticamente",1,"block","w-full","rounded-md","border-gray-300","dark:border-gray-600","bg-gray-50","dark:bg-gray-600","text-gray-500","dark:text-gray-400","shadow-sm","sm:text-sm",3,"id","value"],["type","date","formControlName","fecha_inicio",1,"block","w-full","rounded-md","border-gray-300","dark:border-gray-600","dark:bg-gray-700","dark:text-gray-200","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200",3,"change","id"],["type","date","formControlName","fecha_fin",1,"block","w-full","rounded-md","border-gray-300","dark:border-gray-600","dark:bg-gray-700","dark:text-gray-200","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200",3,"change","id","min"],["formControlName","estado",1,"block","w-full","rounded-md","border-gray-300","dark:border-gray-600","dark:bg-gray-700","dark:text-gray-200","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200",3,"id"],["value","confirmado"],["value","cancelado"],["value","completado"],["type","time","formControlName","hora_inicio",1,"block","w-full","rounded-md","border-gray-300","dark:border-gray-600","dark:bg-gray-700","dark:text-gray-200","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200",3,"change","id"],["type","time","formControlName","hora_fin",1,"block","w-full","rounded-md","border-gray-300","dark:border-gray-600","dark:bg-gray-700","dark:text-gray-200","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200",3,"change","id"],["type","number","formControlName","duracion_minutos","readonly","",1,"block","w-full","rounded-md","border-gray-300","dark:border-gray-600","bg-gray-50","dark:bg-gray-600","text-gray-500","dark:text-gray-400","shadow-sm","sm:text-sm",3,"id"],["type","number","formControlName","cantidad","min","1",1,"block","w-full","rounded-md","border-gray-300","dark:border-gray-600","dark:bg-gray-700","dark:text-gray-200","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200",3,"id"],["type","number","formControlName","precio","min","0","step","0.01",1,"block","w-full","rounded-md","border-gray-300","dark:border-gray-600","dark:bg-gray-700","dark:text-gray-200","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200",3,"id"],["formControlName","notas_cliente","rows","2","placeholder","Notas o solicitudes especiales...",1,"block","w-full","rounded-md","border-gray-300","dark:border-gray-600","dark:bg-gray-700","dark:text-gray-200","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200",3,"id"],["formControlName","notas_emprendedor","rows","2","placeholder","Notas internas del emprendedor...",1,"block","w-full","rounded-md","border-gray-300","dark:border-gray-600","dark:bg-gray-700","dark:text-gray-200","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","transition-colors","duration-200",3,"id"],["class","flex items-center text-gray-500 dark:text-gray-400",4,"ngIf"],[3,"value"],[1,"flex","items-center","text-gray-500","dark:text-gray-400"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-2","h-4","w-4","text-primary-500"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],["class","flex items-center text-green-600 dark:text-green-400",4,"ngIf"],["class","flex items-center text-red-600 dark:text-red-400",4,"ngIf"],[1,"flex","items-center","text-green-600","dark:text-green-400"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"flex","items-center","text-red-600","dark:text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"bg-gray-50","dark:bg-gray-900","px-6","py-4","border-t","border-gray-200","dark:border-gray-700"],[1,"text-sm","font-medium","text-gray-900","dark:text-white"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-2","h-4","w-4","text-white"],[1,"fixed","inset-0","bg-black","bg-opacity-50","z-50","flex","items-center","justify-center","p-4"],[1,"bg-white","dark:bg-gray-800","rounded-lg","max-w-2xl","w-full","max-h-[80vh]","overflow-hidden","transition-colors","duration-200"],[1,"text-gray-400","hover:text-gray-600","dark:hover:text-gray-300","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-4","border-b","border-gray-200","dark:border-gray-700"],[1,"relative"],["type","text","placeholder","Buscar por nombre o email...",1,"w-full","pl-10","pr-4","py-2","border","border-gray-300","dark:border-gray-600","rounded-md","focus:ring-primary-500","focus:border-primary-500","dark:bg-gray-700","dark:text-white","transition-colors","duration-200",3,"ngModelChange","ngModel"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"absolute","left-3","top-2.5","h-5","w-5","text-gray-400"],[1,"overflow-y-auto","max-h-96"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-primary-600","mx-auto"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],["class","p-4 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-colors duration-200",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"p-4","hover:bg-gray-50","dark:hover:bg-gray-700","cursor-pointer","transition-colors","duration-200",3,"click"],[1,"flex","items-center","space-x-4"],[1,"flex-shrink-0"],["class","h-10 w-10 rounded-full object-cover",3,"src","alt",4,"ngIf"],["class","h-10 w-10 rounded-full bg-gray-300 dark:bg-gray-600 flex items-center justify-center",4,"ngIf"],[1,"flex-1","min-w-0"],[1,"text-sm","font-medium","text-gray-900","dark:text-white","truncate"],[1,"text-sm","text-gray-500","dark:text-gray-400","truncate"],[1,"flex","items-center","mt-1","space-x-4","text-xs","text-gray-500","dark:text-gray-400"],[1,"flex","flex-wrap","gap-1"],["class","inline-flex rounded-full px-2 py-1 text-xs font-medium",3,"class",4,"ngFor","ngForOf"],[1,"h-10","w-10","rounded-full","object-cover",3,"src","alt"],[1,"h-10","w-10","rounded-full","bg-gray-300","dark:bg-gray-600","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-gray-500","dark:text-gray-400"],[1,"inline-flex","rounded-full","px-2","py-1","text-xs","font-medium"]],template:function(e,n){e&1&&(p(0,"app-admin-header",0),i(1,"div",1),f(2,mt,4,1,"div",2)(3,Ot,66,17,"div",3),r()),e&2&&(m("title",(n.isEditMode()?"Editar":"Crear")+" Reserva")("subtitle",n.isEditMode()?"Actualice la informaci\xF3n de la reserva":"Complete el formulario para crear una nueva reserva"),d(2),m("ngIf",n.loading()),d(),m("ngIf",!n.loading()))},dependencies:[j,O,G,Ue,Ge,K,Q,q,fe,J,W,Oe,he,Ne,$e,B,Y,z],encapsulation:2})};var Je=s=>["/admin/reservas/edit",s];function Gt(s,t){s&1&&(i(0,"div",6),p(1,"div",7),i(2,"p",8),a(3,"Cargando informaci\xF3n de la reserva..."),r()())}function Nt(s,t){s&1&&(i(0,"div",9)(1,"div",10),b(),i(2,"svg",11),p(3,"path",12),r(),y(),i(4,"h3",13),a(5,"Reserva no encontrada"),r(),i(6,"p",14),a(7," La reserva que est\xE1s buscando no existe o ha sido eliminada. "),r(),i(8,"div",15)(9,"a",16),a(10," Volver a la lista de reservas "),r()()()())}function $t(s,t){if(s&1&&(i(0,"span",75),a(1),r()),s&2){let e,n=c(2);d(),x(" ",(e=n.reserva().usuario)==null?null:e.email," ")}}function zt(s,t){if(s&1&&(i(0,"span",75),a(1),r()),s&2){let e,n=c(2);d(),x(" ",(e=n.reserva().usuario)==null?null:e.phone," ")}}function Ut(s,t){if(s&1){let e=C();i(0,"div",76)(1,"div",77)(2,"button",78),_("click",function(){v(e);let o=c(2);return g(o.cambiarEstado("pendiente"))}),a(3," Pendiente "),r(),i(4,"button",78),_("click",function(){v(e);let o=c(2);return g(o.cambiarEstado("confirmada"))}),a(5," Confirmada "),r(),i(6,"button",78),_("click",function(){v(e);let o=c(2);return g(o.cambiarEstado("cancelada"))}),a(7," Cancelada "),r(),i(8,"button",78),_("click",function(){v(e);let o=c(2);return g(o.cambiarEstado("completada"))}),a(9," Completada "),r()()()}if(s&2){let e=c(2);d(2),V("opacity-50",e.reserva().estado==="pendiente")("cursor-not-allowed",e.reserva().estado==="pendiente"),m("disabled",e.reserva().estado==="pendiente"),d(2),V("opacity-50",e.reserva().estado==="confirmada")("cursor-not-allowed",e.reserva().estado==="confirmada"),m("disabled",e.reserva().estado==="confirmada"),d(2),V("opacity-50",e.reserva().estado==="cancelada")("cursor-not-allowed",e.reserva().estado==="cancelada"),m("disabled",e.reserva().estado==="cancelada"),d(2),V("opacity-50",e.reserva().estado==="completada")("cursor-not-allowed",e.reserva().estado==="completada"),m("disabled",e.reserva().estado==="completada")}}function qt(s,t){if(s&1&&(i(0,"div",79)(1,"h3",80),a(2,"Notas Generales"),r(),i(3,"p",81),a(4),r()()),s&2){let e=c(2);d(4),k(e.reserva().notas)}}function Wt(s,t){if(s&1&&(i(0,"div",52)(1,"dt",33),a(2,"Total Estimado"),r(),i(3,"dd",53),a(4),r()()),s&2){let e=c(2);d(4),x("S/ ",e.totalReserva().toFixed(2),"")}}function Yt(s,t){if(s&1&&(i(0,"div",82)(1,"span",83),a(2),r(),i(3,"span",71),a(4),r()()),s&2){let e=t.$implicit,n=c(2);d(2),x("",n.getEstadoServicioTexto(e.estado),":"),d(2),k(e.cantidad)}}function Jt(s,t){if(s&1&&(i(0,"div",84),b(),i(1,"svg",11),p(2,"path",85),r(),y(),i(3,"h3",13),a(4,"No hay servicios reservados"),r(),i(5,"div",15)(6,"a",86),b(),i(7,"svg",24),p(8,"path",87),r(),a(9," A\xF1adir servicios "),r()()()),s&2){let e=c(2);d(6),m("routerLink",L(1,Je,e.reserva().id))}}function Kt(s,t){if(s&1&&(i(0,"div",109),a(1),r()),s&2){let e=c().$implicit;d(),x(" ",e.servicio==null?null:e.servicio.descripcion," ")}}function Qt(s,t){if(s&1&&(i(0,"div",103),a(1),r()),s&2){let e=c().$implicit;d(),x(" ",e.emprendedor==null?null:e.emprendedor.telefono," ")}}function Xt(s,t){if(s&1&&(i(0,"div",103),a(1),r()),s&2){let e=c().$implicit,n=c(3);d(),x(" hasta ",n.formatearFecha(e.fecha_fin)," ")}}function Zt(s,t){if(s&1&&(i(0,"div",103),a(1),r()),s&2){let e=c().$implicit;d(),x(" ",e.cantidad," unidades ")}}function ei(s,t){if(s&1){let e=C();i(0,"div",76)(1,"div",77)(2,"button",78),_("click",function(){v(e);let o=c().$implicit,l=c(3);return g(l.cambiarEstadoServicio(o,"pendiente"))}),a(3," Pendiente "),r(),i(4,"button",78),_("click",function(){v(e);let o=c().$implicit,l=c(3);return g(l.cambiarEstadoServicio(o,"confirmado"))}),a(5," Confirmado "),r(),i(6,"button",78),_("click",function(){v(e);let o=c().$implicit,l=c(3);return g(l.cambiarEstadoServicio(o,"cancelado"))}),a(7," Cancelado "),r(),i(8,"button",78),_("click",function(){v(e);let o=c().$implicit,l=c(3);return g(l.cambiarEstadoServicio(o,"completado"))}),a(9," Completado "),r()()()}if(s&2){let e=c().$implicit;d(2),V("opacity-50",e.estado==="pendiente")("cursor-not-allowed",e.estado==="pendiente"),m("disabled",e.estado==="pendiente"),d(2),V("opacity-50",e.estado==="confirmado")("cursor-not-allowed",e.estado==="confirmado"),m("disabled",e.estado==="confirmado"),d(2),V("opacity-50",e.estado==="cancelado")("cursor-not-allowed",e.estado==="cancelado"),m("disabled",e.estado==="cancelado"),d(2),V("opacity-50",e.estado==="completado")("cursor-not-allowed",e.estado==="completado"),m("disabled",e.estado==="completado")}}function ti(s,t){if(s&1){let e=C();i(0,"tr",97)(1,"td",98)(2,"div",99),a(3),r(),f(4,Kt,2,1,"div",100),r(),i(5,"td",98)(6,"div",101),a(7),r(),f(8,Qt,2,1,"div",102),r(),i(9,"td",98)(10,"div",101),a(11),r(),f(12,Xt,2,1,"div",102),r(),i(13,"td",98)(14,"div",101),a(15),r(),i(16,"div",103),a(17),r()(),i(18,"td",98)(19,"span",37),a(20),r()(),i(21,"td",104)(22,"div",105),a(23),r(),f(24,Zt,2,1,"div",102),r(),i(25,"td",104)(26,"div",106)(27,"button",107),_("click",function(o){let l=v(e).$implicit,u=c(3);return g(u.toggleServicioEstadoMenu(l,o))}),b(),i(28,"svg",40),p(29,"path",108),r()(),f(30,ei,10,20,"div",42),r()()()}if(s&2){let e,n=t.$implicit,o=c(3);d(3),x(" ",(n.servicio==null?null:n.servicio.nombre)||"Servicio no disponible"," "),d(),m("ngIf",n.servicio==null?null:n.servicio.descripcion),d(3),x(" ",(n.emprendedor==null?null:n.emprendedor.nombre)||"Emprendedor no disponible"," "),d(),m("ngIf",n.emprendedor==null?null:n.emprendedor.telefono),d(3),k(o.formatearFecha(n.fecha_inicio)),d(),m("ngIf",n.fecha_fin&&n.fecha_inicio!==n.fecha_fin),d(3),D(" ",o.formatearHora(n.hora_inicio)," - ",o.formatearHora(n.hora_fin)," "),d(2),x(" ",n.duracion_minutos," min. "),d(2),F(o.getEstadoServicioClasse(n.estado)),d(),x(" ",o.getEstadoServicioTexto(n.estado)," "),d(3),x("S/ ",(n.precio||0).toFixed(2),""),d(),m("ngIf",n.cantidad&&n.cantidad>1),d(6),m("ngIf",o.servicioEstadoMenuOpen()&&((e=o.servicioSeleccionado())==null?null:e.id)===n.id)}}function ii(s,t){if(s&1&&(i(0,"div",88)(1,"table",89)(2,"thead",90)(3,"tr")(4,"th",91),a(5,"Servicio"),r(),i(6,"th",91),a(7,"Emprendedor"),r(),i(8,"th",91),a(9,"Fecha"),r(),i(10,"th",91),a(11,"Horario"),r(),i(12,"th",91),a(13,"Estado"),r(),i(14,"th",92),a(15,"Precio"),r(),i(16,"th",92),a(17,"Acciones"),r()()(),i(18,"tbody",93),f(19,ti,31,15,"tr",94),r(),i(20,"tfoot",90)(21,"tr")(22,"td",95),a(23,"Total:"),r(),i(24,"td",96),a(25),r(),p(26,"td"),r()()()()),s&2){let e=c(2);d(19),m("ngForOf",e.reserva().servicios)("ngForTrackBy",e.trackByServicio),d(6),x("S/ ",e.totalReserva().toFixed(2),"")}}function ri(s,t){if(s&1&&(i(0,"div",118)(1,"span",119),a(2,"Cliente:"),r(),a(3),r()),s&2){let e=c(2).$implicit;d(3),x(" ",e.notas_cliente," ")}}function ni(s,t){if(s&1&&(i(0,"div",120)(1,"span",119),a(2,"Emprendedor:"),r(),a(3),r()),s&2){let e=c(2).$implicit;d(3),x(" ",e.notas_emprendedor," ")}}function ai(s,t){if(s&1&&(i(0,"div")(1,"h4",115),a(2),r(),f(3,ri,4,1,"div",116)(4,ni,4,1,"div",117),r()),s&2){let e=c().$implicit;d(2),k(e.servicio==null?null:e.servicio.nombre),d(),m("ngIf",e.notas_cliente),d(),m("ngIf",e.notas_emprendedor)}}function oi(s,t){if(s&1&&(i(0,"div",113),f(1,ai,5,3,"div",114),r()),s&2){let e=t.$implicit;d(),m("ngIf",e.notas_cliente||e.notas_emprendedor)}}function si(s,t){if(s&1&&(i(0,"div",110)(1,"h3",111),a(2,"Notas de Servicios"),r(),i(3,"div",51),f(4,oi,2,1,"div",112),r()()),s&2){let e=c(2);d(4),m("ngForOf",e.reserva().servicios)}}function di(s,t){if(s&1){let e=C();i(0,"div",17)(1,"div",18)(2,"div",19)(3,"div")(4,"h2",20),a(5,"Informaci\xF3n de la Reserva"),r(),i(6,"p",21),a(7),r()(),i(8,"div",22)(9,"a",23),b(),i(10,"svg",24),p(11,"path",25),r(),a(12," Editar "),r(),y(),i(13,"a",26),b(),i(14,"svg",27),p(15,"path",28),r(),a(16," Volver "),r()()(),y(),i(17,"div",29)(18,"div",30)(19,"div",31)(20,"div",32)(21,"div")(22,"h3",33),a(23,"Cliente"),r(),i(24,"p",34),a(25),f(26,$t,2,1,"span",35)(27,zt,2,1,"span",35),r()(),i(28,"div")(29,"h3",33),a(30,"Estado"),r(),i(31,"div",36)(32,"span",37),a(33),r(),i(34,"div",38)(35,"button",39),_("click",function(o){v(e);let l=c();return g(l.toggleEstadoMenu(o))}),b(),i(36,"svg",40),p(37,"path",41),r()(),f(38,Ut,10,20,"div",42),r()()(),y(),i(39,"div")(40,"h3",33),a(41,"Fecha de Reserva"),r(),i(42,"p",34),a(43),r()(),i(44,"div")(45,"h3",33),a(46,"\xDAltima Actualizaci\xF3n"),r(),i(47,"p",34),a(48),r()()(),f(49,qt,5,1,"div",43),i(50,"div",22)(51,"button",44),_("click",function(){v(e);let o=c();return g(o.imprimirReserva())}),b(),i(52,"svg",45),p(53,"path",46),r(),a(54," Imprimir "),r(),y(),i(55,"button",47),_("click",function(){v(e);let o=c();return g(o.mostrarConfirmacionEliminacion.set(!0))}),b(),i(56,"svg",45),p(57,"path",48),r(),a(58," Eliminar "),r()()(),y(),i(59,"div",49)(60,"h3",50),a(61,"Resumen"),r(),i(62,"div",51)(63,"div",52)(64,"dt",33),a(65,"Total de Servicios"),r(),i(66,"dd",53),a(67),r()(),f(68,Wt,5,1,"div",54),i(69,"div",52)(70,"dt",33),a(71,"Estados de Servicios"),r(),i(72,"dd",55),f(73,Yt,5,2,"div",56),r()()()()()()(),i(74,"div",57)(75,"div",58)(76,"h2",20),a(77,"Servicios Reservados"),r()(),f(78,Jt,10,3,"div",59)(79,ii,27,3,"div",60)(80,si,5,1,"div",61),r(),i(81,"div",57)(82,"div",58)(83,"h2",20),a(84,"Historial de Cambios"),r()(),i(85,"div",29)(86,"div",62)(87,"ul",63)(88,"li")(89,"div",64),p(90,"span",65),i(91,"div",66)(92,"div")(93,"span",67),b(),i(94,"svg",68),p(95,"path",69),r()()(),y(),i(96,"div",70)(97,"div")(98,"p",21),a(99,"Reserva creada con estado "),i(100,"span",71),a(101),r()()(),i(102,"div",72),a(103),r()()()()(),i(104,"li")(105,"div",64)(106,"div",66)(107,"div")(108,"span",73),b(),i(109,"svg",68),p(110,"path",74),r()()(),y(),i(111,"div",70)(112,"div")(113,"p",21),a(114,"Estado actual "),i(115,"span",71),a(116),r()()(),i(117,"div",72),a(118),r()()()()()()()()()()}if(s&2){let e,n,o,l,u=c();d(7),x("C\xF3digo: ",u.reserva().codigo_reserva,""),d(2),m("routerLink",L(22,Je,u.reserva().id)),d(16),x(" ",((e=u.reserva().usuario)==null?null:e.name)||"Cliente no registrado"," "),d(),m("ngIf",(n=u.reserva().usuario)==null?null:n.email),d(),m("ngIf",(o=u.reserva().usuario)==null?null:o.phone),d(5),F(u.getEstadoClasse(u.reserva().estado)),d(),x(" ",u.getEstadoTexto(u.reserva().estado)," "),d(5),m("ngIf",u.estadoMenuOpen()),d(5),k(u.formatearFecha(u.reserva().created_at)),d(5),k(u.formatearFecha(u.reserva().updated_at)),d(),m("ngIf",u.reserva().notas),d(18),k(((l=u.reserva().servicios)==null?null:l.length)||0),d(),m("ngIf",u.totalReserva()>0),d(5),m("ngForOf",u.estadosServicios()),d(5),m("ngIf",!u.reserva().servicios||u.reserva().servicios.length===0),d(),m("ngIf",u.reserva().servicios&&u.reserva().servicios.length>0),d(),m("ngIf",u.reserva().servicios&&u.tieneNotasServicios()),d(21),k(u.getEstadoTexto(u.reserva().estado)),d(2),x(" ",u.formatearFecha(u.reserva().created_at)," "),d(13),k(u.getEstadoTexto(u.reserva().estado)),d(2),x(" ",u.formatearFecha(u.reserva().updated_at)," ")}}function li(s,t){s&1&&(i(0,"span"),a(1,"Eliminar"),r())}function ci(s,t){s&1&&(i(0,"span",134),b(),i(1,"svg",135),p(2,"circle",136)(3,"path",137),r(),a(4," Eliminando... "),r())}function mi(s,t){if(s&1){let e=C();i(0,"div",121)(1,"div",122)(2,"div",123)(3,"div",124),b(),i(4,"svg",125),p(5,"path",126),r()(),y(),i(6,"div",127)(7,"h3",128),a(8,"Eliminar Reserva"),r(),i(9,"div",129)(10,"p",21),a(11," \xBFEst\xE1s seguro de que deseas eliminar esta reserva? Esta acci\xF3n no se puede deshacer. "),r()()()(),i(12,"div",130)(13,"button",131),_("click",function(){v(e);let o=c();return g(o.eliminarReserva())}),f(14,li,2,0,"span",114)(15,ci,5,0,"span",132),r(),i(16,"button",133),_("click",function(){v(e);let o=c();return g(o.mostrarConfirmacionEliminacion.set(!1))}),a(17," Cancelar "),r()()()()}if(s&2){let e=c();d(13),m("disabled",e.eliminandoReserva()),d(),m("ngIf",!e.eliminandoReserva()),d(),m("ngIf",e.eliminandoReserva()),d(),m("disabled",e.eliminandoReserva())}}var ke=class s{reservasService=w(X);route=w(ie);router=w(re);themeService=w($);loading=S(!1);reserva=S(null);estadoMenuOpen=S(!1);servicioEstadoMenuOpen=S(!1);servicioSeleccionado=S(null);mostrarConfirmacionEliminacion=S(!1);eliminandoReserva=S(!1);totalReserva=U(()=>{let t=this.reserva();return t?.servicios?t.servicios.reduce((e,n)=>e+(n.precio||0)*(n.cantidad||1),0):0});estadosServicios=U(()=>{let t=this.reserva();if(!t?.servicios)return[];let e={};return t.servicios.forEach(n=>{e[n.estado]=(e[n.estado]||0)+1}),Object.entries(e).map(([n,o])=>({estado:n,cantidad:o}))});reservaId=0;ngOnInit(){let t=this.route.snapshot.paramMap.get("id");t?(this.reservaId=+t,this.cargarReserva()):this.loading.set(!1),document.addEventListener("click",this.cerrarMenus.bind(this))}ngOnDestroy(){document.removeEventListener("click",this.cerrarMenus.bind(this))}cerrarMenus(){this.estadoMenuOpen.set(!1),this.servicioEstadoMenuOpen.set(!1),this.servicioSeleccionado.set(null)}cargarReserva(){this.loading.set(!0),this.reservasService.getReserva(this.reservaId).subscribe({next:t=>{this.reserva.set(t),this.loading.set(!1)},error:t=>{console.error("Error al cargar la reserva:",t),this.loading.set(!1)}})}toggleEstadoMenu(t){t.stopPropagation(),this.estadoMenuOpen.set(!this.estadoMenuOpen()),this.servicioEstadoMenuOpen.set(!1),this.servicioSeleccionado.set(null)}toggleServicioEstadoMenu(t,e){e.stopPropagation(),this.servicioEstadoMenuOpen()&&this.servicioSeleccionado()?.id===t.id?(this.servicioEstadoMenuOpen.set(!1),this.servicioSeleccionado.set(null)):(this.servicioEstadoMenuOpen.set(!0),this.servicioSeleccionado.set(t),this.estadoMenuOpen.set(!1))}cambiarEstado(t){let e=this.reserva();!e?.id||e.estado===t||(this.estadoMenuOpen.set(!1),this.reservasService.cambiarEstadoReserva(e.id,t).subscribe({next:n=>{this.reserva.set(n)},error:n=>{console.error("Error al cambiar el estado de la reserva:",n),alert("Error al cambiar el estado de la reserva. Por favor, intente nuevamente.")}}))}cambiarEstadoServicio(t,e){!t.id||t.estado===e||(this.servicioEstadoMenuOpen.set(!1),this.servicioSeleccionado.set(null),this.reservasService.cambiarEstadoServicioReserva(t.id,e).subscribe({next:n=>{let o=this.reserva();if(o?.servicios){let l=o.servicios.findIndex(u=>u.id===t.id);l!==-1&&(o.servicios[l]=n,this.reserva.set(Z({},o)))}},error:n=>{console.error("Error al cambiar el estado del servicio:",n),alert("Error al cambiar el estado del servicio. Por favor, intente nuevamente.")}}))}eliminarReserva(){let t=this.reserva();t?.id&&(this.eliminandoReserva.set(!0),this.reservasService.deleteReserva(t.id).subscribe({next:()=>{this.mostrarConfirmacionEliminacion.set(!1),this.eliminandoReserva.set(!1),this.router.navigate(["/admin/reservas"])},error:e=>{console.error("Error al eliminar la reserva:",e),this.eliminandoReserva.set(!1),alert("Error al eliminar la reserva. Por favor, intente nuevamente.")}}))}imprimirReserva(){window.print()}tieneNotasServicios(){let t=this.reserva();return t?.servicios?t.servicios.some(e=>e.notas_cliente||e.notas_emprendedor):!1}trackByServicio(t,e){return e.id||t}formatearFecha(t){return new Date(t).toLocaleDateString("es-PE",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}formatearHora(t){return t?t.substring(0,5):"N/A"}getEstadoClasse(t){return{pendiente:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",confirmada:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",completada:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",cancelada:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"}[t]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"}getEstadoTexto(t){return{pendiente:"Pendiente",confirmada:"Confirmada",completada:"Completada",cancelada:"Cancelada"}[t]||t}getEstadoServicioClasse(t){return{pendiente:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",confirmado:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",completado:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",cancelado:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"}[t]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"}getEstadoServicioTexto(t){return{pendiente:"Pendiente",confirmado:"Confirmado",completado:"Completado",cancelado:"Cancelado"}[t]||t}isDarkMode(){return this.themeService.isDarkMode()}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=H({type:s,selectors:[["app-reserva-detail"]],decls:6,vars:5,consts:[["subtitle","Informaci\xF3n completa de la reserva",3,"title"],[1,"container","mx-auto","px-2","sm:px-4","py-6","bg-gray-50","dark:bg-gray-900","min-h-screen","transition-colors","duration-200"],["class","text-center py-8",4,"ngIf"],["class","rounded-lg bg-white dark:bg-gray-800 p-6 shadow-sm",4,"ngIf"],["class","space-y-6",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",4,"ngIf"],[1,"text-center","py-8"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-primary-600","mx-auto"],[1,"mt-2","text-gray-600","dark:text-gray-400"],[1,"rounded-lg","bg-white","dark:bg-gray-800","p-6","shadow-sm"],[1,"text-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"mt-2","text-sm","font-medium","text-gray-900","dark:text-white"],[1,"mt-1","text-sm","text-gray-500","dark:text-gray-400"],[1,"mt-6"],["routerLink","/admin/reservas",1,"inline-flex","items-center","rounded-md","bg-primary-600","px-4","py-2","text-sm","font-medium","text-white","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2"],[1,"space-y-6"],[1,"bg-white","dark:bg-gray-800","rounded-lg","shadow-sm","transition-colors","duration-200"],[1,"px-6","py-4","border-b","border-gray-200","dark:border-gray-700","flex","justify-between","items-center"],[1,"text-lg","font-medium","text-gray-900","dark:text-white"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"flex","space-x-3"],[1,"inline-flex","items-center","rounded-md","bg-white","dark:bg-gray-700","px-4","py-2","text-sm","font-medium","text-primary-600","dark:text-primary-400","shadow-sm","ring-1","ring-inset","ring-gray-300","dark:ring-gray-600","hover:bg-gray-50","dark:hover:bg-gray-600","transition-colors","duration-200",3,"routerLink"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["routerLink","/admin/reservas",1,"inline-flex","items-center","rounded-md","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","px-4","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-200","shadow-sm","hover:bg-gray-50","dark:hover:bg-gray-600","transition-colors","duration-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5","text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"p-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],[1,"md:col-span-2"],[1,"grid","grid-cols-1","gap-4","sm:grid-cols-2","mb-6"],[1,"text-sm","font-medium","text-gray-500","dark:text-gray-400"],[1,"mt-1","text-sm","text-gray-900","dark:text-white"],["class","block text-xs text-gray-500 dark:text-gray-400",4,"ngIf"],[1,"mt-1","flex","items-center"],[1,"inline-flex","rounded-full","px-2.5","py-1","text-xs","font-medium"],[1,"relative","ml-2"],["title","Cambiar estado",1,"text-gray-500","dark:text-gray-400","hover:text-gray-700","dark:hover:text-gray-300","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["class","origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white dark:bg-gray-800 ring-1 ring-black ring-opacity-5 dark:ring-gray-700 focus:outline-none z-10 transition-colors duration-200",4,"ngIf"],["class","mb-6",4,"ngIf"],[1,"inline-flex","items-center","rounded-md","bg-white","dark:bg-gray-700","px-3","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-200","shadow-sm","ring-1","ring-inset","ring-gray-300","dark:ring-gray-600","hover:bg-gray-50","dark:hover:bg-gray-600","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-0.5","mr-1.5","h-4","w-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"],[1,"inline-flex","items-center","rounded-md","bg-red-100","dark:bg-red-900","px-3","py-2","text-sm","font-medium","text-red-700","dark:text-red-300","hover:bg-red-200","dark:hover:bg-red-800","transition-colors","duration-200",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"bg-gray-50","dark:bg-gray-700","p-4","rounded-lg","transition-colors","duration-200"],[1,"text-sm","font-medium","text-gray-500","dark:text-gray-400","uppercase","tracking-wider","mb-4"],[1,"space-y-4"],[1,"bg-white","dark:bg-gray-800","rounded-lg","p-4","shadow-sm","transition-colors","duration-200"],[1,"mt-1","text-2xl","font-semibold","text-gray-900","dark:text-white"],["class","bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm transition-colors duration-200",4,"ngIf"],[1,"mt-1","space-y-1"],["class","flex justify-between text-sm",4,"ngFor","ngForOf"],[1,"bg-white","dark:bg-gray-800","rounded-lg","shadow-sm","overflow-hidden","transition-colors","duration-200"],[1,"px-6","py-4","border-b","border-gray-200","dark:border-gray-700"],["class","p-8 text-center",4,"ngIf"],["class","overflow-x-auto",4,"ngIf"],["class","border-t border-gray-200 dark:border-gray-700 p-6",4,"ngIf"],[1,"flow-root"],[1,"-mb-8"],[1,"relative","pb-8"],["aria-hidden","true",1,"absolute","top-4","left-4","-ml-px","h-full","w-0.5","bg-gray-200","dark:bg-gray-600"],[1,"relative","flex","space-x-3"],[1,"h-8","w-8","rounded-full","bg-green-500","flex","items-center","justify-center","ring-8","ring-white","dark:ring-gray-800"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"min-w-0","flex-1","pt-1.5","flex","justify-between","space-x-4"],[1,"font-medium","text-gray-900","dark:text-white"],[1,"text-right","text-sm","whitespace-nowrap","text-gray-500","dark:text-gray-400"],[1,"h-8","w-8","rounded-full","bg-blue-500","flex","items-center","justify-center","ring-8","ring-white","dark:ring-gray-800"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"block","text-xs","text-gray-500","dark:text-gray-400"],[1,"origin-top-right","absolute","right-0","mt-2","w-48","rounded-md","shadow-lg","bg-white","dark:bg-gray-800","ring-1","ring-black","ring-opacity-5","dark:ring-gray-700","focus:outline-none","z-10","transition-colors","duration-200"],[1,"py-1"],[1,"text-gray-700","dark:text-gray-300","block","px-4","py-2","text-sm","hover:bg-gray-100","dark:hover:bg-gray-700","w-full","text-left","transition-colors","duration-200",3,"click","disabled"],[1,"mb-6"],[1,"text-sm","font-medium","text-gray-500","dark:text-gray-400","mb-2"],[1,"text-sm","text-gray-900","dark:text-white","bg-gray-50","dark:bg-gray-700","p-3","rounded-md"],[1,"flex","justify-between","text-sm"],[1,"text-gray-600","dark:text-gray-300"],[1,"p-8","text-center"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"],[1,"inline-flex","items-center","rounded-md","bg-primary-600","px-4","py-2","text-sm","font-medium","text-white","hover:bg-primary-700",3,"routerLink"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200","dark:divide-gray-700"],[1,"bg-gray-50","dark:bg-gray-900"],["scope","col",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","dark:text-gray-400","uppercase","tracking-wider"],["scope","col",1,"px-6","py-3","text-right","text-xs","font-medium","text-gray-500","dark:text-gray-400","uppercase","tracking-wider"],[1,"bg-white","dark:bg-gray-800","divide-y","divide-gray-200","dark:divide-gray-700"],["class","hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200",4,"ngFor","ngForOf","ngForTrackBy"],["colspan","5",1,"px-6","py-3","text-right","text-sm","font-medium","text-gray-900","dark:text-white"],[1,"px-6","py-3","text-right","text-sm","font-medium","text-gray-900","dark:text-white"],[1,"hover:bg-gray-50","dark:hover:bg-gray-700","transition-colors","duration-200"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","font-medium","text-gray-900","dark:text-white"],["class","text-xs text-gray-500 dark:text-gray-400 max-w-xs truncate",4,"ngIf"],[1,"text-sm","text-gray-900","dark:text-white"],["class","text-xs text-gray-500 dark:text-gray-400",4,"ngIf"],[1,"text-xs","text-gray-500","dark:text-gray-400"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"text-gray-900","dark:text-white"],[1,"relative","inline-block","text-left"],["title","Cambiar estado",1,"text-primary-600","dark:text-primary-400","hover:text-primary-900","dark:hover:text-primary-300","transition-colors","duration-200",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"],[1,"text-xs","text-gray-500","dark:text-gray-400","max-w-xs","truncate"],[1,"border-t","border-gray-200","dark:border-gray-700","p-6"],[1,"text-lg","font-medium","text-gray-900","dark:text-white","mb-4"],["class","space-y-2",4,"ngFor","ngForOf"],[1,"space-y-2"],[4,"ngIf"],[1,"text-sm","font-medium","text-gray-700","dark:text-gray-300"],["class","text-sm text-gray-600 dark:text-gray-400 bg-blue-50 dark:bg-blue-900/20 p-3 rounded",4,"ngIf"],["class","text-sm text-gray-600 dark:text-gray-400 bg-green-50 dark:bg-green-900/20 p-3 rounded",4,"ngIf"],[1,"text-sm","text-gray-600","dark:text-gray-400","bg-blue-50","dark:bg-blue-900/20","p-3","rounded"],[1,"font-medium"],[1,"text-sm","text-gray-600","dark:text-gray-400","bg-green-50","dark:bg-green-900/20","p-3","rounded"],[1,"fixed","inset-0","bg-black","bg-opacity-50","z-50","flex","items-center","justify-center","p-4"],[1,"bg-white","dark:bg-gray-800","rounded-lg","max-w-md","w-full","p-6","transition-colors","duration-200"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100","dark:bg-red-900","sm:mx-0","sm:h-10","sm:w-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-red-600","dark:text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left"],[1,"text-lg","leading-6","font-medium","text-gray-900","dark:text-white"],[1,"mt-2"],[1,"mt-5","sm:mt-4","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-transparent","shadow-sm","px-4","py-2","bg-red-600","text-base","font-medium","text-white","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:ml-3","sm:w-auto","sm:text-sm","transition-colors","duration-200",3,"click","disabled"],["class","flex items-center",4,"ngIf"],["type","button",1,"mt-3","w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","dark:border-gray-600","shadow-sm","px-4","py-2","bg-white","dark:bg-gray-700","text-base","font-medium","text-gray-700","dark:text-gray-200","hover:bg-gray-50","dark:hover:bg-gray-600","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-primary-500","sm:mt-0","sm:w-auto","sm:text-sm","transition-colors","duration-200",3,"click","disabled"],[1,"flex","items-center"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-2","h-4","w-4","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,n){e&1&&(p(0,"app-admin-header",0),i(1,"div",1),f(2,Gt,4,0,"div",2)(3,Nt,11,0,"div",3)(4,di,119,24,"div",4)(5,mi,18,4,"div",5),r()),e&2&&(m("title","Detalle de Reserva"+(n.reserva()?" - "+n.reserva().codigo_reserva:"")),d(2),m("ngIf",n.loading()),d(),m("ngIf",!n.loading()&&!n.reserva()),d(),m("ngIf",!n.loading()&&n.reserva()),d(),m("ngIf",n.mostrarConfirmacionEliminacion()))},dependencies:[j,O,G,N,B,z],encapsulation:2})};var pi=s=>["/admin/reservas/detail",s];function ui(s,t){s&1&&(i(0,"div",49),p(1,"div",50),i(2,"span",51),a(3,"Cargando reservas..."),r()())}function vi(s,t){if(s&1&&(i(0,"div",69),a(1),r()),s&2){let e=t.$implicit;d(),x(" ",e," ")}}function gi(s,t){if(s&1&&(i(0,"span",77),a(1),r()),s&2){let e=c().$implicit;d(),x(" ",e.reservas.length," ")}}function _i(s,t){if(s&1){let e=C();i(0,"div",78),_("click",function(){let o=v(e).$implicit,l=c(3);return g(l.verDetalleReserva(o))}),i(1,"div",79)(2,"div",80),a(3),r(),i(4,"div",81),a(5),r()()()}if(s&2){let e=t.$implicit,n=c(3);d(),F(n.getEventoClases(e)),m("title",n.getReservaTooltip(e)),d(2),k(n.obtenerHoraFormateada(e.hora_inicio)),d(2),k((e.servicio==null?null:e.servicio.nombre)||"Sin nombre")}}function xi(s,t){if(s&1){let e=C();i(0,"div",82),_("click",function(){v(e);let o=c().$implicit,l=c(2);return g(l.verMasEventos(o))}),a(1),r()}if(s&2){let e=c().$implicit;d(),x(" +",e.reservas.length-3," m\xE1s... ")}}function fi(s,t){if(s&1&&(i(0,"div",70)(1,"div",71)(2,"span",72),a(3),r(),f(4,gi,2,1,"span",73),r(),i(5,"div",74),f(6,_i,6,5,"div",75),Le(7,"slice"),f(8,xi,2,1,"div",76),r()()),s&2){let e=t.$implicit,n=c(2);F(n.getCeldaClases(e)),d(2),F(n.getDiaClases(e)),d(),x(" ",e.fecha.getDate()," "),d(),m("ngIf",e.reservas.length>0),d(2),m("ngForOf",He(7,9,e.reservas,0,3))("ngForTrackBy",n.trackByReserva),d(2),m("ngIf",e.reservas.length>3)}}function bi(s,t){if(s&1){let e=C();i(0,"div")(1,"div",52)(2,"button",53),_("click",function(){v(e);let o=c();return g(o.mesAnterior())}),b(),i(3,"svg",54),p(4,"path",55),r(),a(5," Mes Anterior "),r(),y(),i(6,"h2",56),a(7),r(),i(8,"button",53),_("click",function(){v(e);let o=c();return g(o.mesSiguiente())}),a(9," Mes Siguiente "),b(),i(10,"svg",57),p(11,"path",58),r()()(),y(),i(12,"div",59),f(13,vi,2,1,"div",60)(14,fi,9,13,"div",61),r(),i(15,"div",62)(16,"div",63)(17,"div",29),p(18,"span",64),i(19,"span",65),a(20,"Pendiente"),r()(),i(21,"div",29),p(22,"span",66),i(23,"span",65),a(24,"Confirmado"),r()(),i(25,"div",29),p(26,"span",67),i(27,"span",65),a(28,"Cancelado"),r()(),i(29,"div",29),p(30,"span",68),i(31,"span",65),a(32,"Completado"),r()()()()()}if(s&2){let e=c();d(7),D("",e.nombreMes()," ",e.anioActual,""),d(6),m("ngForOf",e.diasSemana),d(),m("ngForOf",e.celdasCalendario())("ngForTrackBy",e.trackByCelda)}}function hi(s,t){s&1&&(i(0,"div",92)(1,"p",93),a(2,"No hay reservas para este d\xEDa"),r()())}function yi(s,t){if(s&1&&(i(0,"div",113)(1,"span",114),a(2,"Cliente:"),r(),i(3,"span",115),a(4),r()()),s&2){let e=c().$implicit;d(4),k(e.notas_cliente)}}function ki(s,t){if(s&1&&(i(0,"div",96)(1,"div",97)(2,"div",98)(3,"div",99)(4,"span",100),a(5),r(),i(6,"span",101),a(7),r()(),i(8,"h4",102),a(9),r(),i(10,"p",103),a(11),r(),i(12,"div",104)(13,"div")(14,"span",105),a(15,"Duraci\xF3n:"),r(),i(16,"span",106),a(17),r()(),i(18,"div")(19,"span",105),a(20,"Precio:"),r(),i(21,"span",106),a(22),r()()(),f(23,yi,5,1,"div",107),r(),i(24,"div",108)(25,"a",109),b(),i(26,"svg",110),p(27,"path",111)(28,"path",112),r()()()()()),s&2){let e=t.$implicit,n=c(3);d(4),F(n.getEventoClases(e)),d(),x(" ",n.getEstadoTexto(e.estado)," "),d(2),D(" ",n.obtenerHoraFormateada(e.hora_inicio)," - ",n.obtenerHoraFormateada(e.hora_fin)," "),d(2),x(" ",(e.servicio==null?null:e.servicio.nombre)||"Servicio no disponible"," "),d(2),x(" ",(e.emprendedor==null?null:e.emprendedor.nombre)||"Emprendedor no disponible"," "),d(6),x("",e.duracion_minutos," min"),d(5),x("S/ ",(e.precio||0).toFixed(2),""),d(),m("ngIf",e.notas_cliente),d(2),m("routerLink",L(11,pi,e.reserva_id))}}function Si(s,t){if(s&1&&(i(0,"div",94),f(1,ki,29,13,"div",95),r()),s&2){let e=c(2);d(),m("ngForOf",e.diaSeleccionado().reservas)("ngForTrackBy",e.trackByReserva)}}function Ci(s,t){if(s&1){let e=C();i(0,"div",83)(1,"div",84)(2,"div",85)(3,"h3",36),a(4),r(),i(5,"button",86),_("click",function(){v(e);let o=c();return g(o.cerrarModalDia())}),b(),i(6,"svg",87),p(7,"path",88),r()()(),y(),i(8,"div",89),f(9,hi,3,0,"div",90)(10,Si,2,2,"div",91),r()()()}if(s&2){let e,n,o=c();d(4),x(" Reservas del ",o.diaSeleccionado()?o.formatearFecha(o.diaSeleccionado().fecha):""," "),d(5),m("ngIf",!(!((e=o.diaSeleccionado())==null||e.reservas==null)&&e.reservas.length)),d(),m("ngIf",(n=o.diaSeleccionado())==null||n.reservas==null?null:n.reservas.length)}}var Se=class s{reservasService=w(X);themeService=w($);loading=S(!1);reservasServicios=S([]);mostrarModalDia=S(!1);diaSeleccionado=S(null);fechaInicio;fechaFin;filtroEstado="";mesActual;anioActual;diasSemana=["Domingo","Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bado"];celdasCalendario=U(()=>this.generarCalendario());nombreMes=U(()=>["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][this.mesActual]);constructor(){let t=new Date;this.mesActual=t.getMonth(),this.anioActual=t.getFullYear();let e=new Date(this.anioActual,this.mesActual,1);this.fechaInicio=this.formatearFecha(e);let n=new Date(this.anioActual,this.mesActual+1,0);this.fechaFin=this.formatearFecha(n)}ngOnInit(){this.cargarReservas()}cargarReservas(){if(!this.fechaInicio||!this.fechaFin){alert("Por favor, seleccione fechas v\xE1lidas");return}this.loading.set(!0),this.reservasService.getCalendarioReservas(this.fechaInicio,this.fechaFin).subscribe({next:t=>{let e=t;this.filtroEstado&&(e=t.filter(n=>n.estado===this.filtroEstado)),this.reservasServicios.set(e),this.loading.set(!1)},error:t=>{console.error("Error al cargar las reservas:",t),this.loading.set(!1),alert("Error al cargar las reservas. Por favor, intente nuevamente.")}})}aplicarFiltros(){this.cargarReservas()}mesAnterior(){this.mesActual--,this.mesActual<0&&(this.mesActual=11,this.anioActual--),this.actualizarRangoFechas(),this.cargarReservas()}mesSiguiente(){this.mesActual++,this.mesActual>11&&(this.mesActual=0,this.anioActual++),this.actualizarRangoFechas(),this.cargarReservas()}actualizarRangoFechas(){let t=new Date(this.anioActual,this.mesActual,1);this.fechaInicio=this.formatearFecha(t);let e=new Date(this.anioActual,this.mesActual+1,0);this.fechaFin=this.formatearFecha(e)}generarCalendario(){let t=[],e=this.reservasServicios(),n=new Date(this.anioActual,this.mesActual,1),o=new Date(this.anioActual,this.mesActual+1,0),l=new Date(n),u=n.getDay();l.setDate(n.getDate()-u);let h=new Date(o),E=o.getDay();h.setDate(o.getDate()+(6-E));let P=new Date(l),le=new Date;for(;P<=h;){let Xe=e.filter(Ze=>{let Ie=new Date(Ze.fecha_inicio);return Ie.getFullYear()===P.getFullYear()&&Ie.getMonth()===P.getMonth()&&Ie.getDate()===P.getDate()});t.push({fecha:new Date(P),reservas:Xe,esFueraDeMes:P.getMonth()!==this.mesActual,esHoy:P.toDateString()===le.toDateString()}),P.setDate(P.getDate()+1)}return t}verDetalleReserva(t){t.reserva_id&&window.open(`/admin/reservas/detail/${t.reserva_id}`,"_blank")}verMasEventos(t){this.diaSeleccionado.set(t),this.mostrarModalDia.set(!0)}cerrarModalDia(){this.mostrarModalDia.set(!1),this.diaSeleccionado.set(null)}contarPorEstado(t){return this.reservasServicios().filter(e=>e.estado===t).length}trackByCelda(t,e){return e.fecha.toISOString()}trackByReserva(t,e){return e.id||t}formatearFecha(t){return t.toISOString().split("T")[0]}obtenerHoraFormateada(t){return t.substring(0,5)}getCeldaClases(t){let e="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700";return t.esFueraDeMes&&(e+=" opacity-50"),t.esHoy&&(e+=" ring-2 ring-primary-500 dark:ring-primary-400"),e}getDiaClases(t){let e="";return t.esHoy?e+="bg-primary-600 text-white rounded-full w-6 h-6 flex items-center justify-center":t.esFueraDeMes?e+="text-gray-400 dark:text-gray-600":e+="text-gray-900 dark:text-white",e}getEventoClases(t){let e="block transition-colors duration-200";switch(t.estado){case"pendiente":return`${e} bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 border-yellow-400 dark:border-yellow-600`;case"confirmado":return`${e} bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 border-green-400 dark:border-green-600`;case"cancelado":return`${e} bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 border-red-400 dark:border-red-600`;case"completado":return`${e} bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 border-blue-400 dark:border-blue-600`;default:return`${e} bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 border-gray-400 dark:border-gray-500`}}getEstadoTexto(t){return{pendiente:"Pendiente",confirmado:"Confirmado",cancelado:"Cancelado",completado:"Completado"}[t]||t}getReservaTooltip(t){return`${t.servicio?.nombre||"Sin nombre"}
Horario: ${this.obtenerHoraFormateada(t.hora_inicio)} - ${this.obtenerHoraFormateada(t.hora_fin)}
Estado: ${this.getEstadoTexto(t.estado)}
Emprendedor: ${t.emprendedor?.nombre||"No disponible"}`}isDarkMode(){return this.themeService.isDarkMode()}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=H({type:s,selectors:[["app-reserva-calendario"]],decls:94,vars:10,consts:[["title","Calendario de Reservas","subtitle","Visualiza todas las reservas programadas en formato de calendario"],[1,"container","mx-auto","px-2","sm:px-4","py-6","bg-gray-50","dark:bg-gray-900","min-h-screen","transition-colors","duration-200"],[1,"bg-white","dark:bg-gray-800","rounded-lg","p-6","shadow-sm","mb-6","transition-colors","duration-200"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","mb-4"],[1,"text-2xl","font-bold","text-gray-900","dark:text-white"],[1,"mt-1","text-sm","text-gray-500","dark:text-gray-400"],[1,"mt-4","sm:mt-0"],["routerLink","/admin/reservas",1,"inline-flex","items-center","rounded-md","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","px-4","py-2","text-sm","font-medium","text-gray-700","dark:text-gray-200","shadow-sm","hover:bg-gray-50","dark:hover:bg-gray-600","transition-colors","duration-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5","text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"grid","grid-cols-1","gap-4","md:grid-cols-4"],["for","fechaInicio",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],[1,"mt-1"],["type","date","id","fechaInicio",1,"block","w-full","rounded-md","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","dark:bg-gray-700","dark:text-white","transition-colors","duration-200",3,"ngModelChange","ngModel"],["for","fechaFin",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["type","date","id","fechaFin",1,"block","w-full","rounded-md","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","dark:bg-gray-700","dark:text-white","transition-colors","duration-200",3,"ngModelChange","ngModel"],["for","filtroEstado",1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300"],["id","filtroEstado",1,"block","w-full","rounded-md","border-gray-300","dark:border-gray-600","shadow-sm","focus:border-primary-500","focus:ring-primary-500","sm:text-sm","dark:bg-gray-700","dark:text-white","transition-colors","duration-200",3,"ngModelChange","ngModel"],["value",""],["value","pendiente"],["value","confirmado"],["value","cancelado"],["value","completado"],[1,"flex","items-end"],["type","button",1,"inline-flex","items-center","rounded-md","bg-primary-600","px-4","py-2","text-sm","font-medium","text-white","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","mb-6"],[1,"bg-white","dark:bg-gray-800","p-4","rounded-lg","shadow","transition-colors","duration-200"],[1,"flex","items-center"],[1,"flex-shrink-0"],[1,"w-8","h-8","bg-blue-100","dark:bg-blue-900","rounded-full","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-blue-600","dark:text-blue-400"],["d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","font-medium","text-gray-500","dark:text-gray-400"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white"],[1,"w-8","h-8","bg-yellow-100","dark:bg-yellow-900","rounded-full","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-yellow-600","dark:text-yellow-400"],["d","M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z"],[1,"w-8","h-8","bg-green-100","dark:bg-green-900","rounded-full","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-green-600","dark:text-green-400"],["d","M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"],[1,"w-8","h-8","bg-purple-100","dark:bg-purple-900","rounded-full","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-purple-600","dark:text-purple-400"],[1,"bg-white","dark:bg-gray-800","rounded-lg","shadow-sm","overflow-hidden","transition-colors","duration-200"],["class","flex justify-center items-center p-8",4,"ngIf"],[4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",4,"ngIf"],[1,"flex","justify-center","items-center","p-8"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-primary-600","mx-auto"],[1,"ml-4","text-gray-600","dark:text-gray-400"],[1,"flex","justify-between","items-center","p-6","border-b","border-gray-200","dark:border-gray-700"],[1,"inline-flex","items-center","rounded-md","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","px-3","py-1","text-sm","font-medium","text-gray-700","dark:text-gray-200","shadow-sm","hover:bg-gray-50","dark:hover:bg-gray-600","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-xl","font-semibold","text-gray-900","dark:text-white","transition-colors","duration-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","ml-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"grid","grid-cols-7","gap-px","bg-gray-200","dark:bg-gray-600","transition-colors","duration-200"],["class","bg-gray-100 dark:bg-gray-700 p-3 text-center text-sm font-medium text-gray-700 dark:text-gray-200 transition-colors duration-200",4,"ngFor","ngForOf"],["class","min-h-[120px] p-2 transition-colors duration-200",3,"class",4,"ngFor","ngForOf","ngForTrackBy"],[1,"p-4","border-t","border-gray-200","dark:border-gray-700","bg-gray-50","dark:bg-gray-900","transition-colors","duration-200"],[1,"flex","flex-wrap","gap-4"],[1,"inline-block","w-4","h-4","mr-2","bg-yellow-100","dark:bg-yellow-800","border-l-2","border-yellow-400","dark:border-yellow-600","rounded-sm","transition-colors","duration-200"],[1,"text-xs","text-gray-700","dark:text-gray-300","transition-colors","duration-200"],[1,"inline-block","w-4","h-4","mr-2","bg-green-100","dark:bg-green-800","border-l-2","border-green-400","dark:border-green-600","rounded-sm","transition-colors","duration-200"],[1,"inline-block","w-4","h-4","mr-2","bg-red-100","dark:bg-red-800","border-l-2","border-red-400","dark:border-red-600","rounded-sm","transition-colors","duration-200"],[1,"inline-block","w-4","h-4","mr-2","bg-blue-100","dark:bg-blue-800","border-l-2","border-blue-400","dark:border-blue-600","rounded-sm","transition-colors","duration-200"],[1,"bg-gray-100","dark:bg-gray-700","p-3","text-center","text-sm","font-medium","text-gray-700","dark:text-gray-200","transition-colors","duration-200"],[1,"min-h-[120px]","p-2","transition-colors","duration-200"],[1,"flex","justify-between","items-start","mb-1"],[1,"text-sm","font-medium","transition-colors","duration-200"],["class","text-xs px-1.5 py-0.5 bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 rounded-full transition-colors duration-200",4,"ngIf"],[1,"space-y-1","max-h-[80px]","overflow-y-auto"],["class","cursor-pointer",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-xs text-gray-500 dark:text-gray-400 pl-2 cursor-pointer hover:text-gray-700 dark:hover:text-gray-300 transition-colors duration-200",3,"click",4,"ngIf"],[1,"text-xs","px-1.5","py-0.5","bg-primary-100","dark:bg-primary-900","text-primary-800","dark:text-primary-200","rounded-full","transition-colors","duration-200"],[1,"cursor-pointer",3,"click"],[1,"px-2","py-1","rounded","text-xs","border-l-2","transition-colors","duration-200",3,"title"],[1,"font-medium","truncate"],[1,"truncate","opacity-90"],[1,"text-xs","text-gray-500","dark:text-gray-400","pl-2","cursor-pointer","hover:text-gray-700","dark:hover:text-gray-300","transition-colors","duration-200",3,"click"],[1,"fixed","inset-0","bg-black","bg-opacity-50","z-50","flex","items-center","justify-center","p-4"],[1,"bg-white","dark:bg-gray-800","rounded-lg","max-w-2xl","w-full","max-h-[80vh]","overflow-y-auto","transition-colors","duration-200"],[1,"px-6","py-4","border-b","border-gray-200","dark:border-gray-700","flex","justify-between","items-center"],[1,"text-gray-400","hover:text-gray-600","dark:hover:text-gray-300","transition-colors","duration-200",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-6"],["class","text-center py-8",4,"ngIf"],["class","space-y-4",4,"ngIf"],[1,"text-center","py-8"],[1,"text-gray-500","dark:text-gray-400"],[1,"space-y-4"],["class","border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200",4,"ngFor","ngForOf","ngForTrackBy"],[1,"border","border-gray-200","dark:border-gray-700","rounded-lg","p-4","hover:bg-gray-50","dark:hover:bg-gray-700","transition-colors","duration-200"],[1,"flex","justify-between","items-start"],[1,"flex-1"],[1,"flex","items-center","space-x-2","mb-2"],[1,"px-2","py-1","rounded","text-xs","font-medium","border-l-2"],[1,"text-sm","font-medium","text-gray-900","dark:text-white"],[1,"text-lg","font-medium","text-gray-900","dark:text-white","mb-1"],[1,"text-sm","text-gray-600","dark:text-gray-400","mb-2"],[1,"grid","grid-cols-2","gap-2","text-sm"],[1,"font-medium","text-gray-700","dark:text-gray-300"],[1,"text-gray-600","dark:text-gray-400","ml-1"],["class","mt-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded text-sm",4,"ngIf"],[1,"flex","space-x-2","ml-4"],["title","Ver detalle de reserva",1,"text-primary-600","dark:text-primary-400","hover:text-primary-800","dark:hover:text-primary-300","transition-colors","duration-200",3,"routerLink"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],[1,"mt-2","p-2","bg-blue-50","dark:bg-blue-900/20","rounded","text-sm"],[1,"font-medium","text-blue-800","dark:text-blue-300"],[1,"text-blue-700","dark:text-blue-400","ml-1"]],template:function(e,n){e&1&&(p(0,"app-admin-header",0),i(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"h1",4),a(6,"Calendario de Reservas"),r(),i(7,"p",5),a(8," Gestiona y visualiza todas las reservas de servicios tur\xEDsticos "),r()(),i(9,"div",6)(10,"a",7),b(),i(11,"svg",8),p(12,"path",9),r(),a(13," Volver a Lista "),r()()(),y(),i(14,"div",10)(15,"div")(16,"label",11),a(17,"Fecha Inicio"),r(),i(18,"div",12)(19,"input",13),R("ngModelChange",function(l){return I(n.fechaInicio,l)||(n.fechaInicio=l),l}),_("ngModelChange",function(){return n.aplicarFiltros()}),r()()(),i(20,"div")(21,"label",14),a(22,"Fecha Fin"),r(),i(23,"div",12)(24,"input",15),R("ngModelChange",function(l){return I(n.fechaFin,l)||(n.fechaFin=l),l}),_("ngModelChange",function(){return n.aplicarFiltros()}),r()()(),i(25,"div")(26,"label",16),a(27,"Estado"),r(),i(28,"div",12)(29,"select",17),R("ngModelChange",function(l){return I(n.filtroEstado,l)||(n.filtroEstado=l),l}),_("ngModelChange",function(){return n.aplicarFiltros()}),i(30,"option",18),a(31,"Todos los estados"),r(),i(32,"option",19),a(33,"Pendientes"),r(),i(34,"option",20),a(35,"Confirmados"),r(),i(36,"option",21),a(37,"Cancelados"),r(),i(38,"option",22),a(39,"Completados"),r()()()(),i(40,"div",23)(41,"button",24),_("click",function(){return n.cargarReservas()}),b(),i(42,"svg",25),p(43,"path",26),r(),a(44," Actualizar "),r()()()(),y(),i(45,"div",27)(46,"div",28)(47,"div",29)(48,"div",30)(49,"div",31),b(),i(50,"svg",32),p(51,"path",33),r()()(),y(),i(52,"div",34)(53,"p",35),a(54,"Total Servicios"),r(),i(55,"p",36),a(56),r()()()(),i(57,"div",28)(58,"div",29)(59,"div",30)(60,"div",37),b(),i(61,"svg",38),p(62,"path",39),r()()(),y(),i(63,"div",34)(64,"p",35),a(65,"Pendientes"),r(),i(66,"p",36),a(67),r()()()(),i(68,"div",28)(69,"div",29)(70,"div",30)(71,"div",40),b(),i(72,"svg",41),p(73,"path",42),r()()(),y(),i(74,"div",34)(75,"p",35),a(76,"Confirmados"),r(),i(77,"p",36),a(78),r()()()(),i(79,"div",28)(80,"div",29)(81,"div",30)(82,"div",43),b(),i(83,"svg",44),p(84,"path",33),r()()(),y(),i(85,"div",34)(86,"p",35),a(87,"Completados"),r(),i(88,"p",36),a(89),r()()()()(),i(90,"div",45),f(91,ui,4,0,"div",46)(92,bi,33,5,"div",47),r(),f(93,Ci,11,3,"div",48),r()),e&2&&(d(19),M("ngModel",n.fechaInicio),d(5),M("ngModel",n.fechaFin),d(5),M("ngModel",n.filtroEstado),d(27),k(n.reservasServicios().length),d(11),k(n.contarPorEstado("pendiente")),d(11),k(n.contarPorEstado("confirmado")),d(11),k(n.contarPorEstado("completado")),d(2),m("ngIf",n.loading()),d(),m("ngIf",!n.loading()),d(),m("ngIf",n.mostrarModalDia()))},dependencies:[j,O,G,Ae,N,B,K,Q,q,J,W,Y,z],encapsulation:2})};var wi=s=>["/admin/emprendedores",s],Ei=s=>["/admin/servicios/edit",s],Ke=s=>({servicio_id:s}),Mi=(s,t,e,n)=>({"bg-yellow-100 text-yellow-800":s,"bg-green-100 text-green-800":t,"bg-red-100 text-red-800":e,"bg-blue-100 text-blue-800":n}),Ii=s=>["/admin/reservas/detail",s],Ri=s=>["/admin/reservas/edit",s],Qe=(s,t)=>t.id;function Ti(s,t){if(s&1&&(i(0,"p",3),a(1," Reservas del servicio: "),i(2,"span",15),a(3),r()()),s&2){let e=c();d(3),k(e.servicio.nombre)}}function Vi(s,t){s&1&&(i(0,"div",8)(1,"div",12),p(2,"div",16),i(3,"span",17),a(4,"Cargando informaci\xF3n..."),r()()())}function Fi(s,t){if(s&1&&(i(0,"span",43),a(1),r()),s&2){let e=t.$implicit;d(),x(" ",e.nombre," ")}}function Pi(s,t){if(s&1&&(i(0,"div",27)(1,"h3",22),a(2,"Categor\xEDas"),r(),i(3,"div",42),Te(4,Fi,2,1,"span",43,Qe),r()()),s&2){let e=c(2);d(4),Ve(e.servicio.categorias)}}function Di(s,t){if(s&1&&(i(0,"div",8)(1,"div",18)(2,"div",19)(3,"h2",11),a(4),r(),i(5,"p",20),a(6),r(),i(7,"div",21)(8,"div")(9,"h3",22),a(10,"Precio Referencial"),r(),i(11,"p",23),a(12),r()(),i(13,"div")(14,"h3",22),a(15,"Estado"),r(),i(16,"p",24)(17,"span",25),a(18),r()()(),i(19,"div")(20,"h3",22),a(21,"Emprendedor"),r(),i(22,"p",23)(23,"a",26),a(24),r()()(),i(25,"div")(26,"h3",22),a(27,"Horarios Disponibles"),r(),i(28,"p",23),a(29),r()()(),f(30,Pi,6,0,"div",27),i(31,"div",28)(32,"a",29),b(),i(33,"svg",30),p(34,"path",31),r(),a(35," Editar Servicio "),r(),y(),i(36,"a",32),b(),i(37,"svg",30),p(38,"path",33),r(),a(39," Nueva Reserva "),r()()(),y(),i(40,"div",34)(41,"h3",35),a(42,"Resumen de Reservas"),r(),i(43,"dl",36)(44,"div",37)(45,"dt",22),a(46,"Total Reservas"),r(),i(47,"dd",38),a(48),r()(),i(49,"div",37)(50,"dt",22),a(51,"Pendientes"),r(),i(52,"dd",39),a(53),r()(),i(54,"div",37)(55,"dt",22),a(56,"Confirmadas"),r(),i(57,"dd",40),a(58),r()(),i(59,"div",37)(60,"dt",22),a(61,"Canceladas"),r(),i(62,"dd",41),a(63),r()()()()()()),s&2){let e=c();d(4),k(e.servicio.nombre),d(2),k(e.servicio.descripcion),d(6),x("S/. ",e.servicio.precio_referencial||"0.00",""),d(5),m("ngClass",e.servicio.estado?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),d(),x(" ",e.servicio.estado?"Activo":"Inactivo"," "),d(5),m("routerLink",L(15,wi,e.servicio.emprendedor_id)),d(),x(" ",(e.servicio.emprendedor==null?null:e.servicio.emprendedor.nombre)||"Sin emprendedor"," "),d(5),x("",(e.servicio.horarios==null?null:e.servicio.horarios.length)||0," horarios"),d(),ee(e.servicio.categorias&&e.servicio.categorias.length>0?30:-1),d(2),m("routerLink",L(17,Ei,e.servicio.id)),d(4),m("queryParams",L(19,Ke,e.servicio.id)),d(12),k(e.reservas.length),d(5),k(e.contarReservasPorEstado("pendiente")),d(5),k(e.contarReservasPorEstado("confirmada")),d(5),k(e.contarReservasPorEstado("cancelada"))}}function Li(s,t){s&1&&(i(0,"div",12),p(1,"div",16),i(2,"span",17),a(3,"Cargando reservas..."),r()())}function Hi(s,t){if(s&1&&(i(0,"div",13),b(),i(1,"svg",44),p(2,"path",45),r(),y(),i(3,"h3",46),a(4,"No hay reservas para este servicio"),r(),i(5,"div",47)(6,"a",48),b(),i(7,"svg",49),p(8,"path",33),r(),a(9," Crear Reserva "),r()()()),s&2){let e=c();d(6),m("queryParams",L(1,Ke,e.servicioId))}}function ji(s,t){if(s&1&&a(0),s&2){let e=c().$implicit;x(" ",e.usuario.name," ")}}function Ai(s,t){s&1&&(i(0,"span",58),a(1,"Desconocido"),r())}function Bi(s,t){if(s&1&&a(0),s&2){let e=c().$implicit;x(" ",e.usuario.email," ")}}function Oi(s,t){if(s&1&&(i(0,"div",57),a(1),r()),s&2){let e=c().$implicit,n=c(2);d(),k(n.formatDate(e.servicios[0].fecha_inicio))}}function Gi(s,t){if(s&1&&(i(0,"div",57),a(1),r()),s&2){let e=c().$implicit,n=c(2);d(),D(" ",n.formatTime(e.servicios[0].hora_inicio)," - ",n.formatTime(e.servicios[0].hora_fin)," ")}}function Ni(s,t){if(s&1&&(i(0,"tr")(1,"td",55)(2,"div",56),a(3),r()(),i(4,"td",55)(5,"div",57),f(6,ji,1,1)(7,Ai,2,0,"span",58),r(),i(8,"div",59),f(9,Bi,1,1),r()(),i(10,"td",55),f(11,Oi,2,1,"div",57),r(),i(12,"td",55),f(13,Gi,2,2,"div",57),r(),i(14,"td",55)(15,"span",60),a(16),r()(),i(17,"td",61)(18,"div",62)(19,"a",63),b(),i(20,"svg",64),p(21,"path",65)(22,"path",66),r()(),y(),i(23,"a",67),b(),i(24,"svg",64),p(25,"path",31),r()()()()()),s&2){let e=t.$implicit,n=c(2);d(3),k(e.codigo_reserva),d(3),ee(e.usuario?6:7),d(3),ee(e.usuario?9:-1),d(2),ee(e.servicios&&e.servicios.length>0?11:-1),d(2),ee(e.servicios&&e.servicios.length>0?13:-1),d(2),m("ngClass",De(9,Mi,e.estado==="pendiente",e.estado==="confirmada",e.estado==="cancelada",e.estado==="completada")),d(),x(" ",n.getEstadoLabel(e.estado)," "),d(3),m("routerLink",L(14,Ii,e.id)),d(4),m("routerLink",L(16,Ri,e.id))}}function $i(s,t){if(s&1&&(i(0,"div",14)(1,"table",50)(2,"thead",51)(3,"tr")(4,"th",52),a(5,"C\xF3digo"),r(),i(6,"th",52),a(7,"Cliente"),r(),i(8,"th",52),a(9,"Fecha"),r(),i(10,"th",52),a(11,"Horario"),r(),i(12,"th",52),a(13,"Estado"),r(),i(14,"th",53),a(15,"Acciones"),r()()(),i(16,"tbody",54),Te(17,Ni,26,18,"tr",null,Qe),r()()()),s&2){let e=c();d(17),Ve(e.reservas)}}var Ce=class s{turismoService=w(qe);route=w(ie);servicioId=0;servicio=null;reservas=[];loading=!0;ngOnInit(){let t=this.route.snapshot.paramMap.get("id");t?(this.servicioId=+t,this.cargarServicio(),this.cargarReservas()):this.loading=!1}cargarServicio(){this.turismoService.getServicio(this.servicioId).subscribe({next:t=>{this.servicio=t},error:t=>{console.error("Error al cargar el servicio:",t),alert("Error al cargar la informaci\xF3n del servicio")}})}cargarReservas(){this.turismoService.getReservasByServicio(this.servicioId).subscribe({next:t=>{this.reservas=t,this.loading=!1},error:t=>{console.error("Error al cargar las reservas:",t),this.loading=!1,alert("Error al cargar las reservas del servicio")}})}getEstadoLabel(t){switch(t){case"pendiente":return"Pendiente";case"confirmada":return"Confirmada";case"cancelada":return"Cancelada";case"completada":return"Completada";default:return"Desconocido"}}formatDate(t){return t?new Date(t).toLocaleDateString():"N/A"}formatTime(t){return t?t.substring(0,5):"N/A"}contarReservasPorEstado(t){return this.reservas.filter(e=>e.estado===t).length}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=H({type:s,selectors:[["app-reserva-servicio"]],decls:20,vars:3,consts:[[1,"space-y-6"],[1,"sm:flex","sm:items-center","sm:justify-between"],[1,"text-2xl","font-bold","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"mt-4","sm:mt-0"],["routerLink","/admin/servicios",1,"inline-flex","items-center","rounded-md","border","border-gray-300","bg-white","px-4","py-2","text-sm","font-medium","text-gray-700","shadow-sm","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5","text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"rounded-lg","bg-white","p-6","shadow-sm"],[1,"rounded-lg","bg-white","shadow-sm","overflow-hidden"],[1,"p-6","border-b","border-gray-200"],[1,"text-lg","font-medium","text-gray-900"],[1,"flex","justify-center","items-center","p-8"],[1,"p-8","text-center"],[1,"overflow-x-auto"],[1,"font-medium"],[1,"inline-block","h-8","w-8","animate-spin","rounded-full","border-4","border-solid","border-primary-400","border-r-transparent"],[1,"ml-4"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],[1,"md:col-span-2"],[1,"mt-2","text-gray-700"],[1,"mt-4","grid","grid-cols-2","gap-4"],[1,"text-sm","font-medium","text-gray-500"],[1,"mt-1","text-sm","text-gray-900"],[1,"mt-1"],[1,"inline-flex","rounded-full","px-2.5","py-0.5","text-xs","font-medium",3,"ngClass"],[1,"text-primary-600","hover:text-primary-900",3,"routerLink"],[1,"mt-4"],[1,"mt-6","flex","space-x-3"],[1,"inline-flex","items-center","rounded-md","bg-white","px-3","py-2","text-sm","font-medium","text-primary-600","hover:bg-primary-50","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2",3,"routerLink"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-0.5","mr-1.5","h-4","w-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["routerLink","/admin/reservas/create",1,"inline-flex","items-center","rounded-md","bg-primary-600","px-3","py-2","text-sm","font-medium","text-white","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2",3,"queryParams"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"bg-gray-50","p-4","rounded-lg"],[1,"text-sm","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"mt-4","grid","grid-cols-1","gap-4"],[1,"bg-white","rounded-lg","p-4","shadow-sm"],[1,"mt-1","text-3xl","font-semibold","text-gray-900"],[1,"mt-1","text-3xl","font-semibold","text-yellow-600"],[1,"mt-1","text-3xl","font-semibold","text-green-600"],[1,"mt-1","text-3xl","font-semibold","text-red-600"],[1,"mt-1","flex","flex-wrap","gap-1"],[1,"inline-flex","rounded-full","bg-primary-100","px-2.5","py-0.5","text-xs","font-medium","text-primary-800"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-6"],["routerLink","/admin/reservas/create",1,"inline-flex","items-center","rounded-md","bg-primary-600","px-4","py-2","text-sm","font-medium","text-white","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2",3,"queryParams"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"-ml-1","mr-2","h-5","w-5"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],["scope","col",1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],["scope","col",1,"px-6","py-3","text-right","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-sm","text-gray-900"],[1,"text-gray-500"],[1,"text-xs","text-gray-500"],[1,"inline-flex","rounded-full","px-2.5","py-1","text-xs","font-medium",3,"ngClass"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"flex","items-center","justify-end","space-x-2"],["title","Ver detalles",1,"text-primary-600","hover:text-primary-900",3,"routerLink"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["title","Editar",1,"text-primary-600","hover:text-primary-900",3,"routerLink"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),a(4,"Reservas por Servicio"),r(),f(5,Ti,4,1,"p",3),r(),i(6,"div",4)(7,"a",5),b(),i(8,"svg",6),p(9,"path",7),r(),a(10," Volver a Servicios "),r()()(),f(11,Vi,5,0,"div",8)(12,Di,64,21,"div",8),y(),i(13,"div",9)(14,"div",10)(15,"h2",11),a(16,"Reservas"),r()(),f(17,Li,4,0,"div",12)(18,Hi,10,3,"div",13)(19,$i,19,0,"div",14),r()()),e&2&&(d(5),ee(n.servicio?5:-1),d(6),ee(n.loading?11:n.servicio?12:-1),d(6),ee(n.loading?17:n.reservas.length===0?18:19))},dependencies:[j,je,N,B],encapsulation:2})};var we=class s{http=w(xe);API_URL=oe.apiUrl;getHeaders(){let t=localStorage.getItem("auth_token");return new _e({Authorization:`Bearer ${t}`,Accept:"application/json","Content-Type":"application/json"})}getMisReservas(){return this.http.get(`${this.API_URL}/reservas/mis-reservas`,{headers:this.getHeaders()}).pipe(T(t=>t.data))}getReservaDetalle(t){return this.http.get(`${this.API_URL}/reservas/${t}`,{headers:this.getHeaders()}).pipe(T(e=>e.data))}actualizarReserva(t,e){return this.http.put(`${this.API_URL}/reservas/${t}`,e,{headers:this.getHeaders()}).pipe(T(n=>n.data))}cambiarEstadoReserva(t,e){return this.http.put(`${this.API_URL}/reservas/${t}/estado`,{estado:e},{headers:this.getHeaders()}).pipe(T(n=>n.data))}cambiarEstadoServicioReserva(t,e){return this.http.put(`${this.API_URL}/reserva-servicios/${t}/estado`,{estado:e},{headers:this.getHeaders()}).pipe(T(n=>n.data))}verificarDisponibilidad(t){let e=new te().set("servicio_id",t.servicio_id.toString()).set("fecha_inicio",t.fecha_inicio).set("hora_inicio",t.hora_inicio).set("hora_fin",t.hora_fin);return t.fecha_fin&&(e=e.set("fecha_fin",t.fecha_fin)),t.reserva_servicio_id&&(e=e.set("reserva_servicio_id",t.reserva_servicio_id.toString())),this.http.get(`${this.API_URL}/reserva-servicios/verificar-disponibilidad`,{params:e,headers:this.getHeaders()}).pipe(T(n=>n.disponible))}procesarPago(t,e){let n={yape:"/pagos/yape",visa:"/pagos/visa",mastercard:"/pagos/mastercard"};return new ue(o=>{setTimeout(()=>{try{o.next({success:!0,url_pago:n[e]}),o.complete()}catch(l){o.error(l)}},500)})}getMensajesChat(t,e){return new ue(n=>{let o=[{id:1,reserva_id:t,usuario_id:1,emprendedor_id:e,mensaje:"Hola, tengo algunas preguntas sobre mi reserva",emisor:"usuario",leido:!0,created_at:new Date(Date.now()-864e5).toISOString(),updated_at:new Date(Date.now()-864e5).toISOString()},{id:2,reserva_id:t,usuario_id:1,emprendedor_id:e,mensaje:"\xA1Hola! Claro, estoy aqu\xED para ayudarte. \xBFQu\xE9 necesitas saber?",emisor:"emprendedor",leido:!0,created_at:new Date(Date.now()-828e5).toISOString(),updated_at:new Date(Date.now()-828e5).toISOString()}];setTimeout(()=>{n.next(o),n.complete()},500)})}enviarMensaje(t){return new ue(e=>{let n={id:Date.now(),reserva_id:t.reserva_id,usuario_id:1,emprendedor_id:t.emprendedor_id,mensaje:t.mensaje,emisor:"usuario",leido:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};setTimeout(()=>{e.next(n),e.complete()},500)})}getEstadisticasReservas(){return this.getMisReservas().pipe(T(t=>{let e={total:t.length,pendientes:0,confirmadas:0,completadas:0,canceladas:0};return t.forEach(n=>{switch(n.estado){case"pendiente":e.pendientes++;break;case"confirmada":e.confirmadas++;break;case"completada":e.completadas++;break;case"cancelada":e.canceladas++;break}}),e}))}static \u0275fac=function(e){return new(e||s)};static \u0275prov=ve({token:s,factory:s.\u0275fac,providedIn:"root"})};var zi=()=>["/servicios"];function Ui(s,t){s&1&&(i(0,"div",33),p(1,"div",34),i(2,"p",35),a(3,"Cargando reservas..."),r()())}function qi(s,t){s&1&&(i(0,"div",36),b(),i(1,"svg",37),p(2,"path",38),r(),y(),i(3,"h3",39),a(4,"No tienes reservas"),r(),i(5,"p",40),a(6,"Comienza explorando nuestros servicios tur\xEDsticos."),r(),i(7,"button",41),a(8," Explorar servicios "),r()()),s&2&&(d(7),m("routerLink",ge(1,zi)))}function Wi(s,t){if(s&1){let e=C();i(0,"div",48)(1,"p",67),a(2),r(),i(3,"button",68),_("click",function(){v(e);let o=c(2).$implicit,l=c(2);return g(l.iniciarEdicionNotas(o.id,o.notas||""))}),a(4," Editar "),r()()}if(s&2){let e=c(2).$implicit;d(2),x(" ",e.notas||"Sin notas adicionales"," ")}}function Yi(s,t){if(s&1){let e=C();i(0,"div",69)(1,"textarea",70),R("ngModelChange",function(o){v(e);let l=c(2).$implicit,u=c(2);return I(u.nuevasNotas[l.id],o)||(u.nuevasNotas[l.id]=o),g(o)}),r(),i(2,"div",71)(3,"button",72),_("click",function(){v(e);let o=c(2).$implicit,l=c(2);return g(l.guardarNotas(o))}),a(4),r(),i(5,"button",73),_("click",function(){v(e);let o=c(2).$implicit,l=c(2);return g(l.cancelarEdicionNotas(o.id))}),a(6," Cancelar "),r()()()}if(s&2){let e=c(2).$implicit,n=c(2);d(),M("ngModel",n.nuevasNotas[e.id]),d(2),m("disabled",n.guardandoNotas[e.id]),d(),x(" ",n.guardandoNotas[e.id]?"Guardando...":"Guardar"," ")}}function Ji(s,t){if(s&1&&(Fe(0),p(1,"img",87),Pe()),s&2){let e=t.ngIf,n=c().$implicit;d(),m("src",e.url_completa,ae)("alt",n.servicio==null?null:n.servicio.nombre)}}function Ki(s,t){s&1&&(Fe(0),i(1,"div",88),b(),i(2,"svg",89),p(3,"path",90),r()(),Pe())}function Qi(s,t){if(s&1){let e=C();i(0,"button",68),_("click",function(){v(e);let o=c(2).$implicit,l=c(4);return g(l.iniciarEdicionHorario(o))}),a(1," Cambiar horario "),r()}}function Xi(s,t){if(s&1&&(i(0,"div",82)(1,"p")(2,"strong"),a(3,"Fecha:"),r(),a(4),r(),i(5,"p")(6,"strong"),a(7,"Horario:"),r(),a(8),r(),i(9,"p")(10,"strong"),a(11,"Duraci\xF3n:"),r(),a(12),r(),i(13,"div",91),f(14,Qi,2,0,"button",92),r()()),s&2){let e=c().$implicit,n=c(4);d(4),x(" ",n.formatearFecha(e.fecha_inicio),""),d(4),D(" ",e.hora_inicio," - ",e.hora_fin,""),d(4),x(" ",e.duracion_minutos," minutos"),d(2),m("ngIf",e.estado==="pendiente")}}function Zi(s,t){s&1&&(i(0,"div",101),a(1," Verificando disponibilidad... "),r())}function er(s,t){s&1&&(i(0,"div",102),a(1," \u2713 Horario disponible "),r())}function tr(s,t){s&1&&(i(0,"div",103),a(1," \u2717 Horario no disponible "),r())}function ir(s,t){if(s&1){let e=C();i(0,"div",93)(1,"div",94)(2,"div")(3,"label",95),a(4,"Fecha"),r(),i(5,"input",96),R("ngModelChange",function(o){v(e);let l=c().$implicit,u=c(4);return I(u.datosEdicionHorario[l.id].fecha,o)||(u.datosEdicionHorario[l.id].fecha=o),g(o)}),_("ngModelChange",function(){v(e);let o=c().$implicit,l=c(4);return g(l.verificarDisponibilidadEdicion(o.id))}),r()(),i(6,"div")(7,"label",95),a(8,"Hora inicio"),r(),i(9,"input",97),R("ngModelChange",function(o){v(e);let l=c().$implicit,u=c(4);return I(u.datosEdicionHorario[l.id].horaInicio,o)||(u.datosEdicionHorario[l.id].horaInicio=o),g(o)}),_("ngModelChange",function(){v(e);let o=c().$implicit,l=c(4);return g(l.verificarDisponibilidadEdicion(o.id))}),r()(),i(10,"div")(11,"label",95),a(12,"Hora fin"),r(),i(13,"input",97),R("ngModelChange",function(o){v(e);let l=c().$implicit,u=c(4);return I(u.datosEdicionHorario[l.id].horaFin,o)||(u.datosEdicionHorario[l.id].horaFin=o),g(o)}),_("ngModelChange",function(){v(e);let o=c().$implicit,l=c(4);return g(l.verificarDisponibilidadEdicion(o.id))}),r()()(),f(14,Zi,2,0,"div",98)(15,er,2,0,"div",99)(16,tr,2,0,"div",100),i(17,"div",71)(18,"button",72),_("click",function(){v(e);let o=c().$implicit,l=c(4);return g(l.guardarCambioHorario(o))}),a(19),r(),i(20,"button",73),_("click",function(){v(e);let o=c().$implicit,l=c(4);return g(l.cancelarEdicionHorario(o.id))}),a(21," Cancelar "),r()()()}if(s&2){let e=c().$implicit,n=c(4);d(5),M("ngModel",n.datosEdicionHorario[e.id].fecha),d(4),M("ngModel",n.datosEdicionHorario[e.id].horaInicio),d(4),M("ngModel",n.datosEdicionHorario[e.id].horaFin),d(),m("ngIf",n.datosEdicionHorario[e.id].verificandoDisponibilidad),d(),m("ngIf",n.datosEdicionHorario[e.id].disponible===!0),d(),m("ngIf",n.datosEdicionHorario[e.id].disponible===!1),d(2),m("disabled",!n.datosEdicionHorario[e.id].disponible||n.guardandoHorario[e.id]),d(),x(" ",n.guardandoHorario[e.id]?"Guardando...":"Guardar cambios"," ")}}function rr(s,t){if(s&1){let e=C();i(0,"button",104),_("click",function(){v(e);let o=c().$implicit,l=c(4);return g(l.cambiarEstadoServicio(o.id,"confirmado"))}),a(1," Confirmar servicio "),r()}}function nr(s,t){if(s&1){let e=C();i(0,"button",105),_("click",function(){v(e);let o=c().$implicit,l=c(4);return g(l.cambiarEstadoServicio(o.id,"cancelado"))}),a(1," Cancelar servicio "),r()}}function ar(s,t){if(s&1){let e=C();i(0,"div",74)(1,"div",75),f(2,Ji,2,2,"ng-container",76)(3,Ki,4,0,"ng-container",76),i(4,"div",77)(5,"div",46)(6,"div")(7,"h5",60),a(8),r(),i(9,"p",47),a(10),r()(),i(11,"span",49),a(12),r()(),i(13,"div",78),f(14,Xi,15,5,"div",79)(15,ir,22,8,"div",80),r(),i(16,"div",81)(17,"p",82)(18,"strong"),a(19,"Notas:"),r(),a(20),r()(),i(21,"div",83),f(22,rr,2,0,"button",84)(23,nr,2,0,"button",85),i(24,"button",86),_("click",function(){let o=v(e).$implicit,l=c(2).$implicit,u=c(2);return g(u.abrirChat(l,o))}),a(25," Chat con emprendedor "),r()()()()()}if(s&2){let e=t.$implicit,n=c(4);d(2),m("ngIf",e.servicio==null||e.servicio.sliders==null?null:e.servicio.sliders[0]),d(),m("ngIf",!(!(e.servicio==null||e.servicio.sliders==null)&&e.servicio.sliders[0])),d(5),x(" ",e.servicio==null?null:e.servicio.nombre," "),d(2),x(" ",e.emprendedor==null?null:e.emprendedor.nombre," "),d(),F(n.getEstadoClasse(e.estado)),d(),x(" ",n.getEstadoTexto(e.estado)," "),d(2),m("ngIf",!n.editandoHorario[e.id]),d(),m("ngIf",n.editandoHorario[e.id]),d(5),x(" ",e.notas_cliente||"Sin notas espec\xEDficas"," "),d(2),m("ngIf",e.estado==="pendiente"),d(),m("ngIf",e.estado==="pendiente"||e.estado==="confirmado")}}function or(s,t){if(s&1){let e=C();i(0,"button",106),_("click",function(){v(e);let o=c(2).$implicit,l=c(2);return g(l.abrirModalPago(o))}),a(1," \u{1F4B3} Confirmar y pagar "),r()}}function sr(s,t){if(s&1){let e=C();i(0,"button",107),_("click",function(){v(e);let o=c(2).$implicit,l=c(2);return g(l.cambiarEstadoReserva(o.id,"cancelada"))}),a(1," Cancelar reserva "),r()}}function dr(s,t){if(s&1){let e=C();i(0,"button",108),_("click",function(){v(e);let o=c(2).$implicit,l=c(2);return g(l.cambiarEstadoReserva(o.id,"completada"))}),a(1," Marcar como completada "),r()}}function lr(s,t){if(s&1){let e=C();i(0,"div",54)(1,"div",55)(2,"label",56),a(3," Notas de la reserva "),r(),f(4,Wi,5,1,"div",57)(5,Yi,7,3,"div",58),r(),i(6,"div",59)(7,"h4",60),a(8,"Servicios incluidos:"),r(),f(9,ar,26,12,"div",61),r(),i(10,"div",62),f(11,or,2,0,"button",63)(12,sr,2,0,"button",64)(13,dr,2,0,"button",65),i(14,"button",66),_("click",function(){v(e);let o=c().$implicit,l=c(2);return g(l.verDetalleReserva(o.id))}),a(15," Ver detalle completo "),r()()()}if(s&2){let e=c().$implicit,n=c(2);d(4),m("ngIf",!n.editandoNotas[e.id]),d(),m("ngIf",n.editandoNotas[e.id]),d(4),m("ngForOf",e.servicios),d(2),m("ngIf",e.estado==="pendiente"),d(),m("ngIf",e.estado==="pendiente"||e.estado==="confirmada"),d(),m("ngIf",e.estado==="confirmada")}}function cr(s,t){if(s&1){let e=C();i(0,"div",44)(1,"div",45)(2,"div",46)(3,"div")(4,"h3",11),a(5),r(),i(6,"p",47),a(7),r()(),i(8,"div",48)(9,"span",49),a(10),r(),i(11,"button",50),_("click",function(){let o=v(e).$implicit,l=c(2);return g(l.toggleReservaExpanded(o.id))}),b(),i(12,"svg",51),p(13,"path",52),r()()()()(),f(14,lr,16,6,"div",53),r()}if(s&2){let e=t.$implicit,n=c(2);d(5),x(" Reserva #",e.codigo_reserva," "),d(2),x(" Creada el ",n.formatearFecha(e.created_at)," "),d(2),F(n.getEstadoClasse(e.estado)),d(),x(" ",n.getEstadoTexto(e.estado)," "),d(2),V("rotate-180",n.reservaExpandida===e.id),d(2),m("ngIf",n.reservaExpandida===e.id)}}function mr(s,t){if(s&1&&(i(0,"div",42),f(1,cr,15,8,"div",43),r()),s&2){let e=c();d(),m("ngForOf",e.reservasFiltradas)}}function pr(s,t){if(s&1){let e=C();i(0,"div",109)(1,"div",110)(2,"h3",111),a(3," Confirmar pago "),r(),i(4,"div",55)(5,"p",112),a(6),r(),i(7,"p",11),a(8),r()(),i(9,"div",113)(10,"label",114),a(11," M\xE9todo de pago: "),r(),i(12,"div",69)(13,"label",4)(14,"input",115),R("ngModelChange",function(o){v(e);let l=c();return I(l.metodoPagoSeleccionado,o)||(l.metodoPagoSeleccionado=o),g(o)}),r(),i(15,"span",116),a(16,"\u{1F49C} Yape"),r()(),i(17,"label",4)(18,"input",117),R("ngModelChange",function(o){v(e);let l=c();return I(l.metodoPagoSeleccionado,o)||(l.metodoPagoSeleccionado=o),g(o)}),r(),i(19,"span",116),a(20,"\u{1F4B3} Visa"),r()(),i(21,"label",4)(22,"input",118),R("ngModelChange",function(o){v(e);let l=c();return I(l.metodoPagoSeleccionado,o)||(l.metodoPagoSeleccionado=o),g(o)}),r(),i(23,"span",116),a(24,"\u{1F4B3} Mastercard"),r()()()(),i(25,"div",119)(26,"button",120),_("click",function(){v(e);let o=c();return g(o.procesarPago())}),a(27),r(),i(28,"button",121),_("click",function(){v(e);let o=c();return g(o.cerrarModalPago())}),a(29," Cancelar "),r()()()()}if(s&2){let e=c();d(6),x(" Reserva: #",e.reservaParaPago==null?null:e.reservaParaPago.codigo_reserva," "),d(2),x(" Total de servicios: ",(e.reservaParaPago==null||e.reservaParaPago.servicios==null?null:e.reservaParaPago.servicios.length)||0," "),d(6),M("ngModel",e.metodoPagoSeleccionado),d(4),M("ngModel",e.metodoPagoSeleccionado),d(4),M("ngModel",e.metodoPagoSeleccionado),d(4),m("disabled",!e.metodoPagoSeleccionado||e.procesandoPago),d(),x(" ",e.procesandoPago?"Procesando...":"Proceder al pago"," ")}}function ur(s,t){if(s&1&&(i(0,"div")(1,"div")(2,"p",133),a(3),r(),i(4,"p",134),a(5),r()()()),s&2){let e=t.$implicit,n=c(2);F(e.emisor==="usuario"?"flex justify-end":"flex justify-start"),d(),F(e.emisor==="usuario"?"bg-blue-600 text-white max-w-xs lg:max-w-md px-3 py-2 rounded-lg":"bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-white max-w-xs lg:max-w-md px-3 py-2 rounded-lg"),d(2),k(e.mensaje),d(2),x(" ",n.formatearHora(e.created_at)," ")}}function vr(s,t){if(s&1){let e=C();i(0,"div",109)(1,"div",122)(2,"div",123)(3,"div")(4,"h3",124),a(5),r(),i(6,"p",47),a(7),r()(),i(8,"button",125),_("click",function(){v(e);let o=c();return g(o.cerrarChat())}),b(),i(9,"svg",126),p(10,"path",127),r()()(),y(),i(11,"div",128),f(12,ur,6,6,"div",129),r(),i(13,"div",130)(14,"div",71)(15,"input",131),R("ngModelChange",function(o){v(e);let l=c();return I(l.nuevoMensaje,o)||(l.nuevoMensaje=o),g(o)}),_("keyup.enter",function(){v(e);let o=c();return g(o.enviarMensaje())}),r(),i(16,"button",132),_("click",function(){v(e);let o=c();return g(o.enviarMensaje())}),a(17),r()()()()()}if(s&2){let e=c();d(5),x(" Chat con ",e.emprendedorChat==null?null:e.emprendedorChat.nombre," "),d(2),x(" Reserva #",e.reservaChat==null?null:e.reservaChat.codigo_reserva," "),d(5),m("ngForOf",e.mensajesChat),d(3),M("ngModel",e.nuevoMensaje),d(),m("disabled",!e.nuevoMensaje.trim()||e.enviandoMensaje),d(),x(" ",e.enviandoMensaje?"...":"Enviar"," ")}}var Ee=class s{misReservasService=w(we);router=w(re);themeService=w($);reservas=[];reservasFiltradas=[];estadisticas=null;loading=!0;filtroEstado="";busqueda="";reservaExpandida=null;editandoNotas={};nuevasNotas={};guardandoNotas={};editandoHorario={};datosEdicionHorario={};guardandoHorario={};mostrarModalPago=!1;reservaParaPago=null;metodoPagoSeleccionado="";procesandoPago=!1;mostrarChat=!1;reservaChat=null;emprendedorChat=null;mensajesChat=[];nuevoMensaje="";enviandoMensaje=!1;ngOnInit(){this.cargarReservas(),this.cargarEstadisticas()}cargarReservas(){this.loading=!0,this.misReservasService.getMisReservas().subscribe({next:t=>{this.reservas=t,this.aplicarFiltros(),this.loading=!1},error:t=>{console.error("Error al cargar reservas:",t),this.loading=!1}})}cargarEstadisticas(){this.misReservasService.getEstadisticasReservas().subscribe({next:t=>{this.estadisticas=t},error:t=>{console.error("Error al cargar estad\xEDsticas:",t)}})}aplicarFiltros(){this.reservasFiltradas=this.reservas.filter(t=>{let e=!this.filtroEstado||t.estado===this.filtroEstado,n=!this.busqueda||t.codigo_reserva.toLowerCase().includes(this.busqueda.toLowerCase())||t.servicios?.some(o=>o.servicio?.nombre.toLowerCase().includes(this.busqueda.toLowerCase())||o.emprendedor?.nombre.toLowerCase().includes(this.busqueda.toLowerCase()));return e&&n})}toggleReservaExpanded(t){this.reservaExpandida=this.reservaExpandida===t?null:t}iniciarEdicionNotas(t,e){this.editandoNotas[t]=!0,this.nuevasNotas[t]=e}cancelarEdicionNotas(t){this.editandoNotas[t]=!1,delete this.nuevasNotas[t]}guardarNotas(t){let e=t.id;this.guardandoNotas[e]=!0;let n=ce(Z({},t),{notas:this.nuevasNotas[e]});this.misReservasService.actualizarReserva(e,n).subscribe({next:o=>{let l=this.reservas.findIndex(u=>u.id===e);l!==-1&&(this.reservas[l]=o,this.aplicarFiltros()),this.editandoNotas[e]=!1,this.guardandoNotas[e]=!1},error:o=>{console.error("Error al guardar notas:",o),this.guardandoNotas[e]=!1}})}iniciarEdicionHorario(t){let e=t.id;this.editandoHorario[e]=!0,this.datosEdicionHorario[e]={servicioId:t.servicio_id,fecha:t.fecha_inicio.split("T")[0],horaInicio:t.hora_inicio,horaFin:t.hora_fin,verificandoDisponibilidad:!1,disponible:null}}cancelarEdicionHorario(t){this.editandoHorario[t]=!1,delete this.datosEdicionHorario[t]}verificarDisponibilidadEdicion(t){let e=this.datosEdicionHorario[t];if(!e.fecha||!e.horaInicio||!e.horaFin){e.disponible=null;return}e.verificandoDisponibilidad=!0,e.disponible=null,this.misReservasService.verificarDisponibilidad({servicio_id:e.servicioId,fecha_inicio:e.fecha,hora_inicio:e.horaInicio,hora_fin:e.horaFin,reserva_servicio_id:t}).subscribe({next:n=>{e.verificandoDisponibilidad=!1,e.disponible=n},error:n=>{console.error("Error al verificar disponibilidad:",n),e.verificandoDisponibilidad=!1,e.disponible=!1}})}guardarCambioHorario(t){let e=t.id,n=this.datosEdicionHorario[e];if(!n.disponible)return;this.guardandoHorario[e]=!0;let o=new Date(`2000-01-01T${n.horaInicio}`),u=(new Date(`2000-01-01T${n.horaFin}`).getTime()-o.getTime())/(1e3*60),h=ce(Z({},t),{fecha_inicio:n.fecha,hora_inicio:n.horaInicio,hora_fin:n.horaFin,duracion_minutos:u});this.misReservasService.cambiarEstadoServicioReserva(e,"pendiente").subscribe({next:()=>{let E=this.reservas.find(P=>P.servicios?.some(le=>le.id===e));if(E){let P=E.servicios.findIndex(le=>le.id===e);P!==-1&&(E.servicios[P]=h,this.aplicarFiltros())}this.editandoHorario[e]=!1,this.guardandoHorario[e]=!1},error:E=>{console.error("Error al guardar cambio de horario:",E),this.guardandoHorario[e]=!1}})}cambiarEstadoReserva(t,e){this.misReservasService.cambiarEstadoReserva(t,e).subscribe({next:n=>{let o=this.reservas.findIndex(l=>l.id===t);o!==-1&&(this.reservas[o]=n,this.aplicarFiltros())},error:n=>{console.error("Error al cambiar estado de reserva:",n)}})}cambiarEstadoServicio(t,e){this.misReservasService.cambiarEstadoServicioReserva(t,e).subscribe({next:n=>{let o=this.reservas.find(l=>l.servicios?.some(u=>u.id===t));if(o){let l=o.servicios.findIndex(u=>u.id===t);l!==-1&&(o.servicios[l]=n,this.aplicarFiltros())}},error:n=>{console.error("Error al cambiar estado de servicio:",n)}})}cerrarModalPago(){this.mostrarModalPago=!1,this.reservaParaPago=null,this.metodoPagoSeleccionado="",this.procesandoPago=!1}limpiarDatosPago(){this.reservaParaPago=null,this.metodoPagoSeleccionado="",this.procesandoPago=!1}abrirModalPago(t){this.reservaParaPago=t,this.mostrarModalPago=!0,this.metodoPagoSeleccionado=""}procesarPago(){if(!this.reservaParaPago||!this.metodoPagoSeleccionado)return;this.procesandoPago=!0;let t=this.reservaParaPago,e=this.metodoPagoSeleccionado;this.misReservasService.procesarPago(t.id,e).subscribe({next:n=>{if(n.success){this.mostrarModalPago=!1;let o=`/pagos/${e}`;this.router.navigate([o],{queryParams:{reserva:t.codigo_reserva,monto:this.calcularMontoTotal(t)}}).then(()=>{this.limpiarDatosPago()})}},error:n=>{console.error("Error al procesar pago:",n),this.procesandoPago=!1}})}calcularMontoTotal(t){let e=0;return t.servicios?.forEach(n=>{n.servicio?.precio_referencial&&(e+=parseFloat(n.servicio.precio_referencial.toString()))}),e||50}abrirChat(t,e){this.reservaChat=t,this.emprendedorChat=e.emprendedor,this.mostrarChat=!0,this.cargarMensajesChat(t.id,e.emprendedor_id)}cerrarChat(){this.mostrarChat=!1,this.reservaChat=null,this.emprendedorChat=null,this.mensajesChat=[],this.nuevoMensaje=""}cargarMensajesChat(t,e){this.misReservasService.getMensajesChat(t,e).subscribe({next:n=>{this.mensajesChat=n},error:n=>{console.error("Error al cargar mensajes:",n)}})}enviarMensaje(){!this.nuevoMensaje.trim()||!this.reservaChat||!this.emprendedorChat||(this.enviandoMensaje=!0,this.misReservasService.enviarMensaje({reserva_id:this.reservaChat.id,emprendedor_id:this.emprendedorChat.id,mensaje:this.nuevoMensaje.trim()}).subscribe({next:t=>{this.mensajesChat.push(t),this.nuevoMensaje="",this.enviandoMensaje=!1},error:t=>{console.error("Error al enviar mensaje:",t),this.enviandoMensaje=!1}}))}verDetalleReserva(t){this.router.navigate(["/admin/reservas/detail",t])}formatearFecha(t){return new Date(t).toLocaleDateString("es-PE",{year:"numeric",month:"long",day:"numeric"})}formatearHora(t){return new Date(t).toLocaleTimeString("es-PE",{hour:"2-digit",minute:"2-digit"})}getEstadoClasse(t){return{pendiente:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",confirmada:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",confirmado:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",completada:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",completado:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",cancelada:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",cancelado:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"}[t]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"}getEstadoTexto(t){return{pendiente:"Pendiente",confirmada:"Confirmada",confirmado:"Confirmado",completada:"Completada",completado:"Completado",cancelada:"Cancelada",cancelado:"Cancelado"}[t]||t}isDarkMode(){return this.themeService.isDarkMode()}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=H({type:s,selectors:[["app-mis-reservas"]],decls:66,vars:11,consts:[["title","Mis reservas","subtitle","Gestiona tus reservas de servicios tur\xEDsticos"],[1,"container","mx-auto","px-2","sm:px-4","py-6","bg-gray-50","dark:bg-gray-900","min-h-screen","transition-colors","duration-200"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","mb-6"],[1,"bg-white","dark:bg-gray-800","p-4","rounded-lg","shadow"],[1,"flex","items-center"],[1,"flex-shrink-0"],[1,"w-8","h-8","bg-blue-100","dark:bg-blue-900","rounded-full","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-blue-600","dark:text-blue-400"],["d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","font-medium","text-gray-500","dark:text-gray-400"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white"],[1,"w-8","h-8","bg-yellow-100","dark:bg-yellow-900","rounded-full","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-yellow-600","dark:text-yellow-400"],["d","M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z"],[1,"w-8","h-8","bg-green-100","dark:bg-green-900","rounded-full","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-green-600","dark:text-green-400"],["d","M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"],[1,"w-8","h-8","bg-purple-100","dark:bg-purple-900","rounded-full","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-purple-600","dark:text-purple-400"],[1,"bg-white","dark:bg-gray-800","p-4","rounded-lg","shadow","mb-6"],[1,"flex","flex-col","sm:flex-row","gap-4"],[1,"px-3","py-2","border","border-gray-300","dark:border-gray-600","rounded-md","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white",3,"ngModelChange","ngModel"],["value",""],["value","pendiente"],["value","confirmada"],["value","completada"],["value","cancelada"],["type","text","placeholder","Buscar por c\xF3digo o servicio...",1,"px-3","py-2","border","border-gray-300","dark:border-gray-600","rounded-md","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","flex-1",3,"ngModelChange","ngModel"],["class","text-center py-8",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","space-y-6",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",4,"ngIf"],[1,"text-center","py-8"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-blue-600","mx-auto"],[1,"mt-2","text-gray-600","dark:text-gray-400"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-16","w-16","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],[1,"mt-4","text-lg","font-medium","text-gray-900","dark:text-white"],[1,"mt-2","text-gray-500","dark:text-gray-400"],[1,"mt-4","px-4","py-2","bg-blue-600","text-white","rounded-md","hover:bg-blue-700","transition-colors",3,"routerLink"],[1,"space-y-6"],["class","bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden",4,"ngFor","ngForOf"],[1,"bg-white","dark:bg-gray-800","rounded-lg","shadow-md","overflow-hidden"],[1,"px-6","py-4","border-b","border-gray-200","dark:border-gray-700"],[1,"flex","justify-between","items-start"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"flex","items-center","space-x-2"],[1,"px-2","py-1","rounded-full","text-xs","font-medium"],[1,"p-1","text-gray-400","hover:text-gray-600","dark:hover:text-gray-300",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["class","px-6 py-4",4,"ngIf"],[1,"px-6","py-4"],[1,"mb-4"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-2"],["class","flex items-center space-x-2",4,"ngIf"],["class","space-y-2",4,"ngIf"],[1,"space-y-4"],[1,"font-medium","text-gray-900","dark:text-white"],["class","border border-gray-200 dark:border-gray-700 rounded-lg p-4",4,"ngFor","ngForOf"],[1,"mt-6","flex","flex-wrap","gap-3","pt-4","border-t","border-gray-200","dark:border-gray-700"],["class","px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",3,"click",4,"ngIf"],["class","px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",3,"click",4,"ngIf"],["class","px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",3,"click",4,"ngIf"],[1,"px-4","py-2","bg-gray-600","text-white","rounded-md","hover:bg-gray-700","transition-colors",3,"click"],[1,"text-gray-900","dark:text-white","flex-1"],[1,"text-blue-600","hover:text-blue-800","text-sm",3,"click"],[1,"space-y-2"],["rows","3","placeholder","Agregar notas...",1,"w-full","px-3","py-2","border","border-gray-300","dark:border-gray-600","rounded-md","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white",3,"ngModelChange","ngModel"],[1,"flex","space-x-2"],[1,"px-3","py-1","bg-green-600","text-white","rounded","text-sm","hover:bg-green-700","disabled:opacity-50",3,"click","disabled"],[1,"px-3","py-1","bg-gray-300","text-gray-700","rounded","text-sm","hover:bg-gray-400",3,"click"],[1,"border","border-gray-200","dark:border-gray-700","rounded-lg","p-4"],[1,"flex","items-start","space-x-4"],[4,"ngIf"],[1,"flex-1"],[1,"mt-2"],["class","text-sm text-gray-600 dark:text-gray-400",4,"ngIf"],["class","space-y-3 bg-gray-50 dark:bg-gray-700 p-3 rounded-md",4,"ngIf"],[1,"mt-3"],[1,"text-sm","text-gray-600","dark:text-gray-400"],[1,"mt-3","flex","flex-wrap","gap-2"],["class","px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700",3,"click",4,"ngIf"],["class","px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700",3,"click",4,"ngIf"],[1,"px-3","py-1","bg-blue-600","text-white","rounded","text-sm","hover:bg-blue-700",3,"click"],[1,"w-16","h-16","object-cover","rounded-lg",3,"src","alt"],[1,"w-16","h-16","bg-gray-200","dark:bg-gray-700","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"mt-2","flex","space-x-2"],["class","text-blue-600 hover:text-blue-800 text-sm",3,"click",4,"ngIf"],[1,"space-y-3","bg-gray-50","dark:bg-gray-700","p-3","rounded-md"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-3"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-1"],["type","date",1,"w-full","px-3","py-2","border","border-gray-300","dark:border-gray-600","rounded-md","text-sm",3,"ngModelChange","ngModel"],["type","time",1,"w-full","px-3","py-2","border","border-gray-300","dark:border-gray-600","rounded-md","text-sm",3,"ngModelChange","ngModel"],["class","text-sm text-blue-600 dark:text-blue-400",4,"ngIf"],["class","text-sm text-green-600 dark:text-green-400",4,"ngIf"],["class","text-sm text-red-600 dark:text-red-400",4,"ngIf"],[1,"text-sm","text-blue-600","dark:text-blue-400"],[1,"text-sm","text-green-600","dark:text-green-400"],[1,"text-sm","text-red-600","dark:text-red-400"],[1,"px-3","py-1","bg-green-600","text-white","rounded","text-sm","hover:bg-green-700",3,"click"],[1,"px-3","py-1","bg-red-600","text-white","rounded","text-sm","hover:bg-red-700",3,"click"],[1,"px-4","py-2","bg-green-600","text-white","rounded-md","hover:bg-green-700","transition-colors",3,"click"],[1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700","transition-colors",3,"click"],[1,"px-4","py-2","bg-purple-600","text-white","rounded-md","hover:bg-purple-700","transition-colors",3,"click"],[1,"fixed","inset-0","bg-black","bg-opacity-50","z-50","flex","items-center","justify-center","p-4"],[1,"bg-white","dark:bg-gray-800","rounded-lg","max-w-md","w-full","p-6"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","mb-4"],[1,"text-gray-600","dark:text-gray-400","mb-2"],[1,"mb-6"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-3"],["type","radio","value","yape",1,"form-radio","text-blue-600",3,"ngModelChange","ngModel"],[1,"ml-2","text-gray-900","dark:text-white"],["type","radio","value","visa",1,"form-radio","text-blue-600",3,"ngModelChange","ngModel"],["type","radio","value","mastercard",1,"form-radio","text-blue-600",3,"ngModelChange","ngModel"],[1,"flex","space-x-3"],[1,"flex-1","px-4","py-2","bg-green-600","text-white","rounded-md","hover:bg-green-700","disabled:opacity-50",3,"click","disabled"],[1,"px-4","py-2","bg-gray-300","text-gray-700","rounded-md","hover:bg-gray-400",3,"click"],[1,"bg-white","dark:bg-gray-800","rounded-lg","max-w-lg","w-full","h-96","flex","flex-col"],[1,"px-4","py-3","border-b","border-gray-200","dark:border-gray-700","flex","justify-between","items-center"],[1,"font-semibold","text-gray-900","dark:text-white"],[1,"text-gray-400","hover:text-gray-600","dark:hover:text-gray-300",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"flex-1","p-4","overflow-y-auto","space-y-3"],[3,"class",4,"ngFor","ngForOf"],[1,"px-4","py-3","border-t","border-gray-200","dark:border-gray-700"],["type","text","placeholder","Escribe tu mensaje...",1,"flex-1","px-3","py-2","border","border-gray-300","dark:border-gray-600","rounded-md","text-sm",3,"ngModelChange","keyup.enter","ngModel"],[1,"px-4","py-2","bg-blue-600","text-white","rounded-md","hover:bg-blue-700","disabled:opacity-50",3,"click","disabled"],[1,"text-sm"],[1,"text-xs","opacity-75","mt-1"]],template:function(e,n){e&1&&(p(0,"app-admin-header",0),i(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),b(),i(7,"svg",7),p(8,"path",8),r()()(),y(),i(9,"div",9)(10,"p",10),a(11,"Total"),r(),i(12,"p",11),a(13),r()()()(),i(14,"div",3)(15,"div",4)(16,"div",5)(17,"div",12),b(),i(18,"svg",13),p(19,"path",14),r()()(),y(),i(20,"div",9)(21,"p",10),a(22,"Pendientes"),r(),i(23,"p",11),a(24),r()()()(),i(25,"div",3)(26,"div",4)(27,"div",5)(28,"div",15),b(),i(29,"svg",16),p(30,"path",17),r()()(),y(),i(31,"div",9)(32,"p",10),a(33,"Confirmadas"),r(),i(34,"p",11),a(35),r()()()(),i(36,"div",3)(37,"div",4)(38,"div",5)(39,"div",18),b(),i(40,"svg",19),p(41,"path",8),r()()(),y(),i(42,"div",9)(43,"p",10),a(44,"Completadas"),r(),i(45,"p",11),a(46),r()()()()(),i(47,"div",20)(48,"div",21)(49,"select",22),R("ngModelChange",function(l){return I(n.filtroEstado,l)||(n.filtroEstado=l),l}),_("ngModelChange",function(){return n.aplicarFiltros()}),i(50,"option",23),a(51,"Todos los estados"),r(),i(52,"option",24),a(53,"Pendientes"),r(),i(54,"option",25),a(55,"Confirmadas"),r(),i(56,"option",26),a(57,"Completadas"),r(),i(58,"option",27),a(59,"Canceladas"),r()(),i(60,"input",28),R("ngModelChange",function(l){return I(n.busqueda,l)||(n.busqueda=l),l}),_("ngModelChange",function(){return n.aplicarFiltros()}),r()()(),f(61,Ui,4,0,"div",29)(62,qi,9,2,"div",30)(63,mr,2,1,"div",31),r(),f(64,pr,30,7,"div",32)(65,vr,18,6,"div",32)),e&2&&(d(13),k((n.estadisticas==null?null:n.estadisticas.total)||0),d(11),k((n.estadisticas==null?null:n.estadisticas.pendientes)||0),d(11),k((n.estadisticas==null?null:n.estadisticas.confirmadas)||0),d(11),k((n.estadisticas==null?null:n.estadisticas.completadas)||0),d(3),M("ngModel",n.filtroEstado),d(11),M("ngModel",n.busqueda),d(),m("ngIf",n.loading),d(),m("ngIf",!n.loading&&n.reservasFiltradas.length===0),d(),m("ngIf",!n.loading&&n.reservasFiltradas.length>0),d(),m("ngIf",n.mostrarModalPago),d(),m("ngIf",n.mostrarChat))},dependencies:[j,O,G,N,B,K,Q,q,J,be,W,Y,z],encapsulation:2})};var gr=()=>["/planes"];function _r(s,t){s&1&&(i(0,"div",41),p(1,"div",42),i(2,"p",43),a(3,"Cargando inscripciones..."),r()())}function xr(s,t){s&1&&(i(0,"div",44),b(),i(1,"svg",45),p(2,"path",46),r(),y(),i(3,"h3",47),a(4,"No tienes inscripciones"),r(),i(5,"p",48),a(6,"Comienza explorando nuestros planes tur\xEDsticos."),r(),i(7,"button",49),a(8," Explorar planes "),r()()),s&2&&(d(7),m("routerLink",ge(1,gr)))}function fr(s,t){if(s&1&&p(0,"img",88),s&2){let e,n=c(2).$implicit,o=c(2);m("src",o.getImagenUrl((e=n.plan==null?null:n.plan.imagen_principal_url)!==null&&e!==void 0?e:""),ae)("alt",n.plan==null?null:n.plan.nombre)}}function br(s,t){s&1&&(i(0,"div",89),b(),i(1,"svg",90),p(2,"path",91),r()())}function hr(s,t){if(s&1&&(i(0,"div")(1,"span",95),a(2,"Fecha inicio:"),r(),i(3,"span",96),a(4),r()()),s&2){let e=c(3).$implicit,n=c(2);d(4),x(" ",n.formatearFecha(e.fecha_inicio_plan)," ")}}function yr(s,t){if(s&1&&(i(0,"div")(1,"span",95),a(2,"Fecha fin:"),r(),i(3,"span",96),a(4),r()()),s&2){let e=c(3).$implicit,n=c(2);d(4),x(" ",n.formatearFecha(e.fecha_fin_plan)," ")}}function kr(s,t){if(s&1&&(i(0,"span"),a(1),r()),s&2){let e=c(4).$implicit,n=c(2);d(),x(" \u23F1\uFE0F Faltan ",n.getDiasParaInicio(e)," d\xEDas para el inicio ")}}function Sr(s,t){s&1&&(i(0,"span"),a(1," \u{1F389} \xA1El plan comienza hoy! "),r())}function Cr(s,t){s&1&&(i(0,"span"),a(1," \u{1F4CD} Plan en curso o finalizado "),r())}function wr(s,t){if(s&1&&(i(0,"div",97),f(1,kr,2,1,"span",77)(2,Sr,2,0,"span",77)(3,Cr,2,0,"span",77),r()),s&2){let e=c(3).$implicit,n=c(2);d(),m("ngIf",n.getDiasParaInicio(e)>0),d(),m("ngIf",n.getDiasParaInicio(e)===0),d(),m("ngIf",n.getDiasParaInicio(e)<0)}}function Er(s,t){if(s&1&&(i(0,"div",92)(1,"h4",93),a(2,"\u{1F4C5} Fechas del plan"),r(),i(3,"div",71),f(4,hr,5,1,"div",77)(5,yr,5,1,"div",77),r(),f(6,wr,4,3,"div",94),r()),s&2){let e=c(2).$implicit,n=c(2);d(4),m("ngIf",e.fecha_inicio_plan),d(),m("ngIf",e.fecha_fin_plan),d(),m("ngIf",n.getDiasParaInicio(e)!==null)}}function Mr(s,t){if(s&1&&(i(0,"div")(1,"h4",98),a(2,"Requerimientos especiales:"),r(),i(3,"p",99),a(4),r()()),s&2){let e=c(2).$implicit;d(4),x(" ",e.requerimientos_especiales," ")}}function Ir(s,t){if(s&1&&(i(0,"div")(1,"h4",98),a(2,"Comentarios adicionales:"),r(),i(3,"p",100),a(4),r()()),s&2){let e=c(2).$implicit;d(4),x(" ",e.comentarios_adicionales," ")}}function Rr(s,t){if(s&1&&(i(0,"div",75)(1,"h4",98),a(2,"\u{1F4DD} Notas del organizador:"),r(),i(3,"p",101),a(4),r()()),s&2){let e=c(2).$implicit;d(4),x(" ",e.notas," ")}}function Tr(s,t){if(s&1){let e=C();i(0,"button",102),_("click",function(){v(e);let o=c(2).$implicit,l=c(2);return g(l.abrirModalPago(o))}),b(),i(1,"svg",84),p(2,"path",103),r(),a(3," Proceder al pago "),r()}}function Vr(s,t){if(s&1){let e=C();i(0,"button",104),_("click",function(){v(e);let o=c(2).$implicit,l=c(2);return g(l.cancelarInscripcion(o))}),b(),i(1,"svg",84),p(2,"path",105),r(),a(3," Cancelar inscripci\xF3n "),r()}}function Fr(s,t){if(s&1){let e=C();i(0,"button",106),_("click",function(){v(e);let o=c(2).$implicit,l=c(2);return g(l.marcarComoCompletada(o))}),b(),i(1,"svg",84),p(2,"path",107),r(),a(3," Marcar como completada "),r()}}function Pr(s,t){if(s&1){let e=C();i(0,"button",108),_("click",function(){v(e);let o=c(2).$implicit,l=c(2);return g(l.editarInscripcion(o))}),b(),i(1,"svg",84),p(2,"path",109),r(),a(3," Editar "),r()}}function Dr(s,t){if(s&1){let e=C();i(0,"div",64)(1,"div",65)(2,"div",66)(3,"div",67),f(4,fr,1,2,"img",68)(5,br,3,0,"div",69),r(),i(6,"div",55)(7,"p",70),a(8),r(),i(9,"div",71)(10,"div")(11,"span",72),a(12,"Organizador:"),r(),i(13,"span",73),a(14),r()(),i(15,"div")(16,"span",72),a(17,"Dificultad:"),r(),i(18,"span",73),a(19),r()(),i(20,"div")(21,"span",72),a(22,"Precio total:"),r(),i(23,"span",73),a(24),r()(),i(25,"div")(26,"span",72),a(27,"M\xE9todo de pago:"),r(),i(28,"span",73),a(29),r()()()()()(),f(30,Er,7,3,"div",74),i(31,"div",75)(32,"div",76),f(33,Mr,5,1,"div",77)(34,Ir,5,1,"div",77),r()(),f(35,Rr,5,1,"div",78),i(36,"div",79),f(37,Tr,4,0,"button",80)(38,Vr,4,0,"button",81)(39,Fr,4,0,"button",82),i(40,"button",83),_("click",function(){v(e);let o=c().$implicit,l=c(2);return g(l.verDetallePlan(o.plan_id))}),b(),i(41,"svg",84),p(42,"path",85)(43,"path",86),r(),a(44," Ver detalle del plan "),r(),f(45,Pr,4,0,"button",87),r()()}if(s&2){let e=c().$implicit,n=c(2);d(4),m("ngIf",e.plan==null?null:e.plan.imagen_principal_url),d(),m("ngIf",!(e.plan!=null&&e.plan.imagen_principal_url)),d(3),x(" ",e.plan==null?null:e.plan.descripcion," "),d(6),x(" ",(e.plan==null||e.plan.organizador_principal==null?null:e.plan.organizador_principal.nombre)||"No especificado"," "),d(5),x(" ",n.getDificultadLabel(e.plan==null?null:e.plan.dificultad)," "),d(5),x(" S/ ",e.precio_total_calculado||((e.plan==null?null:e.plan.precio_total)||0)*e.numero_participantes," "),d(5),x(" ",n.getMetodoPagoTexto(e.metodo_pago)," "),d(),m("ngIf",e.fecha_inicio_plan||e.fecha_fin_plan),d(3),m("ngIf",e.requerimientos_especiales),d(),m("ngIf",e.comentarios_adicionales),d(),m("ngIf",e.notas),d(2),m("ngIf",e.estado==="pendiente"),d(),m("ngIf",e.estado==="pendiente"||e.estado==="confirmada"),d(),m("ngIf",e.estado==="confirmada"||e.estado==="en_progreso"),d(6),m("ngIf",e.estado==="pendiente")}}function Lr(s,t){if(s&1){let e=C();i(0,"div",52)(1,"div",53)(2,"div",54)(3,"div",55)(4,"h3",11),a(5),r(),i(6,"p",56),a(7),r(),i(8,"p",57),a(9),r()(),i(10,"div",58)(11,"span",59),a(12),r(),i(13,"button",60),_("click",function(){let o=v(e).$implicit,l=c(2);return g(l.toggleInscripcionExpanded(o.id))}),b(),i(14,"svg",61),p(15,"path",62),r()()()()(),f(16,Dr,46,15,"div",63),r()}if(s&2){let e=t.$implicit,n=c(2);d(5),x(" ",e.plan==null?null:e.plan.nombre," "),d(2),x(" Inscrito el ",n.formatearFecha(e.created_at)," "),d(2),D(" ",e.numero_participantes," participante(s) \u2022 ",e.plan==null?null:e.plan.duracion_dias," d\xEDa(s) "),d(2),F(n.getEstadoClasse(e.estado)),d(),x(" ",n.getEstadoTexto(e.estado)," "),d(2),V("rotate-180",n.inscripcionExpandida()===e.id),d(2),m("ngIf",n.inscripcionExpandida()===e.id)}}function Hr(s,t){if(s&1&&(i(0,"div",50),f(1,Lr,17,10,"div",51),r()),s&2){let e=c();d(),m("ngForOf",e.inscripcionesFiltradas())}}function jr(s,t){if(s&1){let e=C();i(0,"div",110)(1,"nav",58)(2,"button",111),_("click",function(){v(e);let o=c();return g(o.cambiarPagina(o.paginaActual-1))}),a(3," Anterior "),r(),i(4,"span",112),a(5),r(),i(6,"button",111),_("click",function(){v(e);let o=c();return g(o.cambiarPagina(o.paginaActual+1))}),a(7," Siguiente "),r()()()}if(s&2){let e=c();d(2),m("disabled",e.paginaActual===1),d(3),D(" P\xE1gina ",e.paginaActual," de ",e.totalPaginas()," "),d(),m("disabled",e.paginaActual===e.totalPaginas())}}function Ar(s,t){if(s&1){let e=C();i(0,"div",113)(1,"div",114)(2,"h3",115),a(3," Proceder al pago "),r(),i(4,"div",75)(5,"p",116),a(6),r(),i(7,"p",11),a(8),r()(),i(9,"div",65)(10,"label",117),a(11," M\xE9todo de pago: "),r(),i(12,"div",118)(13,"label",4)(14,"input",119),R("ngModelChange",function(o){v(e);let l=c();return I(l.metodoPagoSeleccionado,o)||(l.metodoPagoSeleccionado=o),g(o)}),r(),i(15,"span",120),a(16,"\u{1F49C} Yape"),r()(),i(17,"label",4)(18,"input",121),R("ngModelChange",function(o){v(e);let l=c();return I(l.metodoPagoSeleccionado,o)||(l.metodoPagoSeleccionado=o),g(o)}),r(),i(19,"span",120),a(20,"\u{1F4B3} Visa"),r()(),i(21,"label",4)(22,"input",122),R("ngModelChange",function(o){v(e);let l=c();return I(l.metodoPagoSeleccionado,o)||(l.metodoPagoSeleccionado=o),g(o)}),r(),i(23,"span",120),a(24,"\u{1F4B3} Mastercard"),r()()()(),i(25,"div",123)(26,"button",124),_("click",function(){v(e);let o=c();return g(o.procesarPago())}),a(27),r(),i(28,"button",125),_("click",function(){v(e);let o=c();return g(o.cerrarModalPago())}),a(29," Cancelar "),r()()()()}if(s&2){let e,n,o=c();d(6),x(" Plan: ",(e=o.inscripcionParaPago())==null||e.plan==null?null:e.plan.nombre," "),d(2),x(" Total: S/ ",((n=o.inscripcionParaPago())==null?null:n.precio_total_calculado)||(((n=o.inscripcionParaPago())==null||n.plan==null?null:n.plan.precio_total)||0)*(((n=o.inscripcionParaPago())==null?null:n.numero_participantes)||1)," "),d(6),M("ngModel",o.metodoPagoSeleccionado),d(4),M("ngModel",o.metodoPagoSeleccionado),d(4),M("ngModel",o.metodoPagoSeleccionado),d(4),m("disabled",!o.metodoPagoSeleccionado()||o.procesandoPago()),d(),x(" ",o.procesandoPago()?"Procesando...":"Proceder al pago"," ")}}function Br(s,t){if(s&1){let e=C();i(0,"div",113)(1,"div",126)(2,"h3",115),a(3," Editar inscripci\xF3n "),r(),i(4,"div",127)(5,"div")(6,"label",128),a(7," N\xFAmero de participantes "),r(),i(8,"div",58)(9,"button",129),_("click",function(){v(e);let o=c();return g(o.decrementarParticipantes())}),a(10," - "),r(),i(11,"input",130),R("ngModelChange",function(o){v(e);let l=c();return I(l.datosEdicion.numero_participantes,o)||(l.datosEdicion.numero_participantes=o),g(o)}),r(),i(12,"button",129),_("click",function(){v(e);let o=c();return g(o.incrementarParticipantes())}),a(13," + "),r()()(),i(14,"div")(15,"label",128),a(16," M\xE9todo de pago "),r(),i(17,"select",131),R("ngModelChange",function(o){v(e);let l=c();return I(l.datosEdicion.metodo_pago,o)||(l.datosEdicion.metodo_pago=o),g(o)}),i(18,"option",132),a(19,"Efectivo"),r(),i(20,"option",133),a(21,"Transferencia"),r(),i(22,"option",134),a(23,"Yape"),r(),i(24,"option",135),a(25,"Plin"),r()()(),i(26,"div")(27,"label",128),a(28," Requerimientos especiales "),r(),i(29,"textarea",136),R("ngModelChange",function(o){v(e);let l=c();return I(l.datosEdicion.requerimientos_especiales,o)||(l.datosEdicion.requerimientos_especiales=o),g(o)}),r()(),i(30,"div")(31,"label",128),a(32," Comentarios adicionales "),r(),i(33,"textarea",136),R("ngModelChange",function(o){v(e);let l=c();return I(l.datosEdicion.comentarios_adicionales,o)||(l.datosEdicion.comentarios_adicionales=o),g(o)}),r()()(),i(34,"div",137)(35,"button",138),_("click",function(){v(e);let o=c();return g(o.guardarEdicion())}),a(36),r(),i(37,"button",125),_("click",function(){v(e);let o=c();return g(o.cerrarModalEdicion())}),a(38," Cancelar "),r()()()()}if(s&2){let e=c();d(11),M("ngModel",e.datosEdicion.numero_participantes),d(6),M("ngModel",e.datosEdicion.metodo_pago),d(12),M("ngModel",e.datosEdicion.requerimientos_especiales),d(4),M("ngModel",e.datosEdicion.comentarios_adicionales),d(2),m("disabled",e.guardandoEdicion()),d(),x(" ",e.guardandoEdicion()?"Guardando...":"Guardar cambios"," ")}}function Or(s,t){if(s&1){let e=C();i(0,"div",113)(1,"div",114)(2,"h3",115),a(3," Cancelar inscripci\xF3n "),r(),i(4,"p",139),a(5),r(),i(6,"div",75)(7,"label",128),a(8," Motivo de cancelaci\xF3n (opcional) "),r(),i(9,"textarea",140),R("ngModelChange",function(o){v(e);let l=c();return I(l.motivoCancelacion,o)||(l.motivoCancelacion=o),g(o)}),r()(),i(10,"div",123)(11,"button",141),_("click",function(){v(e);let o=c();return g(o.confirmarCancelacion())}),a(12),r(),i(13,"button",125),_("click",function(){v(e);let o=c();return g(o.cerrarModalCancelacion())}),a(14," Mantener inscripci\xF3n "),r()()()()}if(s&2){let e,n=c();d(5),x(' \xBFEst\xE1s seguro de que deseas cancelar tu inscripci\xF3n al plan "',(e=n.inscripcionParaCancelar())==null||e.plan==null?null:e.plan.nombre,'"? '),d(4),M("ngModel",n.motivoCancelacion),d(2),m("disabled",n.cancelandoInscripcion()),d(),x(" ",n.cancelandoInscripcion()?"Cancelando...":"Confirmar cancelaci\xF3n"," ")}}var Me=class s{env=oe;planesService=w(We);authService=w(Be);themeService=w($);router=w(re);loading=S(!1);inscripciones=S([]);estadisticas=S(null);totalElementos=S(0);totalPaginas=S(1);inscripcionExpandida=S(null);mostrarModalPago=S(!1);mostrarModalEdicion=S(!1);mostrarModalCancelacion=S(!1);inscripcionParaPago=S(null);inscripcionParaEditar=S(null);inscripcionParaCancelar=S(null);procesandoPago=S(!1);guardandoEdicion=S(!1);cancelandoInscripcion=S(!1);metodoPagoSeleccionado=S("");filtroEstado="";busqueda="";paginaActual=1;datosEdicion={};motivoCancelacion="";inscripcionesFiltradas=U(()=>{let t=this.inscripciones();if(this.filtroEstado&&(t=t.filter(e=>e.estado===this.filtroEstado)),this.busqueda){let e=this.busqueda.toLowerCase();t=t.filter(n=>n.plan?.nombre.toLowerCase().includes(e))}return t});ngOnInit(){this.cargarInscripciones(),this.calcularEstadisticas()}cargarInscripciones(){this.loading.set(!0),this.planesService.getMisInscripciones(this.paginaActual,this.filtroEstado).subscribe({next:t=>{if(this.inscripciones.set(t.data),"meta"in t){let e=t.meta;this.totalElementos.set(e.total||0),this.totalPaginas.set(e.last_page||1)}else if("total"in t){let e=t.total||0,n=t.per_page||10;this.totalElementos.set(e),this.totalPaginas.set(Math.ceil(e/n))}else{let e=t.data??[];this.totalElementos.set(e.length),this.totalPaginas.set(1)}this.loading.set(!1),this.calcularEstadisticas()},error:t=>{console.error("Error al cargar inscripciones:",t),this.loading.set(!1)}})}calcularEstadisticas(){let t=this.inscripciones(),e={total:this.totalElementos(),pendientes:t.filter(n=>n.estado==="pendiente").length,confirmadas:t.filter(n=>n.estado==="confirmada").length,canceladas:t.filter(n=>n.estado==="cancelada").length,completadas:t.filter(n=>n.estado==="completada").length,en_progreso:t.filter(n=>n.estado==="en_progreso").length};this.estadisticas.set(e)}aplicarFiltros(){this.paginaActual=1,this.cargarInscripciones()}cambiarPagina(t){t>=1&&t<=this.totalPaginas()&&(this.paginaActual=t,this.cargarInscripciones())}toggleInscripcionExpanded(t){let e=this.inscripcionExpandida();this.inscripcionExpandida.set(e===t?null:t)}abrirModalPago(t){this.inscripcionParaPago.set(t),this.mostrarModalPago.set(!0),this.metodoPagoSeleccionado.set("yape")}cerrarModalPago(){this.mostrarModalPago.set(!1),this.inscripcionParaPago.set(null),this.metodoPagoSeleccionado.set(""),this.procesandoPago.set(!1)}procesarPago(){let t=this.inscripcionParaPago(),e=this.metodoPagoSeleccionado();if(!t||!e)return;this.procesandoPago.set(!0);let n=t.precio_total_calculado||(t.plan?.precio_total||0)*t.numero_participantes;this.cerrarModalPago();let o=`/pagos/${e}`;this.router.navigate([o],{queryParams:{inscripcion:t.id,plan:t.plan?.nombre,monto:n}})}editarInscripcion(t){this.inscripcionParaEditar.set(t),this.datosEdicion={numero_participantes:t.numero_participantes,metodo_pago:t.metodo_pago,requerimientos_especiales:t.requerimientos_especiales||"",comentarios_adicionales:t.comentarios_adicionales||""},this.mostrarModalEdicion.set(!0)}cerrarModalEdicion(){this.mostrarModalEdicion.set(!1),this.inscripcionParaEditar.set(null),this.datosEdicion={},this.guardandoEdicion.set(!1)}incrementarParticipantes(){this.datosEdicion.numero_participantes=Math.max(1,this.datosEdicion.numero_participantes+1)}decrementarParticipantes(){this.datosEdicion.numero_participantes=Math.max(1,this.datosEdicion.numero_participantes-1)}guardarEdicion(){let t=this.inscripcionParaEditar();t&&(this.guardandoEdicion.set(!0),this.planesService.updateInscripcion(t.id,this.datosEdicion).subscribe({next:e=>{let n=this.inscripciones(),o=n.findIndex(l=>l.id===t.id);o!==-1&&(n[o]=e,this.inscripciones.set([...n])),this.cerrarModalEdicion()},error:e=>{console.error("Error al actualizar inscripci\xF3n:",e),this.guardandoEdicion.set(!1)}}))}cancelarInscripcion(t){this.inscripcionParaCancelar.set(t),this.motivoCancelacion="",this.mostrarModalCancelacion.set(!0)}cerrarModalCancelacion(){this.mostrarModalCancelacion.set(!1),this.inscripcionParaCancelar.set(null),this.motivoCancelacion="",this.cancelandoInscripcion.set(!1)}confirmarCancelacion(){let t=this.inscripcionParaCancelar();t&&(this.cancelandoInscripcion.set(!0),this.planesService.cancelarInscripcion(t.id,this.motivoCancelacion).subscribe({next:e=>{let n=this.inscripciones(),o=n.findIndex(l=>l.id===t.id);o!==-1&&(n[o]=e,this.inscripciones.set([...n])),this.calcularEstadisticas(),this.cerrarModalCancelacion()},error:e=>{console.error("Error al cancelar inscripci\xF3n:",e),this.cancelandoInscripcion.set(!1)}}))}marcarComoCompletada(t){let e=prompt("Comentarios sobre la experiencia (opcional):");this.planesService.marcarCompletada(t.id,e||void 0).subscribe({next:n=>{let o=this.inscripciones(),l=o.findIndex(u=>u.id===t.id);l!==-1&&(o[l]=n,this.inscripciones.set([...o])),this.calcularEstadisticas()},error:n=>{console.error("Error al marcar como completada:",n)}})}verDetallePlan(t){this.router.navigate(["/planes",t])}formatearFecha(t){return new Date(t).toLocaleDateString("es-PE",{year:"numeric",month:"long",day:"numeric"})}getDiasParaInicio(t){if(!t.fecha_inicio_plan)return null;let e=new Date,o=new Date(t.fecha_inicio_plan).getTime()-e.getTime();return Math.ceil(o/(1e3*60*60*24))}getEstadoClasse(t){return{pendiente:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",confirmada:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",en_progreso:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",completada:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",cancelada:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"}[t]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"}getEstadoTexto(t){return{pendiente:"Pendiente",confirmada:"Confirmada",en_progreso:"En progreso",completada:"Completada",cancelada:"Cancelada"}[t]||t}getMetodoPagoTexto(t){return t?{efectivo:"Efectivo",transferencia:"Transferencia",yape:"Yape",plin:"Plin",tarjeta:"Tarjeta"}[t]||t:"No especificado"}getDificultadLabel(t){return t?{facil:"F\xE1cil",moderado:"Moderado",dificil:"Dif\xEDcil"}[t]||t:"No especificado"}getImagenUrl(t){return t.startsWith("http")?t:`${this.env.assetsUrl}${t}`}isDarkMode(){return this.themeService.isDarkMode()}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=H({type:s,selectors:[["app-mis-inscripciones"]],decls:85,vars:14,consts:[["title","Mis inscripciones","subtitle","Gestiona tus inscripciones a planes tur\xEDsticos"],[1,"container","mx-auto","px-2","sm:px-4","py-6","bg-gray-50","dark:bg-gray-900","min-h-screen","transition-colors","duration-200"],[1,"grid","grid-cols-1","md:grid-cols-5","gap-4","mb-6"],[1,"bg-white","dark:bg-gray-800","p-4","rounded-lg","shadow"],[1,"flex","items-center"],[1,"flex-shrink-0"],[1,"w-8","h-8","bg-blue-100","dark:bg-blue-900","rounded-full","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-blue-600","dark:text-blue-400"],["d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","font-medium","text-gray-500","dark:text-gray-400"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white"],[1,"w-8","h-8","bg-yellow-100","dark:bg-yellow-900","rounded-full","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-yellow-600","dark:text-yellow-400"],["d","M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z"],[1,"w-8","h-8","bg-green-100","dark:bg-green-900","rounded-full","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-green-600","dark:text-green-400"],["d","M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"],[1,"w-8","h-8","bg-purple-100","dark:bg-purple-900","rounded-full","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-purple-600","dark:text-purple-400"],["d","M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z"],[1,"w-8","h-8","bg-indigo-100","dark:bg-indigo-900","rounded-full","flex","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-indigo-600","dark:text-indigo-400"],[1,"bg-white","dark:bg-gray-800","p-4","rounded-lg","shadow","mb-6"],[1,"flex","flex-col","sm:flex-row","gap-4"],[1,"px-3","py-2","border","border-gray-300","dark:border-gray-600","rounded-md","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white",3,"ngModelChange","ngModel"],["value",""],["value","pendiente"],["value","confirmada"],["value","en_progreso"],["value","completada"],["value","cancelada"],["type","text","placeholder","Buscar por nombre del plan...",1,"px-3","py-2","border","border-gray-300","dark:border-gray-600","rounded-md","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","flex-1",3,"ngModelChange","ngModel"],[1,"px-4","py-2","bg-blue-600","text-white","rounded-md","hover:bg-blue-700","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","inline","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],["class","text-center py-8",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","space-y-6",4,"ngIf"],["class","flex justify-center mt-8",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",4,"ngIf"],[1,"text-center","py-8"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-blue-600","mx-auto"],[1,"mt-2","text-gray-600","dark:text-gray-400"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-16","w-16","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"],[1,"mt-4","text-lg","font-medium","text-gray-900","dark:text-white"],[1,"mt-2","text-gray-500","dark:text-gray-400"],[1,"mt-4","px-4","py-2","bg-blue-600","text-white","rounded-md","hover:bg-blue-700","transition-colors",3,"routerLink"],[1,"space-y-6"],["class","bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden",4,"ngFor","ngForOf"],[1,"bg-white","dark:bg-gray-800","rounded-lg","shadow-md","overflow-hidden"],[1,"px-6","py-4","border-b","border-gray-200","dark:border-gray-700"],[1,"flex","justify-between","items-start"],[1,"flex-1"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"text-sm","text-gray-600","dark:text-gray-300","mt-1"],[1,"flex","items-center","space-x-2"],[1,"px-2","py-1","rounded-full","text-xs","font-medium"],[1,"p-1","text-gray-400","hover:text-gray-600","dark:hover:text-gray-300",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["class","px-6 py-4",4,"ngIf"],[1,"px-6","py-4"],[1,"mb-6"],[1,"flex","items-start","space-x-4"],[1,"w-20","h-20","flex-shrink-0"],["class","w-full h-full object-cover rounded-lg",3,"src","alt",4,"ngIf"],["class","w-full h-full bg-gray-200 dark:bg-gray-700 rounded-lg flex items-center justify-center",4,"ngIf"],[1,"text-gray-600","dark:text-gray-300","text-sm","mb-2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","text-sm"],[1,"font-medium","text-gray-700","dark:text-gray-300"],[1,"text-gray-600","dark:text-gray-400","ml-1"],["class","mb-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",4,"ngIf"],[1,"mb-4"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[4,"ngIf"],["class","mb-4",4,"ngIf"],[1,"flex","flex-wrap","gap-3","pt-4","border-t","border-gray-200","dark:border-gray-700"],["class","px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors flex items-center gap-2",3,"click",4,"ngIf"],["class","px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors flex items-center gap-2",3,"click",4,"ngIf"],["class","px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors flex items-center gap-2",3,"click",4,"ngIf"],[1,"px-4","py-2","bg-blue-600","text-white","rounded-md","hover:bg-blue-700","transition-colors","flex","items-center","gap-2",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["class","px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors flex items-center gap-2",3,"click",4,"ngIf"],[1,"w-full","h-full","object-cover","rounded-lg",3,"src","alt"],[1,"w-full","h-full","bg-gray-200","dark:bg-gray-700","rounded-lg","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"mb-4","p-4","bg-blue-50","dark:bg-blue-900/20","rounded-lg"],[1,"font-medium","text-blue-800","dark:text-blue-300","mb-2"],["class","mt-2 text-sm text-blue-600 dark:text-blue-400",4,"ngIf"],[1,"font-medium","text-blue-700","dark:text-blue-400"],[1,"text-blue-600","dark:text-blue-300","ml-1"],[1,"mt-2","text-sm","text-blue-600","dark:text-blue-400"],[1,"font-medium","text-gray-700","dark:text-gray-300","mb-2"],[1,"text-gray-600","dark:text-gray-400","text-sm","bg-yellow-50","dark:bg-yellow-900/20","p-3","rounded"],[1,"text-gray-600","dark:text-gray-400","text-sm","bg-gray-50","dark:bg-gray-700","p-3","rounded"],[1,"text-gray-600","dark:text-gray-400","text-sm","bg-green-50","dark:bg-green-900/20","p-3","rounded"],[1,"px-4","py-2","bg-green-600","text-white","rounded-md","hover:bg-green-700","transition-colors","flex","items-center","gap-2",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"],[1,"px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700","transition-colors","flex","items-center","gap-2",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"px-4","py-2","bg-purple-600","text-white","rounded-md","hover:bg-purple-700","transition-colors","flex","items-center","gap-2",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"px-4","py-2","bg-gray-600","text-white","rounded-md","hover:bg-gray-700","transition-colors","flex","items-center","gap-2",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"flex","justify-center","mt-8"],[1,"px-3","py-2","text-gray-500","bg-white","border","border-gray-300","rounded-md","hover:bg-gray-50","disabled:opacity-50","disabled:cursor-not-allowed","dark:bg-gray-800","dark:border-gray-600","dark:text-gray-400","dark:hover:bg-gray-700",3,"click","disabled"],[1,"px-4","py-2","text-gray-700","dark:text-gray-300"],[1,"fixed","inset-0","bg-black","bg-opacity-50","z-50","flex","items-center","justify-center","p-4"],[1,"bg-white","dark:bg-gray-800","rounded-lg","max-w-md","w-full","p-6"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","mb-4"],[1,"text-gray-600","dark:text-gray-400","mb-2"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-3"],[1,"space-y-2"],["type","radio","value","yape",1,"form-radio","text-blue-600",3,"ngModelChange","ngModel"],[1,"ml-2","text-gray-900","dark:text-white"],["type","radio","value","visa",1,"form-radio","text-blue-600",3,"ngModelChange","ngModel"],["type","radio","value","mastercard",1,"form-radio","text-blue-600",3,"ngModelChange","ngModel"],[1,"flex","space-x-3"],[1,"flex-1","px-4","py-2","bg-green-600","text-white","rounded-md","hover:bg-green-700","disabled:opacity-50",3,"click","disabled"],[1,"px-4","py-2","bg-gray-300","text-gray-700","rounded-md","hover:bg-gray-400",3,"click"],[1,"bg-white","dark:bg-gray-800","rounded-lg","max-w-lg","w-full","p-6"],[1,"space-y-4"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-2"],["type","button",1,"px-3","py-2","bg-gray-200","dark:bg-gray-600","rounded-md","hover:bg-gray-300","dark:hover:bg-gray-500",3,"click"],["type","number","min","1",1,"w-20","text-center","px-3","py-2","border","border-gray-300","dark:border-gray-600","rounded-md","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white",3,"ngModelChange","ngModel"],[1,"w-full","px-3","py-2","border","border-gray-300","dark:border-gray-600","rounded-md","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white",3,"ngModelChange","ngModel"],["value","efectivo"],["value","transferencia"],["value","yape"],["value","plin"],["rows","3",1,"w-full","px-3","py-2","border","border-gray-300","dark:border-gray-600","rounded-md","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white",3,"ngModelChange","ngModel"],[1,"flex","space-x-3","mt-6"],[1,"flex-1","px-4","py-2","bg-blue-600","text-white","rounded-md","hover:bg-blue-700","disabled:opacity-50",3,"click","disabled"],[1,"text-gray-600","dark:text-gray-400","mb-4"],["rows","3","placeholder","Explica el motivo de la cancelaci\xF3n...",1,"w-full","px-3","py-2","border","border-gray-300","dark:border-gray-600","rounded-md","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white",3,"ngModelChange","ngModel"],[1,"flex-1","px-4","py-2","bg-red-600","text-white","rounded-md","hover:bg-red-700","disabled:opacity-50",3,"click","disabled"]],template:function(e,n){if(e&1&&(p(0,"app-admin-header",0),i(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),b(),i(7,"svg",7),p(8,"path",8),r()()(),y(),i(9,"div",9)(10,"p",10),a(11,"Total"),r(),i(12,"p",11),a(13),r()()()(),i(14,"div",3)(15,"div",4)(16,"div",5)(17,"div",12),b(),i(18,"svg",13),p(19,"path",14),r()()(),y(),i(20,"div",9)(21,"p",10),a(22,"Pendientes"),r(),i(23,"p",11),a(24),r()()()(),i(25,"div",3)(26,"div",4)(27,"div",5)(28,"div",15),b(),i(29,"svg",16),p(30,"path",17),r()()(),y(),i(31,"div",9)(32,"p",10),a(33,"Confirmadas"),r(),i(34,"p",11),a(35),r()()()(),i(36,"div",3)(37,"div",4)(38,"div",5)(39,"div",18),b(),i(40,"svg",19),p(41,"path",20),r()()(),y(),i(42,"div",9)(43,"p",10),a(44,"En progreso"),r(),i(45,"p",11),a(46),r()()()(),i(47,"div",3)(48,"div",4)(49,"div",5)(50,"div",21),b(),i(51,"svg",22),p(52,"path",8),r()()(),y(),i(53,"div",9)(54,"p",10),a(55,"Completadas"),r(),i(56,"p",11),a(57),r()()()()(),i(58,"div",23)(59,"div",24)(60,"select",25),R("ngModelChange",function(l){return I(n.filtroEstado,l)||(n.filtroEstado=l),l}),_("ngModelChange",function(){return n.aplicarFiltros()}),i(61,"option",26),a(62,"Todos los estados"),r(),i(63,"option",27),a(64,"Pendientes"),r(),i(65,"option",28),a(66,"Confirmadas"),r(),i(67,"option",29),a(68,"En progreso"),r(),i(69,"option",30),a(70,"Completadas"),r(),i(71,"option",31),a(72,"Canceladas"),r()(),i(73,"input",32),R("ngModelChange",function(l){return I(n.busqueda,l)||(n.busqueda=l),l}),_("ngModelChange",function(){return n.aplicarFiltros()}),r(),i(74,"button",33),_("click",function(){return n.cargarInscripciones()}),b(),i(75,"svg",34),p(76,"path",35),r(),a(77," Actualizar "),r()()(),f(78,_r,4,0,"div",36)(79,xr,9,2,"div",37)(80,Hr,2,1,"div",38)(81,jr,8,4,"div",39),r(),f(82,Ar,30,7,"div",40)(83,Br,39,6,"div",40)(84,Or,15,4,"div",40)),e&2){let o,l,u,h,E;d(13),k(((o=n.estadisticas())==null?null:o.total)||0),d(11),k(((l=n.estadisticas())==null?null:l.pendientes)||0),d(11),k(((u=n.estadisticas())==null?null:u.confirmadas)||0),d(11),k(((h=n.estadisticas())==null?null:h.en_progreso)||0),d(11),k(((E=n.estadisticas())==null?null:E.completadas)||0),d(3),M("ngModel",n.filtroEstado),d(13),M("ngModel",n.busqueda),d(5),m("ngIf",n.loading()),d(),m("ngIf",!n.loading()&&n.inscripcionesFiltradas().length===0),d(),m("ngIf",!n.loading()&&n.inscripcionesFiltradas().length>0),d(),m("ngIf",!n.loading()&&n.totalPaginas()>1),d(),m("ngIf",n.mostrarModalPago()),d(),m("ngIf",n.mostrarModalEdicion()),d(),m("ngIf",n.mostrarModalCancelacion())}},dependencies:[j,O,G,N,B,K,Q,q,fe,J,be,W,he,Y,z],encapsulation:2})};var Xa=[{path:"",component:me},{path:"create",component:pe},{path:"edit/:id",component:pe},{path:"detail/:id",component:ke},{path:"calendario",component:Se},{path:"servicio/:id",component:Ce},{path:"emprendedor/:id",component:me},{path:"mis-reservas",component:Ee},{path:"mis-inscripciones",component:Me}];export{Xa as RESERVAS_ROUTES};
