import{a as re}from"./chunk-Q4BI35PW.js";import{a as te}from"./chunk-2AOXUUAG.js";import{a as ie}from"./chunk-CABJRNYG.js";import{a as q,b as P,c as S,d as D,e as O,f as C,i as B,j as z,l as U,m as R,n as J,o as K,p as $,q as W,r as Q,t as X,w as Y,x as Z,z as ee}from"./chunk-KTW5JVGU.js";import{d as G,f as L,g as A,l as j}from"./chunk-XR3SD2KY.js";import{Gb as a,Hb as E,Hc as H,Ib as k,Ja as T,La as d,Qb as V,Va as I,_ as w,_a as v,fb as s,ga as u,ha as b,hb as h,ia as p,ja as f,ob as t,pb as r,qb as c,tb as x,ub as _,vb as m,vc as M,wc as N}from"./chunk-ETYZCZA5.js";import{a as F,b as y}from"./chunk-4CLCTAJ7.js";var ne=o=>["/admin-emprendedores/emprendimiento",o,"servicios"];function ae(o,i){if(o&1){let e=x();t(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7),p(),t(4,"svg",8),c(5,"path",9),r()(),f(),t(6,"div",10)(7,"p",11),a(8),r()(),t(9,"div",12)(10,"button",13),_("click",function(){u(e);let l=m();return b(l.success="")}),p(),t(11,"svg",14),c(12,"path",15),r()()()()()()}if(o&2){let e=m();d(8),E(e.success)}}function le(o,i){o&1&&(t(0,"div",16)(1,"div",17),c(2,"div",18)(3,"div",19),r()())}function de(o,i){if(o&1){let e=x();t(0,"div",20)(1,"div",21)(2,"div",6)(3,"div",7),p(),t(4,"svg",22),c(5,"path",23),r()(),f(),t(6,"div",10)(7,"h3",24),a(8,"Error al cargar el formulario"),r(),t(9,"p",25),a(10),r(),t(11,"button",26),_("click",function(){u(e);let l=m();return b(l.retryLoad())}),a(12," Reintentar "),r()()()()()}if(o&2){let e=m();d(10),E(e.error)}}function se(o,i){if(o&1&&(t(0,"li"),a(1),r()),o&2){let e=i.$implicit;d(),E(e)}}function ce(o,i){if(o&1){let e=x();t(0,"div",20)(1,"div",21)(2,"div",6)(3,"div",7),p(),t(4,"svg",27),c(5,"path",23),r()(),f(),t(6,"div",28)(7,"h3",29),a(8,"Errores de validaci\xF3n"),r(),t(9,"ul",30),v(10,se,2,1,"li",31),r()(),t(11,"div",12)(12,"button",32),_("click",function(){u(e);let l=m();return b(l.clearValidationErrors())}),p(),t(13,"svg",14),c(14,"path",15),r()()()()()()}if(o&2){let e=m();d(10),s("ngForOf",e.getValidationErrorsList())}}function me(o,i){if(o&1&&(t(0,"div",20)(1,"div",33)(2,"div")(3,"h1",34),a(4),r(),t(5,"p",35),a(6),r()(),t(7,"div",36)(8,"a",37),p(),t(9,"svg",38),c(10,"path",39),r(),f(),t(11,"span",40),a(12,"Volver a Servicios"),r()()()()()),o&2){let e=m();d(4),k(" ",e.isEditMode?"Editar Servicio":"Crear Nuevo Servicio"," "),d(2),k(" ",(e.emprendimiento==null?null:e.emprendimiento.nombre)||"Cargando..."," "),d(2),s("routerLink",V(3,ne,e.emprendimientoId))}}function pe(o,i){o&1&&(t(0,"span"),a(1,"El nombre del servicio es requerido"),r())}function ve(o,i){o&1&&(t(0,"span"),a(1,"El nombre debe tener al menos 3 caracteres"),r())}function ue(o,i){if(o&1&&(t(0,"div",81),v(1,pe,2,0,"span",3)(2,ve,2,0,"span",3),r()),o&2){let e,n,l=m(3);d(),s("ngIf",(e=l.servicioForm.get("nombre"))==null||e.errors==null?null:e.errors.required),d(),s("ngIf",(n=l.servicioForm.get("nombre"))==null||n.errors==null?null:n.errors.minlength)}}function be(o,i){o&1&&(t(0,"span"),a(1,"El precio es requerido"),r())}function _e(o,i){o&1&&(t(0,"span"),a(1,"El precio debe ser mayor a 0"),r())}function fe(o,i){if(o&1&&(t(0,"div",81),v(1,be,2,0,"span",3)(2,_e,2,0,"span",3),r()),o&2){let e,n,l=m(3);d(),s("ngIf",(e=l.servicioForm.get("precio_referencial"))==null||e.errors==null?null:e.errors.required),d(),s("ngIf",(n=l.servicioForm.get("precio_referencial"))==null||n.errors==null?null:n.errors.min)}}function ge(o,i){o&1&&(t(0,"span"),a(1,"La capacidad es requerida"),r())}function he(o,i){o&1&&(t(0,"span"),a(1,"La capacidad debe ser mayor a 0"),r())}function xe(o,i){if(o&1&&(t(0,"div",81),v(1,ge,2,0,"span",3)(2,he,2,0,"span",3),r()),o&2){let e,n,l=m(3);d(),s("ngIf",(e=l.servicioForm.get("capacidad"))==null||e.errors==null?null:e.errors.required),d(),s("ngIf",(n=l.servicioForm.get("capacidad"))==null||n.errors==null?null:n.errors.min)}}function Se(o,i){o&1&&(t(0,"span"),a(1,"La descripci\xF3n es requerida"),r())}function we(o,i){o&1&&(t(0,"span"),a(1,"La descripci\xF3n debe tener al menos 10 caracteres"),r())}function ke(o,i){if(o&1&&(t(0,"div",81),v(1,Se,2,0,"span",3)(2,we,2,0,"span",3),r()),o&2){let e,n,l=m(3);d(),s("ngIf",(e=l.servicioForm.get("descripcion"))==null||e.errors==null?null:e.errors.required),d(),s("ngIf",(n=l.servicioForm.get("descripcion"))==null||n.errors==null?null:n.errors.minlength)}}function Ee(o,i){if(o&1&&(t(0,"div",62)(1,"h3",63),a(2,"Informaci\xF3n B\xE1sica"),r(),t(3,"div",64)(4,"div",65)(5,"label",66),a(6," Nombre del Servicio * "),r(),c(7,"input",67),v(8,ue,3,2,"div",68),r(),t(9,"div")(10,"label",69),a(11," Precio Referencial (S/.) * "),r(),c(12,"input",70),v(13,fe,3,2,"div",68),r(),t(14,"div")(15,"label",71),a(16," Capacidad * "),r(),c(17,"input",72),v(18,xe,3,2,"div",68),r()(),t(19,"div")(20,"label",73),a(21," Descripci\xF3n * "),r(),c(22,"textarea",74),v(23,ke,3,2,"div",68),r(),t(24,"div",75)(25,"label",76),c(26,"input",77),t(27,"span",78)(28,"span",79),a(29,"Servicio activo"),r(),t(30,"p",80),a(31," Los servicios inactivos no ser\xE1n visibles para los clientes "),r()()()()()),o&2){let e=m(2);d(7),h("border-red-400",e.isFieldInvalid("nombre"))("focus:border-red-400",e.isFieldInvalid("nombre")),d(),s("ngIf",e.isFieldInvalid("nombre")),d(4),h("border-red-400",e.isFieldInvalid("precio_referencial"))("focus:border-red-400",e.isFieldInvalid("precio_referencial")),d(),s("ngIf",e.isFieldInvalid("precio_referencial")),d(4),h("border-red-400",e.isFieldInvalid("capacidad"))("focus:border-red-400",e.isFieldInvalid("capacidad")),d(),s("ngIf",e.isFieldInvalid("capacidad")),d(4),h("border-red-400",e.isFieldInvalid("descripcion"))("focus:border-red-400",e.isFieldInvalid("descripcion")),d(),s("ngIf",e.isFieldInvalid("descripcion"))}}function Fe(o,i){if(o&1){let e=x();t(0,"div",62)(1,"h3",63),a(2,"Ubicaci\xF3n del Servicio"),r(),t(3,"div")(4,"label",82),a(5," Ubicaci\xF3n de Referencia "),r(),c(6,"input",83),r(),t(7,"div")(8,"label",84),a(9," Ubicaci\xF3n en el Mapa "),r(),t(10,"div",85)(11,"app-ubicacion-map",86),_("ubicacionChange",function(l){u(e);let g=m(2);return b(g.onUbicacionChange(l))}),r()()(),t(12,"div",64)(13,"div")(14,"label",87),a(15," Latitud "),r(),c(16,"input",88),r(),t(17,"div")(18,"label",89),a(19," Longitud "),r(),c(20,"input",90),r()()()}if(o&2){let e,n,l=m(2);d(11),s("latitud",(e=l.servicioForm.get("latitud"))==null?null:e.value)("longitud",(n=l.servicioForm.get("longitud"))==null?null:n.value)("readOnly",!1)("zoom",13)}}function Ce(o,i){o&1&&(t(0,"div",81),a(1," El d\xEDa es requerido "),r())}function ye(o,i){o&1&&(t(0,"div",81),a(1," La hora de inicio es requerida "),r())}function Te(o,i){o&1&&(t(0,"div",81),a(1," La hora de fin es requerida "),r())}function Ie(o,i){if(o&1){let e=x();t(0,"div",97)(1,"div",98)(2,"h4",99),a(3),r(),t(4,"button",100),_("click",function(){let l=u(e).index,g=m(3);return b(g.removeHorario(l))}),p(),t(5,"svg",101),c(6,"path",102),r()()(),f(),t(7,"div",103)(8,"div")(9,"label",104),a(10," D\xEDa de la Semana * "),r(),t(11,"select",105)(12,"option",106),a(13,"Seleccionar"),r(),t(14,"option",107),a(15,"Lunes"),r(),t(16,"option",108),a(17,"Martes"),r(),t(18,"option",109),a(19,"Mi\xE9rcoles"),r(),t(20,"option",110),a(21,"Jueves"),r(),t(22,"option",111),a(23,"Viernes"),r(),t(24,"option",112),a(25,"S\xE1bado"),r(),t(26,"option",113),a(27,"Domingo"),r()(),v(28,Ce,2,0,"div",68),r(),t(29,"div")(30,"label",104),a(31," Hora Inicio * "),r(),c(32,"input",114),v(33,ye,2,0,"div",68),r(),t(34,"div")(35,"label",104),a(36," Hora Fin * "),r(),c(37,"input",115),v(38,Te,2,0,"div",68),r(),t(39,"div",46)(40,"label",116),c(41,"input",117),t(42,"span",118),a(43," Activo "),r()()()()()}if(o&2){let e=i.index,n=m(3);s("formGroupName",e),d(3),k(" Horario ",e+1," "),d(8),h("border-red-400",n.isHorarioFieldInvalid(e,"dia_semana")),d(17),s("ngIf",n.isHorarioFieldInvalid(e,"dia_semana")),d(4),h("border-red-400",n.isHorarioFieldInvalid(e,"hora_inicio")),d(),s("ngIf",n.isHorarioFieldInvalid(e,"hora_inicio")),d(4),h("border-red-400",n.isHorarioFieldInvalid(e,"hora_fin")),d(),s("ngIf",n.isHorarioFieldInvalid(e,"hora_fin"))}}function Ve(o,i){if(o&1){let e=x();t(0,"div",119),p(),t(1,"svg",120),c(2,"path",121),r(),f(),t(3,"h3",122),a(4,"No hay horarios definidos"),r(),t(5,"p",123),a(6,'Haz clic en "Agregar Horario" para comenzar.'),r(),t(7,"button",124),_("click",function(){u(e);let l=m(3);return b(l.addHorario())}),p(),t(8,"svg",125),c(9,"path",93),r(),a(10," Agregar primer horario "),r()()}}function Me(o,i){if(o&1){let e=x();t(0,"div",62)(1,"div",33)(2,"h3",91),a(3,"Horarios de Atenci\xF3n"),r(),t(4,"button",92),_("click",function(){u(e);let l=m(2);return b(l.addHorario())}),p(),t(5,"svg",38),c(6,"path",93),r(),a(7," Agregar Horario "),r()(),f(),t(8,"div",94),v(9,Ie,44,11,"div",95),r(),v(10,Ve,11,0,"div",96),r()}if(o&2){let e=m(2);d(9),s("ngForOf",e.horarios.controls),d(),s("ngIf",e.horarios.length===0)}}function Ne(o,i){if(o&1){let e=x();t(0,"div",62)(1,"h3",63),a(2,"Im\xE1genes del Servicio"),r(),t(3,"app-slider-upload",126),_("changeSlidersEvent",function(l){u(e);let g=m(2);return b(g.onSlidersChange(l))})("deletedSlidersEvent",function(l){u(e);let g=m(2);return b(g.onDeletedSlidersChange(l))}),r(),t(4,"div",127)(5,"div",6)(6,"div",7),p(),t(7,"svg",128),c(8,"path",48),r()(),f(),t(9,"div",10)(10,"h4",129),a(11,"Consejos para las im\xE1genes"),r(),t(12,"div",130)(13,"ul",131)(14,"li"),a(15,"Sube im\xE1genes de alta calidad que muestren tu servicio"),r(),t(16,"li"),a(17,"Incluye tanto im\xE1genes del lugar como de la actividad"),r(),t(18,"li"),a(19,"Tama\xF1o m\xE1ximo: 5MB por imagen"),r(),t(20,"li"),a(21,"Formatos recomendados: JPG, PNG"),r()()()()()()()}if(o&2){let e=m(2);d(3),s("slidersFormArray",e.slidersArray)("existingSliders",e.sliders)("isSliderPrincipal",!1)}}function He(o,i){if(o&1){let e=x();t(0,"button",57),_("click",function(){u(e);let l=m(2);return b(l.goToPreviousTab())}),p(),t(1,"svg",38),c(2,"path",132),r(),a(3," Anterior "),r()}}function Ge(o,i){if(o&1){let e=x();t(0,"button",57),_("click",function(){u(e);let l=m(2);return b(l.goToNextTab())}),a(1," Siguiente "),p(),t(2,"svg",133),c(3,"path",134),r()()}}function Le(o,i){o&1&&c(0,"div",135)}function Ae(o,i){o&1&&(p(),t(0,"svg",38),c(1,"path",136),r())}function je(o,i){if(o&1){let e=x();t(0,"div")(1,"form",41),_("ngSubmit",function(){u(e);let l=m();return b(l.onSubmit())}),t(2,"div",42)(3,"div",43)(4,"nav",44)(5,"button",45),_("click",function(){u(e);let l=m();return b(l.activeTab="informacion")}),t(6,"div",46),p(),t(7,"svg",47),c(8,"path",48),r(),a(9," Informaci\xF3n B\xE1sica "),r()(),f(),t(10,"button",45),_("click",function(){u(e);let l=m();return b(l.activeTab="ubicacion")}),t(11,"div",46),p(),t(12,"svg",47),c(13,"path",49),r(),a(14," Ubicaci\xF3n "),r()(),f(),t(15,"button",45),_("click",function(){u(e);let l=m();return b(l.activeTab="horarios")}),t(16,"div",46),p(),t(17,"svg",47),c(18,"path",50),r(),a(19," Horarios "),r()(),f(),t(20,"button",45),_("click",function(){u(e);let l=m();return b(l.activeTab="imagenes")}),t(21,"div",46),p(),t(22,"svg",47),c(23,"path",51),r(),a(24," Im\xE1genes "),r()()()(),f(),t(25,"div",52),v(26,Ee,32,20,"div",53)(27,Fe,21,4,"div",53)(28,Me,11,2,"div",53)(29,Ne,22,3,"div",53),r(),t(30,"div",54)(31,"div",33)(32,"div",55),v(33,He,4,0,"button",56),t(34,"button",57),_("click",function(){u(e);let l=m();return b(l.cancel())}),p(),t(35,"svg",38),c(36,"path",15),r(),a(37," Cancelar "),r()(),f(),t(38,"div",36)(39,"div",58),a(40," * Campos requeridos "),r(),t(41,"div",55),v(42,Ge,4,0,"button",56),t(43,"button",59),v(44,Le,1,0,"div",60)(45,Ae,2,0,"svg",61),a(46),r()()()()()()()()}if(o&2){let e=m();d(),s("formGroup",e.servicioForm),d(4),h("border-orange-400",e.activeTab==="informacion")("text-orange-300",e.activeTab==="informacion")("border-transparent",e.activeTab!=="informacion")("text-slate-400",e.activeTab!=="informacion"),d(5),h("border-orange-400",e.activeTab==="ubicacion")("text-orange-300",e.activeTab==="ubicacion")("border-transparent",e.activeTab!=="ubicacion")("text-slate-400",e.activeTab!=="ubicacion"),d(5),h("border-orange-400",e.activeTab==="horarios")("text-orange-300",e.activeTab==="horarios")("border-transparent",e.activeTab!=="horarios")("text-slate-400",e.activeTab!=="horarios"),d(5),h("border-orange-400",e.activeTab==="imagenes")("text-orange-300",e.activeTab==="imagenes")("border-transparent",e.activeTab!=="imagenes")("text-slate-400",e.activeTab!=="imagenes"),d(6),s("ngIf",e.activeTab==="informacion"),d(),s("ngIf",e.activeTab==="ubicacion"),d(),s("ngIf",e.activeTab==="horarios"),d(),s("ngIf",e.activeTab==="imagenes"),d(4),s("ngIf",e.activeTab!=="informacion"),d(9),s("ngIf",e.activeTab!=="imagenes"),d(),s("disabled",e.servicioForm.invalid||e.saving),d(),s("ngIf",e.saving),d(),s("ngIf",!e.saving),d(),k(" ",e.saving?"Guardando...":e.isEditMode?"Actualizar Servicio":"Crear Servicio"," ")}}var oe=class o{fb=w(Z);emprendimientoAdminService=w(te);route=w(G);router=w(L);emprendimientoId;servicioId;emprendimiento;servicio;isEditMode=!1;loading=!0;saving=!1;error="";success="";validationErrors={};servicioForm;activeTab="informacion";sliders=[];deletedSliders=[];diasSemana={lunes:"lunes",martes:"martes",miercoles:"miercoles",mi\u00E9rcoles:"miercoles",jueves:"jueves",viernes:"viernes",sabado:"sabado",s\u00E1bado:"sabado",domingo:"domingo"};ngOnInit(){this.initForm(),this.route.parent?.paramMap.subscribe(i=>{let e=i.get("id");console.log("ServicioForm - Emprendimiento ID recibido:",e),e&&!isNaN(+e)?(this.emprendimientoId=+e,this.route.paramMap.subscribe(n=>{let l=n.get("servicioId");console.log("ServicioForm - Servicio ID recibido:",l),this.servicioId=l?+l:void 0,this.isEditMode=!!this.servicioId,this.loadData()})):(console.error("ServicioForm - ID de emprendimiento inv\xE1lido:",e),this.error="ID de emprendimiento inv\xE1lido",this.loading=!1)})}unloadNotification(i){this.hasUnsavedChanges()&&(i.returnValue="Tienes cambios sin guardar. \xBFEst\xE1s seguro de que quieres salir?")}initForm(){this.servicioForm=this.fb.group({nombre:["",[S.required,S.minLength(3)]],descripcion:["",[S.required,S.minLength(10)]],precio_referencial:["",[S.required,S.min(.01)]],capacidad:["",[S.required,S.min(1)]],emprendedor_id:[""],estado:[!0],latitud:[""],longitud:[""],ubicacion_referencia:[""],horarios:this.fb.array([]),sliders:this.fb.array([])})}get horarios(){return this.servicioForm.get("horarios")}get slidersArray(){return this.servicioForm.get("sliders")}isFieldInvalid(i){let e=this.servicioForm.get(i);return!!(e&&e.invalid&&e.touched)}isHorarioFieldInvalid(i,e){let l=this.horarios.at(i).get(e);return!!(l&&l.invalid&&l.touched)}hasUnsavedChanges(){return this.servicioForm.dirty||this.sliders.some(i=>i.imagen instanceof File)||this.deletedSliders.length>0}getObjectKeys(i){return i?Object.keys(i):[]}getValidationErrorsList(){let i=[];return Object.keys(this.validationErrors).forEach(e=>{let n=this.validationErrors[e];Array.isArray(n)&&n.forEach(l=>{let g=l;l.includes("required")&&(g=`El campo ${this.getFieldDisplayName(e)} es requerido`),i.push(g)})}),i}getFieldDisplayName(i){return{nombre:"nombre",descripcion:"descripci\xF3n",precio_referencial:"precio referencial",capacidad:"capacidad",emprendedor_id:"emprendimiento"}[i]||i}clearValidationErrors(){this.validationErrors={}}goToPreviousTab(){let i=["informacion","ubicacion","horarios","imagenes"],e=i.indexOf(this.activeTab);e>0&&(this.activeTab=i[e-1])}goToNextTab(){let i=["informacion","ubicacion","horarios","imagenes"],e=i.indexOf(this.activeTab);e<i.length-1&&(this.activeTab=i[e+1])}loadData(){this.loadEmprendimiento(),this.isEditMode&&this.servicioId?this.loadServicio():(this.loading=!1,this.servicioForm.patchValue({emprendedor_id:this.emprendimientoId}))}loadEmprendimiento(){this.emprendimientoAdminService.getEmprendimiento(this.emprendimientoId).subscribe({next:i=>{this.emprendimiento=i},error:i=>{console.error("Error al cargar emprendimiento:",i),this.error="Error al cargar la informaci\xF3n del emprendimiento"}})}loadServicio(){this.servicioId&&this.emprendimientoAdminService.getServicio(this.servicioId).subscribe({next:i=>{console.log("Servicio cargado:",i),this.servicio=i,this.populateForm(),this.loading=!1},error:i=>{console.error("Error al cargar servicio:",i),this.error="Error al cargar el servicio",this.loading=!1}})}populateForm(){this.servicio&&(console.log("Poblando formulario con servicio:",this.servicio),this.servicioForm.patchValue({nombre:this.servicio.nombre,descripcion:this.servicio.descripcion,precio_referencial:this.servicio.precio_referencial,capacidad:this.servicio.capacidad||1,emprendedor_id:this.servicio.emprendedor_id,estado:this.servicio.estado!==!1,latitud:this.servicio.latitud,longitud:this.servicio.longitud,ubicacion_referencia:this.servicio.ubicacion_referencia}),this.servicio.horarios&&this.servicio.horarios.length>0&&(console.log("Horarios del servicio:",this.servicio.horarios),this.servicio.horarios.forEach(i=>{console.log("Procesando horario:",i),this.horarios.push(this.createHorarioGroup(i))})),this.servicio.sliders&&this.servicio.sliders.length>0&&(this.sliders=this.servicio.sliders.map(i=>({id:i.id,nombre:i.nombre,es_principal:i.es_principal,orden:i.orden,url_completa:i.url_completa,imagen:i.url_completa,titulo:i.titulo||"",descripcion:typeof i.descripcion=="string"?i.descripcion:i.descripcion?.descripcion||""}))))}onUbicacionChange(i){this.servicioForm.patchValue({latitud:i.lat,longitud:i.lng})}addHorario(){this.horarios.push(this.createHorarioGroup())}removeHorario(i){confirm("\xBFEst\xE1s seguro de que quieres eliminar este horario?")&&this.horarios.removeAt(i)}createHorarioGroup(i){let e="";if(i?.dia_semana){let n=i.dia_semana.toLowerCase();e=this.diasSemana[n]||n}return console.log("Creando grupo de horario:",{original:i?.dia_semana,normalizado:e,hora_inicio:i?.hora_inicio,hora_fin:i?.hora_fin}),this.fb.group({id:[i?.id||null],dia_semana:[e,S.required],hora_inicio:[i?.hora_inicio||"",S.required],hora_fin:[i?.hora_fin||"",S.required],activo:[i?.activo!==!1]})}onSlidersChange(i){this.sliders=i}onDeletedSlidersChange(i){this.deletedSliders=i}onSubmit(){if(this.servicioForm.invalid||this.saving){this.markFormGroupTouched(this.servicioForm),this.goToFirstInvalidTab();return}this.saving=!0,this.validationErrors={};let i=this.prepareFormData();console.log("Enviando datos:",i),this.isEditMode&&this.servicioId?this.emprendimientoAdminService.updateServicio(this.servicioId,i).subscribe({next:e=>{this.success="Servicio actualizado correctamente",this.saving=!1,setTimeout(()=>this.navigateToServices(),2e3)},error:e=>{console.error("Error al actualizar servicio:",e),this.handleFormError(e),this.saving=!1}}):this.emprendimientoAdminService.createServicio(i).subscribe({next:e=>{this.success="Servicio creado correctamente",this.saving=!1,setTimeout(()=>this.navigateToServices(),2e3)},error:e=>{console.error("Error al crear servicio:",e),this.handleFormError(e),this.saving=!1}})}handleFormError(i){i.error?.errors?(this.validationErrors=i.error.errors,this.error=""):(this.error=i.error?.message||"Error al procesar el formulario",this.validationErrors={})}prepareFormData(){let i=F({},this.servicioForm.value);return i.sliders=this.sliders.map(e=>y(F({},e),{es_principal:!1})),i.deleted_sliders=this.deletedSliders,i}markFormGroupTouched(i){Object.keys(i.controls).forEach(e=>{let n=i.get(e);n?.markAsTouched(),n instanceof C?this.markFormGroupTouched(n):n instanceof Y&&n.controls.forEach(l=>{l instanceof C&&this.markFormGroupTouched(l)})})}goToFirstInvalidTab(){["nombre","descripcion","precio_referencial","capacidad"].some(n=>this.isFieldInvalid(n))?this.activeTab="informacion":this.horarios.invalid&&(this.activeTab="horarios")}retryLoad(){this.error="",this.loading=!0,this.loadData()}cancel(){this.hasUnsavedChanges()?confirm("Tienes cambios sin guardar. \xBFEst\xE1s seguro de que quieres salir?")&&this.navigateToServices():this.navigateToServices()}navigateToServices(){this.router.navigate(["/admin-emprendedores/emprendimiento",this.emprendimientoId,"servicios"])}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=I({type:o,selectors:[["app-servicio-form"]],hostBindings:function(e,n){e&1&&_("beforeunload",function(g){return n.unloadNotification(g)},!1,T)},decls:6,vars:6,consts:[["class","fixed top-4 right-4 z-50 max-w-md",4,"ngIf"],["class","flex justify-center items-center py-20",4,"ngIf"],["class","mb-8",4,"ngIf"],[4,"ngIf"],[1,"fixed","top-4","right-4","z-50","max-w-md"],[1,"backdrop-blur-sm","bg-green-500/20","border","border-green-500/30","rounded-2xl","p-4","shadow-xl"],[1,"flex"],[1,"flex-shrink-0"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-green-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ml-3"],[1,"text-sm","font-medium","text-green-200"],[1,"ml-auto","pl-3"],[1,"text-green-300","hover:text-green-400","transition-colors","duration-300",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"flex","justify-center","items-center","py-20"],[1,"relative"],[1,"w-16","h-16","border-4","border-orange-200/30","rounded-full"],[1,"w-16","h-16","border-4","border-orange-400","border-t-transparent","rounded-full","animate-spin","absolute","top-0"],[1,"mb-8"],[1,"backdrop-blur-sm","bg-red-500/20","border","border-red-500/30","rounded-2xl","p-6","shadow-xl"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-red-300","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-red-200","font-semibold"],[1,"text-red-300","text-sm"],[1,"mt-2","px-4","py-2","rounded-xl","bg-red-500/20","text-red-200","hover:bg-red-500/30","transition-all","duration-300","text-sm","font-medium",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-red-300"],[1,"ml-3","flex-1"],[1,"text-red-200","font-semibold","mb-2"],[1,"text-red-300","text-sm","space-y-1"],[4,"ngFor","ngForOf"],[1,"text-red-300","hover:text-red-400","transition-colors","duration-300",3,"click"],[1,"flex","items-center","justify-between"],[1,"text-3xl","font-bold","bg-gradient-to-r","from-orange-400","via-orange-300","to-amber-300","bg-clip-text","text-transparent"],[1,"text-slate-300","dark:text-slate-400","mt-1"],[1,"flex","items-center","space-x-4"],[1,"group","flex","items-center","px-4","py-2.5","rounded-xl","bg-white/10","dark:bg-slate-800/60","text-white","hover:bg-white/20","dark:hover:bg-slate-700/80","transition-all","duration-300","shadow-lg","hover:shadow-xl","border","border-white/10","dark:border-slate-700/50","hover:border-white/20","dark:hover:border-slate-600/60",3,"routerLink"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-2","group-hover:scale-110","transition-transform","duration-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"font-medium"],[3,"ngSubmit","formGroup"],[1,"backdrop-blur-sm","bg-white/10","dark:bg-slate-800/40","rounded-2xl","border","border-white/20","dark:border-slate-700/50","shadow-xl","overflow-hidden"],[1,"border-b","border-white/10","dark:border-slate-700/50"],[1,"-mb-px","flex","space-x-8","px-6","pt-4","overflow-x-auto"],["type","button",1,"pb-4","px-1","border-b-2","font-medium","text-sm","whitespace-nowrap","hover:text-slate-300","hover:border-slate-400","transition-all","duration-300",3,"click"],[1,"flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mr-2","h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"p-6"],["class","space-y-6",4,"ngIf"],[1,"bg-white/5","dark:bg-slate-800/30","px-6","py-4","border-t","border-white/10","dark:border-slate-700/50"],[1,"flex","space-x-3"],["type","button","class","group flex items-center px-4 py-2.5 rounded-xl bg-white/10 dark:bg-slate-800/60 text-white hover:bg-white/20 dark:hover:bg-slate-700/80 transition-all duration-300 shadow-lg hover:shadow-xl border border-white/10 dark:border-slate-700/50 hover:border-white/20 dark:hover:border-slate-600/60 font-medium",3,"click",4,"ngIf"],["type","button",1,"group","flex","items-center","px-4","py-2.5","rounded-xl","bg-white/10","dark:bg-slate-800/60","text-white","hover:bg-white/20","dark:hover:bg-slate-700/80","transition-all","duration-300","shadow-lg","hover:shadow-xl","border","border-white/10","dark:border-slate-700/50","hover:border-white/20","dark:hover:border-slate-600/60","font-medium",3,"click"],[1,"text-sm","text-slate-400"],["type","submit",1,"group","flex","items-center","px-6","py-2.5","rounded-xl","bg-gradient-to-r","from-orange-500","to-orange-400","text-white","font-semibold","shadow-lg","hover:from-orange-600","hover:to-orange-500","transition-all","duration-300","hover:shadow-xl","disabled:opacity-50","disabled:cursor-not-allowed","disabled:hover:from-orange-500","disabled:hover:to-orange-400",3,"disabled"],["class","w-4 h-4 mr-2 animate-spin rounded-full border-2 border-white border-t-transparent",4,"ngIf"],["class","w-4 h-4 mr-2 group-hover:scale-110 transition-transform duration-300","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"space-y-6"],[1,"text-lg","font-medium","text-white","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"md:col-span-2"],["for","nombre",1,"block","text-sm","font-medium","text-slate-300","mb-2"],["type","text","id","nombre","formControlName","nombre","placeholder","Ej: Tour en kayak por el lago",1,"w-full","px-3","py-3","border","border-white/20","dark:border-slate-600/50","rounded-xl","bg-white/10","dark:bg-slate-800/30","text-white","placeholder-slate-400","focus:outline-none","focus:ring-2","focus:ring-orange-400","focus:border-orange-400","transition-all","duration-300"],["class","mt-1 text-sm text-red-300",4,"ngIf"],["for","precio_referencial",1,"block","text-sm","font-medium","text-slate-300","mb-2"],["type","number","id","precio_referencial","formControlName","precio_referencial","step","0.01","min","0","placeholder","0.00",1,"w-full","px-3","py-3","border","border-white/20","dark:border-slate-600/50","rounded-xl","bg-white/10","dark:bg-slate-800/30","text-white","placeholder-slate-400","focus:outline-none","focus:ring-2","focus:ring-orange-400","focus:border-orange-400","transition-all","duration-300"],["for","capacidad",1,"block","text-sm","font-medium","text-slate-300","mb-2"],["type","number","id","capacidad","formControlName","capacidad","min","1","placeholder","1",1,"w-full","px-3","py-3","border","border-white/20","dark:border-slate-600/50","rounded-xl","bg-white/10","dark:bg-slate-800/30","text-white","placeholder-slate-400","focus:outline-none","focus:ring-2","focus:ring-orange-400","focus:border-orange-400","transition-all","duration-300"],["for","descripcion",1,"block","text-sm","font-medium","text-slate-300","mb-2"],["id","descripcion","formControlName","descripcion","rows","4","placeholder","Describe detalladamente tu servicio...",1,"w-full","px-3","py-3","border","border-white/20","dark:border-slate-600/50","rounded-xl","bg-white/10","dark:bg-slate-800/30","text-white","placeholder-slate-400","focus:outline-none","focus:ring-2","focus:ring-orange-400","focus:border-orange-400","transition-all","duration-300"],[1,"flex","items-center","p-4","bg-white/5","dark:bg-slate-800/30","border","border-white/10","dark:border-slate-600/30","rounded-xl"],[1,"flex","items-center","cursor-pointer"],["type","checkbox","formControlName","estado",1,"h-5","w-5","text-orange-400","focus:ring-orange-400","border-slate-600","rounded","bg-white/10"],[1,"ml-3","text-slate-300"],[1,"text-sm","font-medium"],[1,"text-xs","text-slate-400","mt-1"],[1,"mt-1","text-sm","text-red-300"],["for","ubicacion_referencia",1,"block","text-sm","font-medium","text-slate-300","mb-2"],["type","text","id","ubicacion_referencia","formControlName","ubicacion_referencia","placeholder","Ej: Muelle tur\xEDstico del lago Titicaca",1,"w-full","px-3","py-3","border","border-white/20","dark:border-slate-600/50","rounded-xl","bg-white/10","dark:bg-slate-800/30","text-white","placeholder-slate-400","focus:outline-none","focus:ring-2","focus:ring-orange-400","focus:border-orange-400","transition-all","duration-300"],[1,"block","text-sm","font-medium","text-slate-300","mb-2"],[1,"overflow-hidden","rounded-xl","border","border-white/20","dark:border-slate-600/50"],[3,"ubicacionChange","latitud","longitud","readOnly","zoom"],["for","latitud",1,"block","text-sm","font-medium","text-slate-300","mb-2"],["type","number","id","latitud","formControlName","latitud","step","any","readonly","","placeholder","Selecciona en el mapa",1,"w-full","px-3","py-3","border","border-white/20","dark:border-slate-600/50","rounded-xl","bg-white/5","dark:bg-slate-800/20","text-slate-400","cursor-not-allowed"],["for","longitud",1,"block","text-sm","font-medium","text-slate-300","mb-2"],["type","number","id","longitud","formControlName","longitud","step","any","readonly","","placeholder","Selecciona en el mapa",1,"w-full","px-3","py-3","border","border-white/20","dark:border-slate-600/50","rounded-xl","bg-white/5","dark:bg-slate-800/20","text-slate-400","cursor-not-allowed"],[1,"text-lg","font-medium","text-white"],["type","button",1,"group","flex","items-center","px-4","py-2.5","rounded-xl","bg-gradient-to-r","from-orange-500","to-orange-400","text-white","font-semibold","shadow-lg","hover:from-orange-600","hover:to-orange-500","transition-all","duration-300","hover:shadow-xl",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],["formArrayName","horarios",1,"space-y-4"],["class","backdrop-blur-sm bg-white/5 dark:bg-slate-800/30 border border-white/10 dark:border-slate-600/30 rounded-xl p-4 shadow-lg",3,"formGroupName",4,"ngFor","ngForOf"],["class","text-center py-12 border-2 border-dashed border-white/20 dark:border-slate-600/50 rounded-xl bg-white/5 dark:bg-slate-800/20",4,"ngIf"],[1,"backdrop-blur-sm","bg-white/5","dark:bg-slate-800/30","border","border-white/10","dark:border-slate-600/30","rounded-xl","p-4","shadow-lg",3,"formGroupName"],[1,"flex","items-center","justify-between","mb-3"],[1,"text-sm","font-medium","text-white"],["type","button",1,"group","text-red-300","hover:text-red-400","transition-colors","duration-300",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","group-hover:scale-110","transition-transform","duration-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"block","text-sm","font-medium","text-slate-300","mb-1"],["formControlName","dia_semana",1,"w-full","px-3","py-2.5","border","border-white/20","dark:border-slate-600/50","rounded-xl","bg-white/10","dark:bg-slate-800/30","text-white","focus:outline-none","focus:ring-2","focus:ring-orange-400","focus:border-orange-400","transition-all","duration-300","text-sm"],["value","",1,"bg-slate-800","text-white"],["value","lunes",1,"bg-slate-800","text-white"],["value","martes",1,"bg-slate-800","text-white"],["value","miercoles",1,"bg-slate-800","text-white"],["value","jueves",1,"bg-slate-800","text-white"],["value","viernes",1,"bg-slate-800","text-white"],["value","sabado",1,"bg-slate-800","text-white"],["value","domingo",1,"bg-slate-800","text-white"],["type","time","formControlName","hora_inicio",1,"w-full","px-3","py-2.5","border","border-white/20","dark:border-slate-600/50","rounded-xl","bg-white/10","dark:bg-slate-800/30","text-white","focus:outline-none","focus:ring-2","focus:ring-orange-400","focus:border-orange-400","transition-all","duration-300","text-sm"],["type","time","formControlName","hora_fin",1,"w-full","px-3","py-2.5","border","border-white/20","dark:border-slate-600/50","rounded-xl","bg-white/10","dark:bg-slate-800/30","text-white","focus:outline-none","focus:ring-2","focus:ring-orange-400","focus:border-orange-400","transition-all","duration-300","text-sm"],[1,"flex","items-center","mt-6","cursor-pointer"],["type","checkbox","formControlName","activo",1,"h-4","w-4","text-orange-400","focus:ring-orange-400","border-slate-600","rounded","bg-white/10"],[1,"ml-2","text-sm","text-slate-300"],[1,"text-center","py-12","border-2","border-dashed","border-white/20","dark:border-slate-600/50","rounded-xl","bg-white/5","dark:bg-slate-800/20"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-16","w-16","text-slate-400","mb-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","1","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-lg","font-medium","text-white","mb-2"],[1,"text-slate-400","mb-4"],["type","button",1,"inline-flex","items-center","px-4","py-2","rounded-xl","bg-gradient-to-r","from-orange-500","to-orange-400","text-white","font-medium","hover:from-orange-600","hover:to-orange-500","transition-all","duration-300",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-2"],["title","Im\xE1genes del Servicio",3,"changeSlidersEvent","deletedSlidersEvent","slidersFormArray","existingSliders","isSliderPrincipal"],[1,"backdrop-blur-sm","bg-blue-500/20","border","border-blue-400/30","rounded-xl","p-4","shadow-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-blue-300"],[1,"text-sm","font-medium","text-blue-200","mb-2"],[1,"text-sm","text-blue-300"],[1,"list-disc","pl-5","space-y-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","ml-2","group-hover:scale-110","transition-transform","duration-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"w-4","h-4","mr-2","animate-spin","rounded-full","border-2","border-white","border-t-transparent"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"]],template:function(e,n){e&1&&v(0,ae,13,1,"div",0)(1,le,4,0,"div",1)(2,de,13,1,"div",2)(3,ce,15,1,"div",2)(4,me,13,5,"div",2)(5,je,47,43,"div",3),e&2&&(s("ngIf",n.success),d(),s("ngIf",n.loading),d(),s("ngIf",n.error),d(),s("ngIf",n.validationErrors&&n.getObjectKeys(n.validationErrors).length>0),d(),s("ngIf",!n.loading&&!n.error),d(),s("ngIf",!n.loading&&!n.error))},dependencies:[H,M,N,j,A,ee,B,W,Q,P,z,q,$,D,O,X,U,K,R,J,re,ie],styles:["[_nghost-%COMP%]{display:block}*[_ngcontent-%COMP%]{transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter}input[type=time][_ngcontent-%COMP%]{color-scheme:dark}select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{background-color:#1e293b;color:#fff}.overflow-x-auto[_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none}.overflow-x-auto[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}"]})};export{oe as ServicioFormComponent};
